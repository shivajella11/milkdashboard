<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/farm.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js for Market Analysis -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<style>
    .modal-content {
            max-width: 800px;
            margin: auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
        }

        .modal-body {
            max-height: 500px;
            overflow-y: auto;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 8px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .modal-header h3 {
            margin: 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
        }

        .form-row {
            display: flex;
            justify-content: space-between;
        }

        .form-row .form-group {
            width: 48%;
        }

        /* Error styling */
        .error {
            color: red;
            font-size: 12px;
        }
        
        /* Expanded details row styling */
        .details-row {
            background-color: #f9f9f9;
        }
        
        .details-row.hidden {
            display: none;
        }
        
        .farmer-details-expanded {
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        .details-header h3 {
            margin: 0;
            color: #007bff;
        }
        
        .close-details-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #555;
        }
        
        .details-content {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .details-column {
            width: 48%;
        }
        
        .detail-item {
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px dashed #eee;
        }
        
        .detail-label {
            font-weight: bold;
            color: #555;
            display: inline-block;
            width: 140px;
        }
        
        .detail-value {
            color: #333;
        }
        
        .details-notes {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .details-notes .detail-label {
            display: block;
            margin-bottom: 5px;
        }
        
        .details-notes .detail-value {
            display: block;
            white-space: pre-line;
        }
        
        .details-footer {
            border-top: 1px solid #ddd;
            padding-top: 15px;
        }
        
        .milk-collection-history h4 {
            margin-top: 0;
            color: #333;
            margin-bottom: 10px;
        }
        
        .collection-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .collection-table th, 
        .collection-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        
        .collection-table th {
            background-color: #f2f2f2;
        }
        
        /* Enhanced milk collection styling */
        .milk-collection-section {
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .milk-collection-header {
            background-color: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .milk-collection-header h3 {
            margin: 0;
            color: #007bff;
        }
        
        .collection-summary {
            display: flex;
            gap: 20px;
        }
        
        .summary-item {
            background-color: #fff;
            padding: 5px 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        .summary-label {
            font-weight: bold;
            color: #555;
            margin-right: 5px;
        }
        
        .summary-value {
            color: #333;
            font-weight: bold;
        }
        
        .quality-rating {
            color: #28a745;
        }
        
        .collection-controls {
            padding: 10px 15px;
            background-color: #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ddd;
        }
        
        .btn-sm {
            padding: 5px 10px;
            font-size: 0.9em;
        }
        
        .collection-filter {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .collection-filter select {
            padding: 5px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        
        .milk-collection-table-container {
            max-height: 400px;
            overflow-y: auto;
        }
        
        /* Row styling for milk collection table */
        .collection-table tr.recent-collection {
            background-color: #f0f8ff;
        }
        
        .collection-table td.high-yield {
            color: #28a745;
            font-weight: bold;
        }
        
        .collection-table td.quality-high {
            color: #28a745;
            font-weight: bold;
        }
        
        .collection-table td.quality-medium {
            color: #fd7e14;
            font-weight: bold;
        }
        
        /* Farmer summary styling */
        .farmer-summary {
            background-color: #f8f9fa;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
        }
        
        .summary-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .summary-row .summary-item {
            flex: 1 1 auto;
            min-width: 150px;
        }

        /* Market Analysis Section css */
.market-analysis-section {
  background-color: #f8f9fa;
  padding: 25px;
  border-radius: 10px;
  margin-top: 30px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid #e0e0e0;
}

.section-header h2 {
  margin: 0;
  font-size: 1.5rem;
  color: #2c3e50;
  display: flex;
  align-items: center;
  gap: 10px;
}

.time-period-selector select {
  padding: 8px 15px;
  border-radius: 6px;
  border: 1px solid #ddd;
  background-color: white;
  font-size: 0.9rem;
}

/* Market Stats Grid */
.market-stats-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: repeat(3, auto);
  gap: 20px;
  margin-bottom: 30px;
}

.analysis-card {
  background: white;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.08);
  transition: all 0.3s ease;
}

.analysis-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.card-header h3 {
  margin: 0;
  font-size: 1.1rem;
  color: #333;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card-actions {
  display: flex;
  gap: 10px;
}

.btn-icon {
  background: none;
  border: none;
  color: #666;
  cursor: pointer;
  font-size: 1rem;
  transition: all 0.2s ease;
}

.btn-icon:hover {
  color: #3498db;
  transform: scale(1.1);
}

.chart-container {
  height: 200px;
  margin: 15px 0;
  position: relative;
}

.card-footer {
  display: flex;
  justify-content: space-between;
  border-top: 1px solid #eee;
  padding-top: 15px;
  margin-top: 15px;
}

.stat-item {
  display: flex;
  flex-direction: column;
}

.stat-label {
  font-size: 0.8rem;
  color: #666;
  margin-bottom: 3px;
}

.stat-value {
  font-weight: 600;
  color: #333;
}

.positive {
  color: #27ae60;
}

.negative {
  color: #e74c3c;
}

.neutral {
  color: #f39c12;
}

/* Competitor Table */
.competitor-table {
  overflow-x: auto;
}

.competitor-table table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
}

.competitor-table th {
  text-align: left;
  padding: 10px;
  background-color: #f5f5f5;
  font-weight: 600;
  color: #333;
}

.competitor-table td {
  padding: 10px;
  border-bottom: 1px solid #eee;
}

/* Market News Section */
.market-news-section {
  background: white;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.08);
}

.market-news-section h3 {
  margin: 0 0 15px 0;
  font-size: 1.2rem;
  color: #2c3e50;
  display: flex;
  align-items: center;
  gap: 10px;
}

.news-filter {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid #eee;
}

.news-filter select {
  padding: 6px 10px;
  border-radius: 4px;
  border: 1px solid #ddd;
  background-color: white;
  font-size: 0.9rem;
}

.btn-outline-primary {
  background: none;
  border: 1px solid #3498db;
  color: #3498db;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-outline-primary:hover {
  background-color: #3498db;
  color: white;
}

.news-items {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.news-item {
  padding: 15px;
  border-radius: 8px;
  background-color: #f8f9fa;
  transition: all 0.3s ease;
  position: relative;
}

.news-item:hover {
  background-color: #e8f4fd;
  transform: translateX(5px);
}

.news-item.urgent {
  border-left: 4px solid #e74c3c;
}

.news-badge {
  position: absolute;
  top: 10px;
  right: 10px;
  background-color: #e74c3c;
  color: white;
  padding: 3px 8px;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 600;
}

.news-content h4 {
  margin: 0 0 8px 0;
  font-size: 1rem;
  color: #333;
}

.news-content p {
  margin: 0;
  font-size: 0.9rem;
  color: #666;
  line-height: 1.5;
}

.news-meta {
  display: flex;
  gap: 15px;
  margin-top: 10px;
  font-size: 0.8rem;
  color: #999;
}

.news-meta i {
  margin-right: 5px;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
  .market-stats-grid {
    grid-template-columns: 1fr;
    grid-template-rows: repeat(6, auto);
  }
  
  .card-footer {
    flex-direction: column;
    gap: 10px;
  }
}

/* Market Analysis Section css*/

</style>
<body>
    <nav class="navbar">
    <div class="nav-left">
        <img src="img/Company logo.jpg" class="logo" alt="Logo" />
        <div class="menu-title-group">
            <i class="fas fa-bars menu-icon" id="menuToggle"></i> 
        </div>
    </div>
    <div class="nav-center">
        <!-- Language Selector with Globe Icon -->
        <div class="nav-search-profile">
            <input type="text" placeholder="Search..." />
            
        </div>
        <!-- Can add navigation links here if needed -->
    </div>
    <div class="nav-right">
        <div class="nav-tools">
            <!-- Online Status Label -->
            <div class="status-label">
                <span id="statusDot" class="dot online"></span>
                <span id="statusText">Active</span>
            </div>
            <!-- Mode Toggle -->
            <button id="modeToggle" class="mode-toggle">
                <i class="fas fa-moon"></i>
            </button>
        </div>
        
        <div class="select-wrapper">
            <i class="fas fa-globe"></i>
            <select id="languageSelect" class="lang-dropdown">
                <option value="en">English</option>
                <option value="hi">हिन्दी</option>
                <option value="te">తెలుగు</option>
            </select>
        </div>
        <div class="nav-icons">
                <i class="fas fa-envelope"></i>
                <i class="fas fa-bell"></i>
            </div>
            <div class="profile">
                <img src="img/profile.jpg" alt="Profile" />
                <span>SHIVAKUMAR JELLA</span>
            </div>
    </div>
  </nav>
    <aside id="sidebar">
    <ul>
        <li class="dashboard-nav"><a href="dashb.html"><i class="fas fa-home"></i> Dashboard</a></li>
        <li class="farmer-nav active"><a href="farmer.html"><i class="fas fa-user-friends"></i> Farmer Directory</a></li>
        <li class="collection-nav"><a href="collection.html"><i class="fas fa-tractor"></i> Daily Milk Yields</a></li>
        <li class="chilling-nav"><a href="chilling.html"><i class="fas fa-snowflake"></i> Cooling Stations</a></li>
        <li class="processing-nav"><a href="plant.html"><i class="fas fa-industry"></i> Dairy Processing</a></li>
        <li class="quality-nav"><a href="qualitydemo.html"><i class="fas fa-clipboard-check"></i> Milk Quality Tests</a></li>
        <li class="inventory-nav"><a href="product.html"><i class="fas fa-boxes"></i> Dairy Stockroom</a></li>
        <li class="logistics-nav"><a href="distubtion.html"><i class="fas fa-shipping-fast"></i> Farm-to-Market Routes</a></li>        
        <li class="crm-nav"><a href="crmdemo.html"><i class="fas fa-users"></i> CRM System</a></li>
    </ul>
    
    </aside>
    <main>
        <!-- Main Content -->
        <div class="main-content">
            <div class="farmer-banner">
                <div class="farmer-banner-container">
                    <i class="fas fa-tractor banner-icon"></i>
                    <div class="farmer-banner-text">
                        <h1>Farmer Management</h1>
                    </div>
                </div>
            </div>

            <!-- Dashboard Cards -->
            <div class="dashboard-cards">
                <div class="card">
                    <div class="card-header">
                        <div>
                            <div class="card-value">142</div>
                            <div class="card-title">Total Farmers</div>
                        </div>
                        <div class="card-icon farmers">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div>
                            <div class="card-value">856</div>
                            <div class="card-title">Total Cattle</div>
                        </div>
                        <div class="card-icon cattle">
                            <i class="fas fa-cow"></i>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div>
                            <div class="card-value">2,450L</div>
                            <div class="card-title">Daily Milk</div>
                        </div>
                        <div class="card-icon milk">
                            <i class="fas fa-wine-bottle"></i>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <div>
                            <div class="card-value">$12,850</div>
                            <div class="card-title">Monthly Payments</div>
                        </div>
                        <div class="card-icon payments">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Farmers List Section -->
            <div class="content-section">
                <div class="section-header">
                    <h2>Farmers List</h2>
                    <button class="btn btn-primary" id="addFarmerBtn">
                        <i class="fas fa-plus"></i> Add Farmer
                    </button>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Contact</th>
                                <th>Location</th>
                                <th>Cattle Count</th>
                                <th>Avg. Milk (L)</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-registration-date="2023-01-15" data-notes="Experienced farmer with high-quality milk production" data-address="123 Farm Road, Kiambu County" data-id-number="12345678" data-nearest-center="Kiambu Collection Center">
                                <td>F001</td>
                                <td>Shiva</td>
                                <td>9876543210</td>
                                <td>Kiambu</td>
                                <td>8</td>
                                <td>24.5</td>
                                <td><span class="status active">Active</span></td>
                                <td>
                                    <div class="action-btns">
                                        <button class="action-btn" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr data-registration-date="2023-02-20" data-notes="Dedicated farmer with consistent milk quality" data-address="456 Dairy Lane, Murang'a County" data-id-number="23456789" data-nearest-center="Murang'a Collection Center">
                                <td>F002</td>
                                <td>Madhu</td>
                                <td>9876543211</td>
                                <td>Murang'a</td>
                                <td>12</td>
                                <td>38.2</td>
                                <td><span class="status active">Active</span></td>
                                <td>
                                    <div class="action-btns">
                                        <button class="action-btn" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr data-registration-date="2023-03-10" data-notes="Small-scale farmer with growing herd" data-address="789 Highland Road, Nyeri County" data-id-number="34567890" data-nearest-center="Nyeri Collection Center">
                                <td>F003</td>
                                <td>Ravi</td>
                                <td>9876543212</td>
                                <td>Nyeri</td>
                                <td>5</td>
                                <td>15.8</td>
                                <td><span class="status active">Active</span></td>
                                <td>
                                    <div class="action-btns">
                                        <button class="action-btn" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr data-registration-date="2022-12-05" data-notes="Large-scale farmer currently on temporary break" data-address="321 Valley View, Nakuru County" data-id-number="45678901" data-nearest-center="Nakuru Collection Center">
                                <td>F004</td>
                                <td>Meera</td>
                                <td>9876543213</td>
                                <td>Nakuru</td>
                                <td>15</td>
                                <td>42.6</td>
                                <td><span class="status inactive">Inactive</span></td>
                                <td>
                                    <div class="action-btns">
                                        <button class="action-btn" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>DF0005</td>
                                <td>James Mutua</td>
                                <td>0755123456</td>
                                <td>Machakos</td>
                                <td>10</td>
                                <td>32.1</td>
                                <td><span class="status active">Active</span></td>
                                <td>
                                    <div class="action-btns">
                                        <button class="action-btn" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


            <!-- Market Analysis Section -->
            <section class="market-analysis-section">
                <div class="section-header">
                    <h2><i class="fas fa-chart-line"></i> Milk Market Analysis</h2>
                    <div class="time-period-selector">
                    <select id="analysisPeriod">
                        <option value="7">Last 7 Days</option>
                        <option value="30" selected>Last 30 Days</option>
                        <option value="90">Last Quarter</option>
                        <option value="365">Last Year</option>
                    </select>
                    </div>
                </div>

                

                <div class="market-stats-grid">  
                    <!-- Price Trends Card -->
                    <div class="analysis-card price-trends">
                    <div class="card-header">
                        <h3><i class="fas fa-rupee-sign"></i> Price Trends</h3>
                        <div class="card-actions">
                        <button class="btn-icon" title="Export Data"><i class="fas fa-download"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="priceTrendChart"></canvas>
                    </div>
                    <div class="card-footer">
                        <div class="stat-item">
                        <span class="stat-label">Current Avg. Price</span>
                        <span class="stat-value">₹42.50/L</span>
                        </div>
                        <div class="stat-item">
                        <span class="stat-label">Weekly Change</span>
                        <span class="stat-value positive">+2.3% <i class="fas fa-arrow-up"></i></span>
                        </div>
                    </div>
                    </div>

                    <!-- Supply-Demand Balance -->
                    <div class="analysis-card supply-demand">
                    <div class="card-header">
                        <h3><i class="fas fa-balance-scale"></i> Supply-Demand Balance</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="supplyDemandChart"></canvas>
                    </div>
                    <div class="card-footer">
                        <div class="stat-item">
                        <span class="stat-label">Current Surplus</span>
                        <span class="stat-value">1,240 L/day</span>
                        </div>
                        <div class="stat-item">
                        <span class="stat-label">Projected Deficit</span>
                        <span class="stat-value negative">-850 L (next 7d)</span>
                        </div>
                    </div>
                    </div>

                    <!-- Regional Price Variations -->
                    <div class="analysis-card regional-prices">
                    <div class="card-header">
                        <h3><i class="fas fa-map-marked-alt"></i> Regional Price Variations</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="regionalPriceChart"></canvas>
                    </div>
                    <div class="card-footer">
                        <div class="stat-item">
                        <span class="stat-label">Highest Region</span>
                        <span class="stat-value">Bangalore (₹45.20)</span>
                        </div>
                        <div class="stat-item">
                        <span class="stat-label">Lowest Region</span>
                        <span class="stat-value">Chennai (₹39.80)</span>
                        </div>
                    </div>
                    </div>

                    <!-- Competitor Analysis -->
                    <div class="analysis-card competitor-analysis">
                    <div class="card-header">
                        <h3><i class="fas fa-chess-knight"></i> Competitor Pricing</h3>
                    </div>
                    <div class="competitor-table">
                        <table>
                        <thead>
                            <tr>
                            <th>Competitor</th>
                            <th>Price/L</th>
                            <th>Trend</th>
                            <th>Market Share</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                            <td>Amul</td>
                            <td>₹44.30</td>
                            <td><span class="positive">+1.2% <i class="fas fa-arrow-up"></i></span></td>
                            <td>32%</td>
                            </tr>
                            <tr>
                            <td>Nandini</td>
                            <td>₹41.80</td>
                            <td><span class="neutral">0.0% <i class="fas fa-minus"></i></span></td>
                            <td>28%</td>
                            </tr>
                            <tr>
                            <td>Heritage</td>
                            <td>₹43.50</td>
                            <td><span class="negative">-0.8% <i class="fas fa-arrow-down"></i></span></td>
                            <td>18%</td>
                            </tr>
                            <tr>
                            <td>Local Brands</td>
                            <td>₹38.20</td>
                            <td><span class="positive">+3.5% <i class="fas fa-arrow-up"></i></span></td>
                            <td>22%</td>
                            </tr>
                        </tbody>
                        </table>
                    </div>
                    </div>

                    <!-- Seasonal Trends -->
                    <div class="analysis-card seasonal-trends">
                    <div class="card-header">
                        <h3><i class="fas fa-calendar-alt"></i> Seasonal Trends</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="seasonalTrendChart"></canvas>
                    </div>
                    <div class="card-footer">
                        <div class="stat-item">
                        <span class="stat-label">Current Season</span>
                        <span class="stat-value">Summer (Peak)</span>
                        </div>
                        <div class="stat-item">
                        <span class="stat-label">Next Season</span>
                        <span class="stat-value">Monsoon (Low)</span>
                        </div>
                    </div>
                    </div>

                    <!-- Price Forecast -->
                    <div class="analysis-card price-forecast">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-bar"></i> 30-Day Price Forecast</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="priceForecastChart"></canvas>
                    </div>
                    <div class="card-footer">
                        <div class="stat-item">
                        <span class="stat-label">Projected High</span>
                        <span class="stat-value">₹44.80</span>
                        </div>
                        <div class="stat-item">
                        <span class="stat-label">Projected Low</span>
                        <span class="stat-value">₹41.20</span>
                        </div>
                    </div>
                    </div>
                </div>

                <!-- Market News & Alerts -->
                <div class="market-news-section">
                    <h3><i class="fas fa-newspaper"></i> Market News & Alerts</h3>
                    <div class="news-filter">
                    <select id="newsFilter">
                        <option value="all">All News</option>
                        <option value="urgent">Urgent Only</option>
                        <option value="supply">Supply Chain</option>
                        <option value="policy">Policy Updates</option>
                        <option value="trends">Market Trends</option>
                    </select>
                    <button id="refreshNewsBtn" class="btn btn-sm btn-outline-primary">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    </div>
                    <div class="news-items" id="newsContainer">
                    <div class="news-item urgent" data-category="supply">
                        <div class="news-badge">Urgent</div>
                        <div class="news-content">
                        <h4>Dairy Farmers Protest Disrupts Supply Chain in Northern Region</h4>
                        <p>Expected 15-20% supply reduction in Delhi NCR for next 3 days. Prices may spike by ₹3-4/L.</p>
                        <div class="news-meta">
                            <span><i class="far fa-clock"></i> 2 hours ago</span>
                            <span><i class="fas fa-tag"></i> Supply Disruption</span>
                        </div>
                        </div>
                    </div>
                    <div class="news-item" data-category="policy">
                        <div class="news-content">
                        <h4>Government Announces New Subsidy for Dairy Farmers</h4>
                        <p>₹2/L subsidy for milk supplied to cooperatives. Effective from June 1st.</p>
                        <div class="news-meta">
                            <span><i class="far fa-clock"></i> 1 day ago</span>
                            <span><i class="fas fa-tag"></i> Policy Update</span>
                        </div>
                        </div>
                    </div>
                    <div class="news-item" data-category="trends">
                        <div class="news-content">
                        <h4>New Plant-Based Milk Alternatives Gaining Market Share</h4>
                        <p>Almond and soy milk sales up 18% YoY, now account for 7% of total milk market.</p>
                        <div class="news-meta">
                            <span><i class="far fa-clock"></i> 3 days ago</span>
                            <span><i class="fas fa-tag"></i> Market Trends</span>
                        </div>
                        </div>
                    </div>
                    </div>
                </div>
            </section>
            <!-- Insurance & Government Schemes Section -->
            <section class="agri-insurance-scheme-section">
              <div class="agri-section-header">
                <div class="agri-header-content">
                  <h2><i class="fas fa-hand-holding-medical"></i> Farmer Insurance & Government Schemes</h2>
                  <p class="agri-section-description">Comprehensive insurance and government scheme management for registered farmers</p>
                </div>
                <div class="agri-header-actions">
                  <button class="agri-btn-primary" onclick="openAgriModal('addAgriSupportModal')">
                    <i class="fas fa-plus"></i> Add New Record
                  </button>
                  <button class="agri-btn-secondary" onclick="openAgriModal('agriSchemeBrowserModal')">
                    <i class="fas fa-search"></i> Browse Available Schemes
                  </button>
                  <button class="agri-btn-info" onclick="generateInsuranceReport()">
                    <i class="fas fa-chart-bar"></i> Generate Report
                  </button>
                </div>
              </div>

              <!-- Quick Stats Dashboard -->
              <div class="agri-quick-stats">
                <div class="agri-stat-card">
                  <div class="agri-stat-icon"><i class="fas fa-shield-alt"></i></div>
                  <div class="agri-stat-content">
                    <h3 id="totalInsurancePolicies">12</h3>
                    <p>Active Insurance Policies</p>
                  </div>
                </div>
                <div class="agri-stat-card">
                  <div class="agri-stat-icon"><i class="fas fa-hand-holding-usd"></i></div>
                  <div class="agri-stat-content">
                    <h3 id="totalSchemes">8</h3>
                    <p>Government Schemes</p>
                  </div>
                </div>
                <div class="agri-stat-card">
                  <div class="agri-stat-icon"><i class="fas fa-exclamation-triangle"></i></div>
                  <div class="agri-stat-content">
                    <h3 id="expiringPolicies">3</h3>
                    <p>Expiring Soon</p>
                  </div>
                </div>
                <div class="agri-stat-card">
                  <div class="agri-stat-icon"><i class="fas fa-rupee-sign"></i></div>
                  <div class="agri-stat-content">
                    <h3 id="totalBenefits">₹45,000</h3>
                    <p>Monthly Benefits</p>
                  </div>
                </div>
              </div>



              <div class="agri-support-tabs">
                <button class="agri-tab-btn agri-active" onclick="switchAgriTab('insurance', event)">Insurance Policies</button>
                <button class="agri-tab-btn" onclick="switchAgriTab('schemes', event)">Government Schemes</button>
                <button class="agri-tab-btn" onclick="switchAgriTab('documents', event)">Documents</button>
              </div>

              <div class="agri-tab-content agri-active" id="agri-insurance-tab">
                <div class="agri-support-cards">
                  <!-- Insurance Card 1 -->
                  <div class="agri-support-card agri-insurance-card" data-farmer="farmer1" data-status="active" data-type="insurance">
                    <div class="agri-card-header">
                      <h3>Livestock Protection Plan</h3>
                      <div class="agri-farmer-info">
                        <span class="agri-farmer-name"><i class="fas fa-user"></i> Shiva</span>
                        <span class="agri-farmer-id">ID: F001</span>
                      </div>

                    </div>
                    <div class="agri-card-body">
                      <div class="agri-info-row">
                        <span class="agri-info-label">Provider:</span>
                        <span class="agri-info-value">AgroCare Insurance</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Policy No:</span>
                        <span class="agri-info-value">INS-4521-MILK</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Coverage:</span>
                        <span class="agri-info-value">10 Dairy Cattle (Holstein Friesian)</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Farm Location:</span>
                        <span class="agri-info-value">Village Rampur, District Meerut</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Premium:</span>
                        <span class="agri-info-value">₹2,500/year</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Valid Till:</span>
                        <span class="agri-info-value">31 Mar 2026 <span class="agri-days-left">(287 days left)</span></span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Status:</span>
                        <span class="agri-badge agri-badge-active"><i class="fas fa-check-circle"></i> Active</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Last Claim:</span>
                        <span class="agri-info-value">No claims filed</span>
                      </div>
                    </div>

                  </div>

                  <!-- Insurance Card 2 -->
                  <div class="agri-support-card agri-insurance-card" data-farmer="farmer2" data-status="active" data-type="insurance">
                    <div class="agri-card-header">
                      <h3>Crop Insurance (PMFBY)</h3>
                      <div class="agri-farmer-info">
                        <span class="agri-farmer-name"><i class="fas fa-user"></i> Madhu</span>
                        <span class="agri-farmer-id">ID: F002</span>
                      </div>

                    </div>
                    <div class="agri-card-body">
                      <div class="agri-info-row">
                        <span class="agri-info-label">Provider:</span>
                        <span class="agri-info-value">PMFBY (Pradhan Mantri Fasal Bima Yojana)</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Policy No:</span>
                        <span class="agri-info-value">PMF-2025-7845</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Coverage:</span>
                        <span class="agri-info-value">5 Acres Maize (Kharif Season)</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Farm Location:</span>
                        <span class="agri-info-value">Village Sultanpur, District Ghaziabad</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Premium:</span>
                        <span class="agri-info-value">₹1,200/year (50% subsidized)</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Valid Till:</span>
                        <span class="agri-info-value">15 Dec 2025 <span class="agri-days-left agri-warning">(189 days left)</span></span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Status:</span>
                        <span class="agri-badge agri-badge-active"><i class="fas fa-check-circle"></i> Active</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Last Claim:</span>
                        <span class="agri-info-value">₹15,000 (Drought - 2024)</span>
                      </div>
                    </div>

                  </div>

                  <!-- Insurance Card 3 - Expiring Soon -->
                  <div class="agri-support-card agri-insurance-card agri-expiring" data-farmer="farmer3" data-status="active" data-type="insurance">
                    <div class="agri-card-header">
                      <h3>Equipment Insurance</h3>
                      <div class="agri-farmer-info">
                        <span class="agri-farmer-name"><i class="fas fa-user"></i> Ravi</span>
                        <span class="agri-farmer-id">ID: F003</span>
                      </div>
                      <div class="agri-expiry-alert">
                        <i class="fas fa-exclamation-triangle"></i> Expires in 15 days
                      </div>

                    </div>
                    <div class="agri-card-body">
                      <div class="agri-info-row">
                        <span class="agri-info-label">Provider:</span>
                        <span class="agri-info-value">Rural Equipment Insurance Co.</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Policy No:</span>
                        <span class="agri-info-value">EQP-2025-3421</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Coverage:</span>
                        <span class="agri-info-value">Tractor, Harvester, Milking Machine</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Farm Location:</span>
                        <span class="agri-info-value">Village Kharkhoda, District Sonipat</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Premium:</span>
                        <span class="agri-info-value">₹8,500/year</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Valid Till:</span>
                        <span class="agri-info-value">30 Jul 2025 <span class="agri-days-left agri-urgent">(15 days left)</span></span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Status:</span>
                        <span class="agri-badge agri-badge-warning"><i class="fas fa-exclamation-triangle"></i> Expiring Soon</span>
                      </div>
                    </div>

                  </div>
                </div>
              </div>

              <div class="agri-tab-content" id="agri-schemes-tab">
                <div class="agri-support-cards">
                  <!-- Scheme Card 1 -->
                  <div class="agri-support-card agri-scheme-card" data-farmer="farmer1" data-status="approved" data-type="scheme">
                    <div class="agri-card-header">
                      <h3>Kisan Milk Bonus Yojana</h3>
                      <div class="agri-farmer-info">
                        <span class="agri-farmer-name"><i class="fas fa-user"></i> Shiva</span>
                        <span class="agri-farmer-id">ID: F001</span>
                      </div>

                    </div>
                    <div class="agri-card-body">
                      <div class="agri-info-row">
                        <span class="agri-info-label">Scheme ID:</span>
                        <span class="agri-info-value">KMBY-2025-001</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Type:</span>
                        <span class="agri-info-value">Central Government Scheme</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Enrolled On:</span>
                        <span class="agri-info-value">10 Apr 2025</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Benefit:</span>
                        <span class="agri-info-value agri-highlight">₹500/month bonus on milk production</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Milk Quantity:</span>
                        <span class="agri-info-value">150 liters/day (Eligible)</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Next Payout:</span>
                        <span class="agri-info-value">15 Jul 2025</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Total Received:</span>
                        <span class="agri-info-value">₹1,500 (3 months)</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Status:</span>
                        <span class="agri-badge agri-badge-approved"><i class="fas fa-check-circle"></i> Active & Approved</span>
                      </div>
                      <div class="agri-progress-container">
                        <div class="agri-progress-label">Scheme Progress (2025):</div>
                        <div class="agri-progress-bar">
                          <div class="agri-progress-fill" style="width: 75%"></div>
                        </div>
                        <div class="agri-progress-text">3 of 4 installments received</div>
                      </div>
                    </div>

                  </div>

                  <!-- Scheme Card 2 -->
                  <div class="agri-support-card agri-scheme-card" data-farmer="farmer4" data-status="pending" data-type="scheme">
                    <div class="agri-card-header">
                      <h3>Dairy Entrepreneurship Development Scheme</h3>
                      <div class="agri-farmer-info">
                        <span class="agri-farmer-name"><i class="fas fa-user"></i> Meera</span>
                        <span class="agri-farmer-id">ID: F004</span>
                      </div>

                    </div>
                    <div class="agri-card-body">
                      <div class="agri-info-row">
                        <span class="agri-info-label">Scheme ID:</span>
                        <span class="agri-info-value">DEDS-2025-004</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Type:</span>
                        <span class="agri-info-value">State Government Scheme</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Applied On:</span>
                        <span class="agri-info-value">05 Mar 2025</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Benefit:</span>
                        <span class="agri-info-value agri-highlight">25% subsidy on dairy equipment (Max ₹50,000)</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Equipment Requested:</span>
                        <span class="agri-info-value">Milking Machine, Bulk Milk Cooler</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Verification:</span>
                        <span class="agri-info-value">Field visit scheduled for 20 Jul 2025</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Status:</span>
                        <span class="agri-badge agri-badge-pending"><i class="fas fa-clock"></i> Under Review</span>
                      </div>
                      <div class="agri-progress-container">
                        <div class="agri-progress-label">Application Progress:</div>
                        <div class="agri-progress-bar">
                          <div class="agri-progress-fill" style="width: 40%"></div>
                        </div>
                        <div class="agri-progress-text">Step 2 of 5 completed</div>
                      </div>
                    </div>

                  </div>

                  <!-- Scheme Card 3 - New Application -->
                  <div class="agri-support-card agri-scheme-card" data-farmer="farmer2" data-status="approved" data-type="scheme">
                    <div class="agri-card-header">
                      <h3>PM-KISAN Samman Nidhi</h3>
                      <div class="agri-farmer-info">
                        <span class="agri-farmer-name"><i class="fas fa-user"></i> Madhu</span>
                        <span class="agri-farmer-id">ID: F002</span>
                      </div>

                    </div>
                    <div class="agri-card-body">
                      <div class="agri-info-row">
                        <span class="agri-info-label">Scheme ID:</span>
                        <span class="agri-info-value">PMKISAN-2025-002</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Type:</span>
                        <span class="agri-info-value">Central Government Scheme</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Enrolled On:</span>
                        <span class="agri-info-value">15 Jan 2025</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Benefit:</span>
                        <span class="agri-info-value agri-highlight">₹6,000/year (₹2,000 per installment)</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Land Area:</span>
                        <span class="agri-info-value">2.5 Acres (Eligible)</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Last Installment:</span>
                        <span class="agri-info-value">₹2,000 received on 15 Apr 2025</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Next Installment:</span>
                        <span class="agri-info-value">Expected by 15 Aug 2025</span>
                      </div>
                      <div class="agri-info-row">
                        <span class="agri-info-label">Status:</span>
                        <span class="agri-badge agri-badge-approved"><i class="fas fa-check-circle"></i> Active</span>
                      </div>
                      <div class="agri-progress-container">
                        <div class="agri-progress-label">Annual Progress (2025):</div>
                        <div class="agri-progress-bar">
                          <div class="agri-progress-fill" style="width: 33%"></div>
                        </div>
                        <div class="agri-progress-text">1 of 3 installments received</div>
                      </div>
                    </div>

                  </div>
                </div>
              </div>

              <div class="agri-tab-content" id="agri-documents-tab">
                <div class="agri-documents-container">
                  <div class="agri-document-actions">
                    <button class="agri-btn-primary" onclick="openUploadModal()"><i class="fas fa-upload"></i> Upload Document</button>
                    <button class="agri-btn-secondary" onclick="downloadDummyFile()"><i class="fas fa-download"></i> Download Sample</button>
                  </div>
                  
                  <div class="agri-documents-grid" id="documentsGrid">
                    <div class="agri-document-card" data-filename="Insurance_Policy_2025.pdf">
                      <div class="agri-doc-icon"><i class="fas fa-file-pdf"></i></div>
                      <div class="agri-doc-details">
                        <h4>Insurance_Policy_2025.pdf</h4>
                        <p>Uploaded: 15 Jan 2025 | Farmer: Shiva</p>
                        <p>Size: 2.4 MB | Category: Insurance</p>
                      </div>
                      <div class="agri-doc-actions">
                        <button class="agri-icon-btn" title="Download" onclick="downloadDocumentFile('Insurance_Policy_2025.pdf', 'pdf')"><i class="fas fa-download"></i></button>
                        <button class="agri-icon-btn" title="Delete" onclick="deleteDocument(this, 'Insurance_Policy_2025.pdf')"><i class="fas fa-trash"></i></button>
                      </div>
                    </div>
                    
                    <div class="agri-document-card" data-filename="Scheme_Application.jpg">
                      <div class="agri-doc-icon"><i class="fas fa-file-image"></i></div>
                      <div class="agri-doc-details">
                        <h4>Scheme_Application.jpg</h4>
                        <p>Uploaded: 28 Feb 2025 | Farmer: Madhu</p>
                        <p>Size: 1.8 MB | Category: Government Scheme</p>
                      </div>
                      <div class="agri-doc-actions">
                        <button class="agri-icon-btn" title="Download" onclick="downloadDocumentFile('Scheme_Application.jpg', 'image')"><i class="fas fa-download"></i></button>
                        <button class="agri-icon-btn" title="Delete" onclick="deleteDocument(this, 'Scheme_Application.jpg')"><i class="fas fa-trash"></i></button>
                      </div>
                    </div>

                    <div class="agri-document-card" data-filename="Farmer_Registration_Form.pdf">
                      <div class="agri-doc-icon"><i class="fas fa-file-pdf"></i></div>
                      <div class="agri-doc-details">
                        <h4>Farmer_Registration_Form.pdf</h4>
                        <p>Uploaded: 10 Mar 2025 | Farmer: Ravi</p>
                        <p>Size: 1.2 MB | Category: Registration</p>
                      </div>
                      <div class="agri-doc-actions">
                        <button class="agri-icon-btn" title="Download" onclick="downloadDocumentFile('Farmer_Registration_Form.pdf', 'pdf')"><i class="fas fa-download"></i></button>
                        <button class="agri-icon-btn" title="Delete" onclick="deleteDocument(this, 'Farmer_Registration_Form.pdf')"><i class="fas fa-trash"></i></button>
                      </div>
                    </div>

                    <div class="agri-document-card" data-filename="Land_Records.pdf">
                      <div class="agri-doc-icon"><i class="fas fa-file-pdf"></i></div>
                      <div class="agri-doc-details">
                        <h4>Land_Records.pdf</h4>
                        <p>Uploaded: 05 Mar 2025 | Farmer: Meera</p>
                        <p>Size: 3.1 MB | Category: Land Documents</p>
                      </div>
                      <div class="agri-doc-actions">
                        <button class="agri-icon-btn" title="Download" onclick="downloadDocumentFile('Land_Records.pdf', 'pdf')"><i class="fas fa-download"></i></button>
                        <button class="agri-icon-btn" title="Delete" onclick="deleteDocument(this, 'Land_Records.pdf')"><i class="fas fa-trash"></i></button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
        </div>
    <!--start of insurance-->
    <!-- Enhanced Add New Record Modal with Strict Validations -->
    <div class="agri-modal" id="addAgriSupportModal">
      <div class="agri-modal-content agri-large-modal">
        <span class="agri-close" onclick="closeAgriModal('addAgriSupportModal')">&times;</span>
        <div class="agri-modal-header">
          <h2><i class="fas fa-plus-circle"></i> Add New Record</h2>
          <p>Add insurance policies or government schemes with strict validation</p>
        </div>
        
        <div class="agri-form-tabs">
          <button class="agri-form-tab agri-active" onclick="switchAgriFormTab('agri-insurance-form')">
            <i class="fas fa-shield-alt"></i> Insurance Policy
          </button>
          <button class="agri-form-tab" onclick="switchAgriFormTab('agri-scheme-form')">
            <i class="fas fa-hand-holding-usd"></i> Government Scheme
          </button>
        </div>
        
        <!-- Enhanced Insurance Form with Strict Validations -->
        <form id="agri-insurance-form" class="agri-form-content agri-active" onsubmit="return validateInsuranceForm(event)">
          
          <!-- Farmer Selection (Required) -->
          <div class="agri-form-group agri-required-field">
            <label>Select Farmer <span class="agri-required">*</span></label>
            <select class="agri-form-control" name="farmerId" id="insuranceFarmerId" required onchange="validateFarmerSelection('insurance')">
              <option value="">Choose registered farmer only</option>
              <option value="F001" data-name="Shiva" data-contact="9876543210" data-land="5.2">Shiva (F001) - 5.2 acres</option>
              <option value="F002" data-name="Madhu" data-contact="9876543211" data-land="3.8">Madhu (F002) - 3.8 acres</option>
              <option value="F003" data-name="Ravi" data-contact="9876543212" data-land="4.5">Ravi (F003) - 4.5 acres</option>
              <option value="F004" data-name="Meera" data-contact="9876543213" data-land="2.3">Meera (F004) - 2.3 acres</option>
            </select>
            <div class="agri-validation-message" id="farmerValidation"></div>
          </div>

          <!-- Insurance Type (Required) -->
          <div class="agri-form-group agri-required-field">
            <label>Insurance Type <span class="agri-required">*</span></label>
            <select class="agri-form-control" name="insuranceType" id="insuranceType" required onchange="updateInsuranceFields(this.value)">
              <option value="">Select insurance type</option>
              <option value="livestock">Livestock Insurance</option>
              <option value="crop">Crop Insurance (PMFBY)</option>
              <option value="equipment">Equipment Insurance</option>
              <option value="comprehensive">Comprehensive Farm Insurance</option>
            </select>
            <div class="agri-validation-message" id="insuranceTypeValidation"></div>
          </div>

          <!-- Dynamic Insurance Provider (Required) -->
          <div class="agri-form-group agri-required-field">
            <label>Insurance Provider <span class="agri-required">*</span></label>
            <select class="agri-form-control" name="insuranceProvider" id="insuranceProvider" required>
              <option value="">First select insurance type</option>
            </select>
            <div class="agri-validation-message" id="providerValidation"></div>
          </div>

          <!-- Policy Details Row -->
          <div class="agri-form-row">
            <div class="agri-form-group agri-required-field">
              <label>Policy Number <span class="agri-required">*</span></label>
              <input type="text" class="agri-form-control" name="policyNumber" id="policyNumber" 
                     placeholder="Format: INS-YYYY-XXXX" required 
                     pattern="^INS-[0-9]{4}-[A-Z0-9]{4}$" 
                     oninput="validatePolicyNumber(this.value)"
                     title="Format: INS-YYYY-XXXX (e.g., INS-2025-1234)">
              <div class="agri-validation-message" id="policyNumberValidation"></div>
            </div>
            <div class="agri-form-group agri-required-field">
              <label>Premium Amount (₹) <span class="agri-required">*</span></label>
              <input type="number" class="agri-form-control" name="premiumAmount" id="premiumAmount" 
                     placeholder="Enter amount" required min="500" max="100000"
                     oninput="validatePremiumAmount(this.value)">
              <div class="agri-validation-message" id="premiumValidation"></div>
            </div>
          </div>

          <!-- Date Validation Row -->
          <div class="agri-form-row">
            <div class="agri-form-group agri-required-field">
              <label>Policy Start Date <span class="agri-required">*</span></label>
              <input type="date" class="agri-form-control" name="startDate" id="insuranceStartDate" 
                     required onchange="validateInsuranceDates()">
              <div class="agri-validation-message" id="startDateValidation"></div>
            </div>
            <div class="agri-form-group agri-required-field">
              <label>Policy End Date <span class="agri-required">*</span></label>
              <input type="date" class="agri-form-control" name="endDate" id="insuranceEndDate" 
                     required onchange="validateInsuranceDates()">
              <div class="agri-validation-message" id="endDateValidation"></div>
            </div>
          </div>

          <!-- Coverage Amount (Required) -->
          <div class="agri-form-group agri-required-field">
            <label>Coverage Amount (₹) <span class="agri-required">*</span></label>
            <select class="agri-form-control" name="coverageAmount" id="coverageAmount" required onchange="validateCoverageAmount(this.value)">
              <option value="">Select coverage amount</option>
              <option value="50000">₹50,000</option>
              <option value="100000">₹1,00,000</option>
              <option value="200000">₹2,00,000</option>
              <option value="500000">₹5,00,000</option>
              <option value="1000000">₹10,00,000</option>
            </select>
            <div class="agri-validation-message" id="coverageValidation"></div>
          </div>

          <!-- Dynamic Asset Details (Based on Insurance Type) -->
          <div id="assetDetailsSection" style="display: none;">
            
            <!-- Livestock Details -->
            <div id="livestockDetails" class="agri-asset-section" style="display: none;">
              <h4><i class="fas fa-cow"></i> Livestock Details (Required for Livestock Insurance)</h4>
              <div class="agri-form-row">
                <div class="agri-form-group agri-required-field">
                  <label>Number of Animals <span class="agri-required">*</span></label>
                  <input type="number" class="agri-form-control" name="animalCount" id="animalCount" 
                         min="1" max="100" placeholder="Enter count" 
                         oninput="validateAnimalCount(this.value)">
                  <div class="agri-validation-message" id="animalCountValidation"></div>
                </div>
                <div class="agri-form-group agri-required-field">
                  <label>Animal Type <span class="agri-required">*</span></label>
                  <select class="agri-form-control" name="animalType" id="animalType">
                    <option value="">Select animal type</option>
                    <option value="cow">Cow</option>
                    <option value="buffalo">Buffalo</option>
                    <option value="goat">Goat</option>
                    <option value="sheep">Sheep</option>
                    <option value="poultry">Poultry</option>
                  </select>
                  <div class="agri-validation-message" id="animalTypeValidation"></div>
                </div>
              </div>
              <div class="agri-form-row">
                <div class="agri-form-group">
                  <label>Breed Information</label>
                  <input type="text" class="agri-form-control" name="breedInfo" placeholder="e.g., Holstein Friesian">
                </div>
                <div class="agri-form-group">
                  <label>Average Age (Years)</label>
                  <input type="number" class="agri-form-control" name="averageAge" min="1" max="20" placeholder="Average age">
                </div>
              </div>
            </div>

            <!-- Crop Details -->
            <div id="cropDetails" class="agri-asset-section" style="display: none;">
              <h4><i class="fas fa-seedling"></i> Crop Details (Required for Crop Insurance)</h4>
              <div class="agri-form-row">
                <div class="agri-form-group agri-required-field">
                  <label>Crop Type <span class="agri-required">*</span></label>
                  <select class="agri-form-control" name="cropType" id="cropType">
                    <option value="">Select crop type</option>
                    <option value="wheat">Wheat</option>
                    <option value="rice">Rice</option>
                    <option value="sugarcane">Sugarcane</option>
                    <option value="cotton">Cotton</option>
                    <option value="maize">Maize</option>
                    <option value="soybean">Soybean</option>
                  </select>
                  <div class="agri-validation-message" id="cropTypeValidation"></div>
                </div>
                <div class="agri-form-group agri-required-field">
                  <label>Cultivated Area (Acres) <span class="agri-required">*</span></label>
                  <input type="number" class="agri-form-control" name="cultivatedArea" id="cultivatedArea" 
                         min="0.1" step="0.1" placeholder="Area in acres"
                         oninput="validateCultivatedArea(this.value)">
                  <div class="agri-validation-message" id="cultivatedAreaValidation"></div>
                </div>
              </div>
              <div class="agri-form-row">
                <div class="agri-form-group agri-required-field">
                  <label>Sowing Season <span class="agri-required">*</span></label>
                  <select class="agri-form-control" name="sowingSeason" id="sowingSeason">
                    <option value="">Select season</option>
                    <option value="kharif">Kharif (Monsoon)</option>
                    <option value="rabi">Rabi (Winter)</option>
                    <option value="zaid">Zaid (Summer)</option>
                  </select>
                  <div class="agri-validation-message" id="seasonValidation"></div>
                </div>
                <div class="agri-form-group">
                  <label>Expected Yield (Quintals)</label>
                  <input type="number" class="agri-form-control" name="expectedYield" min="1" placeholder="Expected yield">
                </div>
              </div>
            </div>

            <!-- Equipment Details -->
            <div id="equipmentDetails" class="agri-asset-section" style="display: none;">
              <h4><i class="fas fa-tractor"></i> Equipment Details (Required for Equipment Insurance)</h4>
              <div class="agri-form-row">
                <div class="agri-form-group agri-required-field">
                  <label>Equipment Type <span class="agri-required">*</span></label>
                  <select class="agri-form-control" name="equipmentType" id="equipmentType">
                    <option value="">Select equipment</option>
                    <option value="tractor">Tractor</option>
                    <option value="harvester">Harvester</option>
                    <option value="thresher">Thresher</option>
                    <option value="pump">Water Pump</option>
                    <option value="sprayer">Sprayer</option>
                    <option value="other">Other Equipment</option>
                  </select>
                  <div class="agri-validation-message" id="equipmentTypeValidation"></div>
                </div>
                <div class="agri-form-group agri-required-field">
                  <label>Equipment Value (₹) <span class="agri-required">*</span></label>
                  <input type="number" class="agri-form-control" name="equipmentValue" id="equipmentValue" 
                         min="10000" placeholder="Current market value"
                         oninput="validateEquipmentValue(this.value)">
                  <div class="agri-validation-message" id="equipmentValueValidation"></div>
                </div>
              </div>
              <div class="agri-form-row">
                <div class="agri-form-group">
                  <label>Purchase Date</label>
                  <input type="date" class="agri-form-control" name="purchaseDate" id="purchaseDate">
                </div>
                <div class="agri-form-group">
                  <label>Brand/Model</label>
                  <input type="text" class="agri-form-control" name="brandModel" placeholder="e.g., Mahindra 575">
                </div>
              </div>
            </div>
          </div>

          <!-- Required Documents -->
          <div class="agri-form-group agri-required-field">
            <label>Upload Required Documents <span class="agri-required">*</span></label>
            <div class="agri-file-upload-area">
              <input type="file" class="agri-form-control" name="insuranceDocuments" id="insuranceDocuments" 
                     multiple accept=".pdf,.jpg,.jpeg,.png" onchange="validateInsuranceDocuments(this.files)">
              <div class="agri-upload-hint">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Required: Aadhar Card, Land Records, Bank Details, Asset Photos</p>
                <p>Accepted formats: PDF, JPG, PNG (Max 5MB each)</p>
              </div>
            </div>
            <div class="agri-validation-message" id="documentsValidation"></div>
          </div>

          <!-- Form Actions -->
          <div class="agri-form-actions">
            <button type="button" class="agri-btn-secondary" onclick="resetInsuranceForm()">
              <i class="fas fa-undo"></i> Reset Form
            </button>
            <button type="submit" class="agri-btn-primary" id="submitInsuranceBtn">
              <i class="fas fa-save"></i> Save Insurance Policy
            </button>
          </div>
        </form>

        <!-- Enhanced Government Scheme Form with Strict Validations -->
        <form id="agri-scheme-form" class="agri-form-content" onsubmit="return validateSchemeForm(event)">
          
          <!-- Farmer Selection (Required) -->
          <div class="agri-form-group agri-required-field">
            <label>Select Farmer <span class="agri-required">*</span></label>
            <select class="agri-form-control" name="farmerId" id="schemeFarmerId" required onchange="validateFarmerSelection('scheme')">
              <option value="">Choose registered farmer only</option>
              <option value="F001" data-name="Shiva" data-contact="9876543210" data-land="5.2">Shiva (F001) - 5.2 acres</option>
              <option value="F002" data-name="Madhu" data-contact="9876543211" data-land="3.8">Madhu (F002) - 3.8 acres</option>
              <option value="F003" data-name="Ravi" data-contact="9876543212" data-land="4.5">Ravi (F003) - 4.5 acres</option>
              <option value="F004" data-name="Meera" data-contact="9876543213" data-land="2.3">Meera (F004) - 2.3 acres</option>
            </select>
            <div class="agri-validation-message" id="schemeFarmerValidation"></div>
          </div>

          <!-- Scheme Type (Required) -->
          <div class="agri-form-group agri-required-field">
            <label>Government Scheme <span class="agri-required">*</span></label>
            <select class="agri-form-control" name="schemeType" id="schemeType" required onchange="updateSchemeFields(this.value)">
              <option value="">Select government scheme</option>
              <option value="pmkisan">PM-KISAN Samman Nidhi</option>
              <option value="pmfby">Pradhan Mantri Fasal Bima Yojana</option>
              <option value="deds">Dairy Entrepreneurship Development Scheme</option>
              <option value="kmby">Kisan Milk Bonus Yojana</option>
              <option value="kcc">Kisan Credit Card</option>
              <option value="soil-health">Soil Health Card Scheme</option>
            </select>
            <div class="agri-validation-message" id="schemeTypeValidation"></div>
          </div>

          <!-- Dynamic Scheme Details -->
          <div id="schemeDetailsSection" style="display: none;">
            
            <!-- PM-KISAN Details -->
            <div id="pmkisanDetails" class="agri-scheme-section" style="display: none;">
              <h4><i class="fas fa-rupee-sign"></i> PM-KISAN Details</h4>
              <div class="agri-info-box">
                <p><strong>Benefit:</strong> ₹6,000 per year in 3 installments of ₹2,000 each</p>
                <p><strong>Eligibility:</strong> Small and marginal farmers with cultivable land</p>
              </div>
              <div class="agri-form-group agri-required-field">
                <label>Land Ownership Type <span class="agri-required">*</span></label>
                <select class="agri-form-control" name="landOwnership" id="landOwnership">
                  <option value="">Select ownership type</option>
                  <option value="own">Own Land</option>
                  <option value="leased">Leased Land</option>
                  <option value="sharecropper">Sharecropper</option>
                </select>
                <div class="agri-validation-message" id="landOwnershipValidation"></div>
              </div>
            </div>

            <!-- DEDS Details -->
            <div id="dedsDetails" class="agri-scheme-section" style="display: none;">
              <h4><i class="fas fa-cow"></i> Dairy Entrepreneurship Development Scheme</h4>
              <div class="agri-info-box">
                <p><strong>Benefit:</strong> 25-33% subsidy on dairy infrastructure</p>
                <p><strong>Max Subsidy:</strong> ₹50,000 for individual farmers</p>
              </div>
              <div class="agri-form-row">
                <div class="agri-form-group agri-required-field">
                  <label>Project Type <span class="agri-required">*</span></label>
                  <select class="agri-form-control" name="projectType" id="projectType">
                    <option value="">Select project</option>
                    <option value="dairy-farm">Dairy Farm Setup</option>
                    <option value="milk-processing">Milk Processing Unit</option>
                    <option value="cattle-feed">Cattle Feed Unit</option>
                  </select>
                  <div class="agri-validation-message" id="projectTypeValidation"></div>
                </div>
                <div class="agri-form-group agri-required-field">
                  <label>Project Cost (₹) <span class="agri-required">*</span></label>
                  <input type="number" class="agri-form-control" name="projectCost" id="projectCost" 
                         min="50000" max="500000" placeholder="Total project cost"
                         oninput="calculateSubsidy(this.value)">
                  <div class="agri-validation-message" id="projectCostValidation"></div>
                </div>
              </div>
              <div class="agri-form-group">
                <label>Expected Subsidy Amount</label>
                <input type="text" class="agri-form-control" name="expectedSubsidy" id="expectedSubsidy" readonly>
              </div>
            </div>

            <!-- KMBY Details -->
            <div id="kmbyDetails" class="agri-scheme-section" style="display: none;">
              <h4><i class="fas fa-tint"></i> Kisan Milk Bonus Yojana</h4>
              <div class="agri-info-box">
                <p><strong>Benefit:</strong> ₹500 per month bonus on milk production</p>
                <p><strong>Minimum:</strong> 150 liters per day milk production required</p>
              </div>
              <div class="agri-form-row">
                <div class="agri-form-group agri-required-field">
                  <label>Daily Milk Production (Liters) <span class="agri-required">*</span></label>
                  <input type="number" class="agri-form-control" name="milkProduction" id="milkProduction" 
                         min="150" placeholder="Daily production"
                         oninput="validateMilkProduction(this.value)">
                  <div class="agri-validation-message" id="milkProductionValidation"></div>
                </div>
                <div class="agri-form-group agri-required-field">
                  <label>Milk Collection Center <span class="agri-required">*</span></label>
                  <input type="text" class="agri-form-control" name="collectionCenter" placeholder="Center name/location">
                  <div class="agri-validation-message" id="collectionCenterValidation"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Application Details -->
          <div class="agri-form-row">
            <div class="agri-form-group agri-required-field">
              <label>Application Date <span class="agri-required">*</span></label>
              <input type="date" class="agri-form-control" name="applicationDate" id="applicationDate" 
                     required onchange="validateApplicationDate(this.value)">
              <div class="agri-validation-message" id="applicationDateValidation"></div>
            </div>
            <div class="agri-form-group">
              <label>Expected Approval Date</label>
              <input type="date" class="agri-form-control" name="expectedApproval" id="expectedApproval" readonly>
            </div>
          </div>

          <!-- Required Documents -->
          <div class="agri-form-group agri-required-field">
            <label>Upload Required Documents <span class="agri-required">*</span></label>
            <div class="agri-file-upload-area">
              <input type="file" class="agri-form-control" name="schemeDocuments" id="schemeDocuments" 
                     multiple accept=".pdf,.jpg,.jpeg,.png" onchange="validateSchemeDocuments(this.files)">
              <div class="agri-upload-hint">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Required: Aadhar Card, Land Records, Bank Passbook, Income Certificate</p>
                <p>Accepted formats: PDF, JPG, PNG (Max 5MB each)</p>
              </div>
            </div>
            <div class="agri-validation-message" id="schemeDocumentsValidation"></div>
          </div>

          <!-- Form Actions -->
          <div class="agri-form-actions">
            <button type="button" class="agri-btn-secondary" onclick="resetSchemeForm()">
              <i class="fas fa-undo"></i> Reset Form
            </button>
            <button type="submit" class="agri-btn-primary" id="submitSchemeBtn">
              <i class="fas fa-save"></i> Save Scheme Application
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Scheme Browser Modal -->
    <!-- Enhanced Scheme Browser Modal -->
    <div class="agri-modal agri-large-modal" id="agriSchemeBrowserModal">
      <div class="agri-modal-content">
        <div class="agri-modal-header">
          <h2><i class="fas fa-search"></i> Browse Available Government Schemes</h2>
          <p>Discover and apply for various government schemes and subsidies available for farmers</p>
          <span class="agri-close" onclick="closeAgriModal('agriSchemeBrowserModal')">&times;</span>
        </div>
        
        <!-- Enhanced Filter Section -->
        <div class="agri-enhanced-filters">
          <div class="agri-filter-row">
            <div class="agri-filter-group">
              <label><i class="fas fa-flag"></i> Government Level</label>
              <select class="agri-form-control" id="governmentFilter" onchange="filterSchemes()">
                <option value="all">All Schemes</option>
                <option value="central">Central Government</option>
                <option value="state">State Government</option>
                <option value="district">District Level</option>
              </select>
            </div>
            
            <div class="agri-filter-group">
              <label><i class="fas fa-tags"></i> Category</label>
              <select class="agri-form-control" id="categoryFilter" onchange="filterSchemes()">
                <option value="all">All Categories</option>
                <option value="dairy">Dairy & Livestock</option>
                <option value="crop">Crop Production</option>
                <option value="equipment">Equipment & Machinery</option>
                <option value="irrigation">Irrigation & Water</option>
                <option value="organic">Organic Farming</option>
                <option value="insurance">Insurance & Risk</option>
                <option value="credit">Credit & Finance</option>
                <option value="training">Training & Skill</option>
              </select>
            </div>
            
            <div class="agri-filter-group">
              <label><i class="fas fa-map-marker-alt"></i> State</label>
              <select class="agri-form-control" id="stateFilter" onchange="filterSchemes()">
                <option value="all">All States</option>
                <option value="uttar-pradesh">Uttar Pradesh</option>
                <option value="maharashtra">Maharashtra</option>
                <option value="punjab">Punjab</option>
                <option value="haryana">Haryana</option>
                <option value="gujarat">Gujarat</option>
                <option value="rajasthan">Rajasthan</option>
                <option value="karnataka">Karnataka</option>
                <option value="tamil-nadu">Tamil Nadu</option>
                <option value="andhra-pradesh">Andhra Pradesh</option>
                <option value="west-bengal">West Bengal</option>
              </select>
            </div>
            
            <div class="agri-filter-group">
              <label><i class="fas fa-rupee-sign"></i> Benefit Amount</label>
              <select class="agri-form-control" id="amountFilter" onchange="filterSchemes()">
                <option value="all">Any Amount</option>
                <option value="low">Up to ₹50,000</option>
                <option value="medium">₹50,000 - ₹2,00,000</option>
                <option value="high">Above ₹2,00,000</option>
              </select>
            </div>
          </div>
          
          <div class="agri-filter-row">
            <div class="agri-search-box-enhanced">
              <input type="text" id="schemeSearchInput" placeholder="Search schemes by name, keywords, or benefits..." onkeyup="searchSchemes()">
              <button class="agri-search-btn" onclick="searchSchemes()">
                <i class="fas fa-search"></i>
              </button>
            </div>
            
            <div class="agri-filter-actions">
              <button class="agri-btn-secondary" onclick="clearAllFilters()">
                <i class="fas fa-times"></i> Clear Filters
              </button>
              <button class="agri-btn-info" onclick="exportSchemesList()">
                <i class="fas fa-download"></i> Export List
              </button>
            </div>
          </div>
        </div>

        <!-- Scheme Statistics -->
        <div class="agri-scheme-stats">
          <div class="agri-stat-item">
            <span class="agri-stat-number" id="totalSchemesCount">45</span>
            <span class="agri-stat-label">Total Schemes</span>
          </div>
          <div class="agri-stat-item">
            <span class="agri-stat-number" id="centralSchemesCount">28</span>
            <span class="agri-stat-label">Central Schemes</span>
          </div>
          <div class="agri-stat-item">
            <span class="agri-stat-number" id="stateSchemesCount">17</span>
            <span class="agri-stat-label">State Schemes</span>
          </div>
          <div class="agri-stat-item">
            <span class="agri-stat-number" id="activeSchemesCount">42</span>
            <span class="agri-stat-label">Currently Active</span>
          </div>
        </div>
        
        <!-- Enhanced Schemes List -->
        <div class="agri-schemes-container" id="schemesContainer">
          <!-- Central Government Schemes -->
          <div class="agri-scheme-card" data-government="central" data-category="dairy" data-state="all" data-amount="low">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>Pradhan Mantri Kisan Samman Nidhi (PM-KISAN)</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-central">Central Govt</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">₹6,000/year</div>
            </div>
            <div class="agri-scheme-body">
              <p>Direct income support to all landholding farmer families to supplement their financial needs for procuring various inputs.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-calendar-alt"></i>
                  <span>Quarterly installments of ₹2,000</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-users"></i>
                  <span>All landholding farmers eligible</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-clock"></i>
                  <span>Application: Year-round</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('pm-kisan')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('pm-kisan')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('pm-kisan')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>

          <div class="agri-scheme-card" data-government="central" data-category="insurance" data-state="all" data-amount="medium">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>Pradhan Mantri Fasal Bima Yojana (PMFBY)</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-central">Central Govt</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">Up to ₹2,00,000</div>
            </div>
            <div class="agri-scheme-body">
              <p>Comprehensive crop insurance scheme providing financial support to farmers suffering crop loss/damage.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-shield-alt"></i>
                  <span>2% premium for Kharif, 1.5% for Rabi</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-seedling"></i>
                  <span>All food & oilseed crops covered</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-calendar-check"></i>
                  <span>Season-wise application</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('pmfby')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('pmfby')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('pmfby')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>

          <div class="agri-scheme-card" data-government="central" data-category="dairy" data-state="all" data-amount="high">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>Dairy Entrepreneurship Development Scheme (DEDS)</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-central">Central Govt</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">25-33% Subsidy</div>
            </div>
            <div class="agri-scheme-body">
              <p>Promotes dairy entrepreneurship through financial assistance for setting up dairy farms and processing units.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-cow"></i>
                  <span>Dairy farming & processing units</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-rupee-sign"></i>
                  <span>Max subsidy: ₹40 lakh</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-users"></i>
                  <span>Individual/Group/Cooperative</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('deds')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('deds')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('deds')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>

          <div class="agri-scheme-card" data-government="central" data-category="credit" data-state="all" data-amount="high">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>Kisan Credit Card (KCC)</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-central">Central Govt</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">Up to ₹3,00,000</div>
            </div>
            <div class="agri-scheme-body">
              <p>Provides adequate and timely credit support for comprehensive credit needs of farmers.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-credit-card"></i>
                  <span>4% interest rate (with subsidy)</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-clock"></i>
                  <span>Flexible repayment terms</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-shield-alt"></i>
                  <span>Accident insurance coverage</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('kcc')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('kcc')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('kcc')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>

          <div class="agri-scheme-card" data-government="central" data-category="equipment" data-state="all" data-amount="medium">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>Sub-Mission on Agricultural Mechanization (SMAM)</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-central">Central Govt</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">40-50% Subsidy</div>
            </div>
            <div class="agri-scheme-body">
              <p>Promotes farm mechanization through subsidies on agricultural machinery and equipment.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-tractor"></i>
                  <span>Tractors, harvesters, implements</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-percentage"></i>
                  <span>Up to 50% subsidy for SC/ST</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-users"></i>
                  <span>Individual & Custom Hiring Centers</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('smam')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('smam')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('smam')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>

          <!-- State Government Schemes -->
          <div class="agri-scheme-card" data-government="state" data-category="dairy" data-state="uttar-pradesh" data-amount="medium">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>UP Kisan Milk Bonus Yojana</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-state">UP State Govt</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">₹2/liter Bonus</div>
            </div>
            <div class="agri-scheme-body">
              <p>Additional bonus payment to dairy farmers for quality milk production in Uttar Pradesh.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-tint"></i>
                  <span>₹2 bonus per liter of milk</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-award"></i>
                  <span>Quality-based incentives</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-map-marker-alt"></i>
                  <span>UP residents only</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('up-kmby')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('up-kmby')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('up-kmby')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>

          <div class="agri-scheme-card" data-government="state" data-category="crop" data-state="punjab" data-amount="low">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>Punjab Crop Diversification Scheme</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-state">Punjab State</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">₹17,500/acre</div>
            </div>
            <div class="agri-scheme-body">
              <p>Encourages farmers to shift from paddy to alternative crops to conserve groundwater.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-seedling"></i>
                  <span>Maize, cotton, sugarcane, basmati</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-tint"></i>
                  <span>Water conservation focus</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-leaf"></i>
                  <span>Sustainable farming promotion</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('punjab-diversification')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('punjab-diversification')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('punjab-diversification')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>

          <div class="agri-scheme-card" data-government="state" data-category="irrigation" data-state="maharashtra" data-amount="high">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>Maharashtra Drip Irrigation Subsidy</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-state">Maharashtra</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">50-80% Subsidy</div>
            </div>
            <div class="agri-scheme-body">
              <p>Promotes water-efficient irrigation systems through substantial subsidies on drip and sprinkler systems.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-tint"></i>
                  <span>Drip & sprinkler systems</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-percentage"></i>
                  <span>80% subsidy for small farmers</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-chart-line"></i>
                  <span>30-50% water savings</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('mh-drip')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('mh-drip')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('mh-drip')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>

          <div class="agri-scheme-card" data-government="state" data-category="organic" data-state="gujarat" data-amount="medium">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>Gujarat Organic Farming Promotion Scheme</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-state">Gujarat State</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">₹50,000/ha</div>
            </div>
            <div class="agri-scheme-body">
              <p>Supports transition to organic farming with financial assistance and technical guidance.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-leaf"></i>
                  <span>Organic certification support</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-graduation-cap"></i>
                  <span>Training & technical support</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-recycle"></i>
                  <span>Compost & bio-fertilizer subsidy</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('gujarat-organic')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('gujarat-organic')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('gujarat-organic')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>

          <div class="agri-scheme-card" data-government="state" data-category="training" data-state="karnataka" data-amount="low">
            <div class="agri-scheme-header">
              <div class="agri-scheme-title">
                <h3>Karnataka Farmer Skill Development Program</h3>
                <div class="agri-scheme-badges">
                  <span class="agri-scheme-badge agri-state">Karnataka</span>
                  <span class="agri-scheme-badge agri-active">Active</span>
                </div>
              </div>
              <div class="agri-scheme-amount">Free Training</div>
            </div>
            <div class="agri-scheme-body">
              <p>Comprehensive skill development program for farmers covering modern agricultural practices.</p>
              <div class="agri-scheme-highlights">
                <div class="agri-highlight-item">
                  <i class="fas fa-graduation-cap"></i>
                  <span>Free training programs</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-certificate"></i>
                  <span>Certification provided</span>
                </div>
                <div class="agri-highlight-item">
                  <i class="fas fa-laptop"></i>
                  <span>Digital agriculture training</span>
                </div>
              </div>
            </div>
            <div class="agri-scheme-footer">
              <button class="agri-btn-outline" onclick="viewSchemeDetails('karnataka-skill')">
                <i class="fas fa-info-circle"></i> View Details
              </button>
              <button class="agri-btn-success" onclick="checkEligibility('karnataka-skill')">
                <i class="fas fa-check-circle"></i> Check Eligibility
              </button>
              <button class="agri-btn-primary" onclick="applyForScheme('karnataka-skill')">
                <i class="fas fa-file-alt"></i> Apply Now
              </button>
            </div>
          </div>
        </div>

        <!-- Pagination -->
        <div class="agri-pagination">
          <button class="agri-btn-outline" onclick="previousPage()" id="prevBtn">
            <i class="fas fa-chevron-left"></i> Previous
          </button>
          <span class="agri-page-info">
            Showing <span id="currentPageInfo">1-10</span> of <span id="totalSchemesInfo">45</span> schemes
          </span>
          <button class="agri-btn-outline" onclick="nextPage()" id="nextBtn">
            Next <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Document Upload Modal -->
    <div class="agri-modal" id="documentUploadModal">
      <div class="agri-modal-content">
        <div class="agri-modal-header">
          <h2><i class="fas fa-upload"></i> Upload Document</h2>
          <p>Upload documents for farmer records and applications</p>
          <span class="agri-close" onclick="closeUploadModal()">&times;</span>
        </div>
        
        <div class="agri-modal-body">
          <form id="documentUploadForm" onsubmit="uploadDocument(event)">
            <div class="agri-form-group">
              <label>Document Title <span class="agri-required">*</span></label>
              <input type="text" class="agri-form-control" id="documentTitle" placeholder="Enter document title" required>
            </div>
            
            <div class="agri-form-group">
              <label>Document Category</label>
              <select class="agri-form-control" id="documentCategory">
                <option value="insurance">Insurance Documents</option>
                <option value="scheme">Government Scheme</option>
                <option value="registration">Registration Forms</option>
                <option value="identity">Identity Proof</option>
                <option value="land">Land Records</option>
                <option value="bank">Bank Documents</option>
                <option value="other">Other</option>
              </select>
            </div>
            
            <div class="agri-form-group">
              <label>Select Farmer</label>
              <select class="agri-form-control" id="documentFarmer">
                <option value="">Select Farmer (Optional)</option>
                <option value="F001">Shiva (F001)</option>
                <option value="F002">Madhu (F002)</option>
                <option value="F003">Ravi (F003)</option>
                <option value="F004">Meera (F004)</option>
              </select>
            </div>
            
            <div class="agri-form-group">
              <label>Upload File <span class="agri-required">*</span></label>
              <div class="agri-file-upload-area" id="fileUploadArea">
                <input type="file" class="agri-form-control" id="documentFile" 
                       accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" onchange="handleFileSelect(this)" required>
                <div class="agri-upload-hint">
                  <i class="fas fa-cloud-upload-alt"></i>
                  <p>Click to select file or drag and drop</p>
                  <p>Supported formats: PDF, JPG, PNG, DOC, DOCX (Max 10MB)</p>
                </div>
                <div class="agri-file-preview" id="filePreview" style="display: none;">
                  <div class="agri-file-info">
                    <i class="fas fa-file"></i>
                    <span id="fileName"></span>
                    <span id="fileSize"></span>
                  </div>
                  <button type="button" class="agri-remove-file" onclick="removeFile()">
                    <i class="fas fa-times"></i>
                  </button>
                </div>
              </div>
              <div class="agri-validation-message" id="fileValidation"></div>
            </div>
            
            <div class="agri-form-group">
              <label>Description</label>
              <textarea class="agri-form-control" id="documentDescription" rows="3" 
                        placeholder="Add any additional notes or description"></textarea>
            </div>
            
            <div class="agri-form-actions">
              <button type="button" class="agri-btn-secondary" onclick="closeUploadModal()">
                <i class="fas fa-times"></i> Cancel
              </button>
              <button type="submit" class="agri-btn-primary">
                <i class="fas fa-upload"></i> Upload Document
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <style>
    .agri-insurance-scheme-section {
      padding: 30px;
      background: #fff;
      border-radius: 16px;
      margin-bottom: 40px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .agri-section-header {
      margin-bottom: 25px;
    }

    .agri-header-content h2 {
      font-size: 1.6rem;
      color: #2c3e50;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .agri-header-content h2 i {
      color: #27ae60;
    }

    .agri-section-description {
      color: #7f8c8d;
      font-size: 0.95rem;
      margin: 0;
    }

    .agri-header-actions {
      display: flex;
      gap: 15px;
      margin-top: 15px;
    }

    .agri-btn-primary {
      background-color: #27ae60;
      color: #fff;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }

    .agri-btn-primary:hover {
      background-color: #219653;
      transform: translateY(-2px);
    }

    .agri-btn-secondary {
      background-color: #3498db;
      color: #fff;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }

    .agri-btn-secondary:hover {
      background-color: #2980b9;
      transform: translateY(-2px);
    }

    .agri-support-tabs {
      display: flex;
      border-bottom: 1px solid #e0e0e0;
      margin-bottom: 20px;
    }

    .agri-tab-btn {
      padding: 10px 20px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-weight: 500;
      color: #7f8c8d;
      transition: all 0.3s;
    }

    .agri-tab-btn.agri-active {
      color: #27ae60;
      border-bottom-color: #27ae60;
    }

    .agri-tab-btn:hover:not(.agri-active) {
      color: #34495e;
    }

    .agri-tab-content {
      display: none;
    }

    .agri-tab-content.agri-active {
      display: block;
    }

    .agri-support-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 20px;
    }

    .agri-support-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .agri-support-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    .agri-insurance-card {
      border-top: 4px solid #3498db;
    }

    .agri-scheme-card {
      border-top: 4px solid #9b59b6;
    }

    .agri-card-header {
      padding: 15px 20px;
      background: #f8f9fa;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .agri-card-header h3 {
      margin: 0;
      font-size: 1.1rem;
      color: #2c3e50;
    }

    .agri-card-actions {
      display: flex;
      gap: 8px;
    }

    .agri-icon-btn {
      background: none;
      border: none;
      color: #7f8c8d;
      cursor: pointer;
      font-size: 0.9rem;
      transition: color 0.3s;
    }

    .agri-icon-btn:hover {
      color: #27ae60;
    }

    .agri-card-body {
      padding: 15px 20px;
    }

    .agri-info-row {
      display: flex;
      margin-bottom: 10px;
      font-size: 0.95rem;
    }

    .agri-info-label {
      width: 120px;
      color: #7f8c8d;
      font-weight: 500;
    }

    .agri-info-value {
      flex: 1;
      color: #2c3e50;
    }

    .agri-highlight {
      color: #27ae60;
      font-weight: 500;
    }

    .agri-days-left {
      font-size: 0.8rem;
      color: #7f8c8d;
      margin-left: 5px;
    }

    .agri-badge {
      padding: 5px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: bold;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .agri-badge i {
      font-size: 0.8rem;
    }

    .agri-badge-active {
      background: #e0f7fa;
      color: #00796b;
    }

    .agri-badge-approved {
      background: #e8f5e9;
      color: #2e7d32;
    }

    .agri-badge-pending {
      background: #fff3e0;
      color: #e65100;
    }

    .agri-progress-container {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px dashed #eee;
    }

    .agri-progress-label {
      font-size: 0.85rem;
      color: #7f8c8d;
      margin-bottom: 5px;
    }

    .agri-progress-bar {
      height: 8px;
      background: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
    }

    .agri-progress-fill {
      height: 100%;
      background: #27ae60;
      border-radius: 4px;
    }

    .agri-progress-text {
      font-size: 0.8rem;
      color: #7f8c8d;
      margin-top: 5px;
      text-align: right;
    }

    .agri-card-footer {
      padding: 12px 20px;
      background: #f8f9fa;
      border-top: 1px solid #eee;
      display: flex;
      justify-content: space-between;
    }

    .agri-footer-link {
      color: #3498db;
      text-decoration: none;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .agri-footer-link:hover {
      text-decoration: underline;
    }

    .agri-documents-container {
      padding: 15px 0;
    }

    .agri-document-actions {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .agri-search-box {
      position: relative;
      width: 250px;
    }

    .agri-search-box input {
      width: 100%;
      padding: 8px 15px 8px 35px;
      border: 1px solid #ddd;
      border-radius: 20px;
    }

    .agri-search-box i {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #7f8c8d;
    }

    .agri-documents-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 15px;
    }

    .agri-document-card {
      display: flex;
      padding: 15px;
      border: 1px solid #eee;
      border-radius: 8px;
      transition: all 0.3s;
    }

    .agri-document-card:hover {
      border-color: #3498db;
      box-shadow: 0 3px 10px rgba(52, 152, 219, 0.1);
    }

    .agri-doc-icon {
      font-size: 2rem;
      color: #e74c3c;
      margin-right: 15px;
    }

    .agri-doc-details {
      flex: 1;
    }

    .agri-doc-details h4 {
      margin: 0 0 5px 0;
      font-size: 0.95rem;
      color: #2c3e50;
    }

    .agri-doc-details p {
      margin: 0;
      font-size: 0.8rem;
      color: #7f8c8d;
    }

    .agri-doc-actions {
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 10px;
    }

    /* Modal Styles */
    .agri-modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
    }

    .agri-modal-content {
      background-color: #fff;
      border-radius: 12px;
      width: 500px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      animation: agriModalFadeIn 0.3s;
    }

    .agri-wide-modal {
      width: 800px;
    }

    @keyframes agriModalFadeIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .agri-modal-content h2 {
      padding: 20px 25px 10px;
      margin: 0;
      color: #2c3e50;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .agri-modal-content h2 i {
      color: #27ae60;
    }

    .agri-modal .agri-close {
      position: absolute;
      right: 15px;
      top: 15px;
      font-size: 1.8rem;
      color: #aaa;
      cursor: pointer;
      transition: color 0.3s;
    }

    .agri-modal .agri-close:hover {
      color: #e74c3c;
    }

    .agri-form-tabs {
      display: flex;
      border-bottom: 1px solid #e0e0e0;
      padding: 0 25px;
    }

    .agri-form-tab {
      padding: 10px 20px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-weight: 500;
      color: #7f8c8d;
      transition: all 0.3s;
    }

    .agri-form-tab.agri-active {
      color: #27ae60;
      border-bottom-color: #27ae60;
    }

    .agri-form-content {
      padding: 20px 25px;
      display: none;
    }

    .agri-form-content.agri-active {
      display: block;
    }

    .agri-form-group {
      margin-bottom: 15px;
    }

    .agri-form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #2c3e50;
    }

    .agri-form-control {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 0.95rem;
    }

    .agri-form-control:focus {
      border-color: #3498db;
      outline: none;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }

    .agri-form-row {
      display: flex;
      gap: 15px;
    }

    .agri-form-row .agri-form-group {
      flex: 1;
    }

    textarea.agri-form-control {
      min-height: 80px;
      resize: vertical;
    }

    .agri-file-upload {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .agri-upload-btn {
      background: #f8f9fa;
      border: 1px dashed #ccc;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }

    .agri-upload-btn:hover {
      background: #e9ecef;
      border-color: #3498db;
      color: #3498db;
    }

    .agri-file-name {
      font-size: 0.85rem;
      color: #7f8c8d;
    }

    .agri-full-width {
      width: 100%;
      margin-top: 10px;
    }

    /* Enhanced Form Validation Styles */
    .agri-required-field label .agri-required {
      color: #e74c3c;
      font-weight: bold;
      margin-left: 3px;
    }

    .agri-required-field {
      position: relative;
    }

    .agri-validation-message {
      font-size: 0.8rem;
      margin-top: 5px;
      padding: 5px 8px;
      border-radius: 4px;
      display: none;
    }

    .agri-validation-message.agri-error {
      background-color: #ffeaea;
      color: #e74c3c;
      border: 1px solid #f5c6cb;
    }

    .agri-validation-message.agri-success {
      background-color: #eafaf1;
      color: #27ae60;
      border: 1px solid #c3e6cb;
    }

    .agri-form-control.agri-error {
      border-color: #e74c3c;
      box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1);
    }

    .agri-form-control.agri-success {
      border-color: #27ae60;
      box-shadow: 0 0 0 3px rgba(39, 174, 96, 0.1);
    }

    .agri-large-modal .agri-modal-content {
      max-width: 900px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }

    .agri-medium-modal .agri-modal-content {
      max-width: 600px;
      width: 80%;
    }

    .agri-modal-header {
      border-bottom: 2px solid #f8f9fa;
      padding-bottom: 15px;
      margin-bottom: 20px;
    }

    .agri-modal-header h2 {
      margin: 0 0 8px 0;
      color: #2c3e50;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .agri-modal-header p {
      margin: 0;
      color: #7f8c8d;
      font-size: 0.9rem;
    }

    .agri-enhanced-form {
      max-height: 70vh;
      overflow-y: auto;
      padding-right: 10px;
    }

    .agri-asset-section {
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin: 15px 0;
      border: 1px solid #e9ecef;
    }

    .agri-asset-section h4 {
      margin: 0 0 15px 0;
      color: #2c3e50;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .agri-scheme-section {
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin: 15px 0;
      border: 1px solid #e9ecef;
    }

    .agri-scheme-section h4 {
      margin: 0 0 15px 0;
      color: #2c3e50;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .agri-info-box {
      background-color: #e8f4fd;
      border: 1px solid #bee5eb;
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 15px;
    }

    .agri-info-box p {
      margin: 0 0 5px 0;
      font-size: 0.9rem;
      color: #0c5460;
    }

    .agri-info-box p:last-child {
      margin-bottom: 0;
    }

    .agri-file-upload-area {
      border: 2px dashed #dee2e6;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      background-color: #f8f9fa;
      transition: all 0.3s ease;
    }

    .agri-file-upload-area:hover {
      border-color: #3498db;
      background-color: #f0f8ff;
    }

    .agri-upload-hint {
      margin-top: 10px;
    }

    .agri-upload-hint i {
      font-size: 2rem;
      color: #6c757d;
      margin-bottom: 10px;
    }

    .agri-upload-hint p {
      margin: 5px 0;
      color: #6c757d;
      font-size: 0.9rem;
    }

    .agri-documents-checklist {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .agri-document-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px;
      border: 1px solid #e9ecef;
      border-radius: 6px;
      background-color: #f8f9fa;
    }

    .agri-checkbox-label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-weight: 500;
      min-width: 200px;
    }

    .agri-checkbox-label input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: #27ae60;
    }

    .agri-form-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 25px;
      padding-top: 20px;
      border-top: 1px solid #e9ecef;
    }

    .agri-btn-disabled {
      background-color: #6c757d !important;
      cursor: not-allowed !important;
      opacity: 0.6;
    }

    .agri-btn-disabled:hover {
      transform: none !important;
      background-color: #6c757d !important;
    }

    .agri-btn-success {
      background-color: #27ae60;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }

    .agri-btn-success:hover {
      background-color: #219a52;
      transform: translateY(-2px);
    }

    .agri-btn-warning {
      background-color: #f39c12;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }

    .agri-btn-warning:hover {
      background-color: #e67e22;
      transform: translateY(-2px);
    }

    .agri-btn-info {
      background-color: #3498db;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }

    .agri-btn-info:hover {
      background-color: #2980b9;
      transform: translateY(-2px);
    }

    /* Enhanced Tab Styles */
    .agri-tab-badge {
      background-color: #e9ecef;
      color: #495057;
      font-size: 0.7rem;
      padding: 2px 6px;
      border-radius: 10px;
      margin-left: 5px;
    }

    .agri-tab-badge.agri-badge-warning {
      background-color: #fff3cd;
      color: #856404;
    }

    .agri-tab-badge.agri-badge-danger {
      background-color: #f8d7da;
      color: #721c24;
    }

    .agri-tab-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-weight: 500;
      color: #7f8c8d;
      transition: all 0.3s;
    }

    .agri-tab-btn:hover {
      color: #2c3e50;
      background-color: #f8f9fa;
    }

    .agri-tab-btn.agri-active {
      color: #27ae60;
      border-bottom-color: #27ae60;
      background-color: #f8fff9;
    }

    /* Document Upload Styles */
    .agri-file-upload-area {
      border: 2px dashed #ddd;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
    }

    .agri-file-upload-area:hover {
      border-color: #27ae60;
      background-color: #f8fff8;
    }

    .agri-file-upload-area.dragover {
      border-color: #27ae60;
      background-color: #f0f8f0;
    }

    .agri-upload-hint {
      color: #666;
    }

    .agri-upload-hint i {
      font-size: 2rem;
      color: #27ae60;
      margin-bottom: 10px;
    }

    .agri-upload-hint p {
      margin: 5px 0;
    }

    .agri-file-preview {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background-color: #f8f9fa;
      padding: 10px;
      border-radius: 6px;
      margin-top: 10px;
    }

    .agri-file-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .agri-file-info i {
      color: #27ae60;
      font-size: 1.2rem;
    }

    .agri-remove-file {
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .agri-remove-file:hover {
      background: #c0392b;
    }

    .agri-documents-container {
      padding: 20px;
    }

    .agri-document-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 15px;
    }



    .agri-documents-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 20px;
    }

    .agri-document-card {
      background: white;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 15px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .agri-document-card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }

    .agri-doc-icon {
      font-size: 2rem;
      color: #27ae60;
      min-width: 40px;
    }

    .agri-doc-details {
      flex: 1;
    }

    .agri-doc-details h4 {
      margin: 0 0 5px 0;
      font-size: 1rem;
      color: #333;
    }

    .agri-doc-details p {
      margin: 2px 0;
      font-size: 0.85rem;
      color: #666;
    }

    .agri-doc-actions {
      display: flex;
      gap: 8px;
    }

    .agri-icon-btn {
      background: none;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 6px 8px;
      cursor: pointer;
      color: #666;
      transition: all 0.2s ease;
    }

    .agri-icon-btn:hover {
      background-color: #f8f9fa;
      color: #333;
    }

    .agri-icon-btn[title="Download"]:hover {
      color: #27ae60;
      border-color: #27ae60;
    }

    .agri-icon-btn[title="Delete"]:hover {
      color: #e74c3c;
      border-color: #e74c3c;
    }

    /* Enhanced Stats Cards */
    .agri-stat-trend {
      font-size: 0.75rem;
      margin-top: 5px;
      display: flex;
      align-items: center;
      gap: 3px;
    }

    .agri-stat-trend.positive {
      color: #27ae60;
    }

    .agri-stat-trend.negative {
      color: #e74c3c;
    }

    .agri-stat-trend.neutral {
      color: #f39c12;
    }

    .agri-stat-primary {
      border-left: 4px solid #3498db;
    }

    .agri-stat-success {
      border-left: 4px solid #27ae60;
    }

    .agri-stat-warning {
      border-left: 4px solid #f39c12;
    }

    .agri-stat-info {
      border-left: 4px solid #17a2b8;
    }

    .agri-stat-secondary {
      border-left: 4px solid #6c757d;
    }

    .agri-stat-danger {
      border-left: 4px solid #e74c3c;
    }

    /* Enhanced Search and Filter Styles */
    .agri-search-box-enhanced {
      position: relative;
      flex: 1;
      max-width: 400px;
    }

    .agri-search-box-enhanced input {
      width: 100%;
      padding: 10px 45px 10px 15px;
      border: 1px solid #ddd;
      border-radius: 25px;
      font-size: 0.9rem;
    }

    .agri-search-btn {
      position: absolute;
      right: 5px;
      top: 50%;
      transform: translateY(-50%);
      background: #3498db;
      color: white;
      border: none;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .agri-filter-section {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }

    .agri-filter-row {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .agri-filter-group {
      display: flex;
      flex-direction: column;
      min-width: 150px;
      flex: 1;
    }

    .agri-filter-group label {
      font-size: 0.85rem;
      font-weight: 600;
      color: #495057;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .agri-filter-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .agri-large-modal .agri-modal-content {
        width: 95%;
        margin: 20px auto;
      }

      .agri-form-row {
        flex-direction: column;
        gap: 0;
      }

      .agri-filter-row {
        flex-direction: column;
      }

      .agri-form-actions {
        flex-direction: column;
        gap: 10px;
      }

      .agri-tab-btn {
        padding: 10px 15px;
        font-size: 0.9rem;
      }

      .agri-enhanced-form {
        max-height: 60vh;
      }
    }

    /* Enhanced Scheme Browser Styles */
    .agri-enhanced-filters {
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 25px;
      border: 1px solid #e9ecef;
    }

    .agri-scheme-stats {
      display: flex;
      justify-content: space-around;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 25px;
    }

    .agri-stat-item {
      text-align: center;
    }

    .agri-stat-number {
      display: block;
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .agri-stat-label {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .agri-schemes-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .agri-scheme-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
      border: 1px solid #e9ecef;
      overflow: hidden;
    }

    .agri-scheme-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .agri-scheme-header {
      padding: 20px 20px 15px 20px;
      border-bottom: 1px solid #f1f3f4;
    }

    .agri-scheme-title {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }

    .agri-scheme-title h3 {
      margin: 0;
      font-size: 1.1rem;
      color: #2c3e50;
      line-height: 1.4;
      flex: 1;
      margin-right: 15px;
    }

    .agri-scheme-amount {
      font-size: 1.2rem;
      font-weight: bold;
      color: #27ae60;
      white-space: nowrap;
    }

    .agri-scheme-badges {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .agri-scheme-badge {
      padding: 4px 10px;
      border-radius: 15px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .agri-scheme-badge.agri-central {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .agri-scheme-badge.agri-state {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }

    .agri-scheme-badge.agri-district {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
    }

    .agri-scheme-badge.agri-active {
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      color: #2c3e50;
    }

    .agri-scheme-body {
      padding: 0 20px 15px 20px;
    }

    .agri-scheme-body p {
      margin: 0 0 15px 0;
      color: #5a6c7d;
      line-height: 1.6;
      font-size: 0.95rem;
    }

    .agri-scheme-highlights {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .agri-highlight-item {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 0.9rem;
      color: #495057;
    }

    .agri-highlight-item i {
      color: #3498db;
      width: 16px;
      text-align: center;
    }

    .agri-scheme-footer {
      padding: 15px 20px 20px 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .agri-scheme-footer button {
      flex: 1;
      min-width: 100px;
      padding: 8px 12px;
      font-size: 0.85rem;
      border-radius: 6px;
      transition: all 0.3s ease;
    }

    .agri-btn-outline {
      background: none;
      border: 1px solid #3498db;
      color: #3498db;
      cursor: pointer;
    }

    .agri-btn-outline:hover {
      background: #3498db;
      color: white;
      transform: translateY(-2px);
    }

    .agri-pagination {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      border-top: 1px solid #e9ecef;
    }

    .agri-page-info {
      font-size: 0.9rem;
      color: #6c757d;
    }

    /* Filter Enhancements */
    .agri-filter-row {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .agri-filter-row:last-child {
      margin-bottom: 0;
    }

    .agri-filter-group {
      display: flex;
      flex-direction: column;
      min-width: 180px;
      flex: 1;
    }

    .agri-filter-group label {
      font-size: 0.85rem;
      font-weight: 600;
      color: #495057;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .agri-filter-group label i {
      color: #3498db;
    }

    /* Responsive Design for Scheme Browser */
    @media (max-width: 768px) {
      .agri-schemes-container {
        grid-template-columns: 1fr;
      }

      .agri-scheme-stats {
        flex-direction: column;
        gap: 15px;
      }

      .agri-stat-item {
        padding: 10px;
        background: rgba(255,255,255,0.1);
        border-radius: 8px;
      }

      .agri-filter-row {
        flex-direction: column;
      }

      .agri-scheme-footer {
        flex-direction: column;
      }

      .agri-scheme-footer button {
        width: 100%;
      }

      .agri-pagination {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
    }

    /* Scheme Details Modal Styles */
    .agri-scheme-detail-content {
      max-height: 70vh;
      overflow-y: auto;
      padding-right: 10px;
    }

    .agri-detail-section {
      margin-bottom: 25px;
      padding: 20px;
      background-color: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #3498db;
    }

    .agri-detail-section h3 {
      margin: 0 0 15px 0;
      color: #2c3e50;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .agri-detail-section h3 i {
      color: #3498db;
    }

    .agri-detail-section ul,
    .agri-detail-section ol {
      margin: 0;
      padding-left: 20px;
    }

    .agri-detail-section li {
      margin-bottom: 8px;
      line-height: 1.5;
    }

    .agri-detail-actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #e9ecef;
    }

    /* Eligibility Checker Styles */
    .agri-eligibility-form {
      padding: 20px 0;
    }

    .agri-eligibility-result {
      margin-top: 25px;
      padding: 20px;
      border-radius: 10px;
      background-color: #f8f9fa;
    }

    .agri-success-status {
      text-align: center;
      color: #27ae60;
      margin-bottom: 20px;
    }

    .agri-success-status i {
      font-size: 3rem;
      margin-bottom: 10px;
    }

    .agri-success-status h3 {
      margin: 0;
      font-size: 1.5rem;
    }

    .agri-error-status {
      text-align: center;
      color: #e74c3c;
      margin-bottom: 20px;
    }

    .agri-error-status i {
      font-size: 3rem;
      margin-bottom: 10px;
    }

    .agri-error-status h3 {
      margin: 0;
      font-size: 1.5rem;
    }

    .agri-result-details ul {
      margin: 15px 0;
      padding-left: 20px;
    }

    .agri-result-details li {
      margin-bottom: 8px;
    }

    .agri-result-actions {
      text-align: center;
      margin-top: 20px;
    }

    /* Enhanced Button Styles */
    .agri-btn-success {
      background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .agri-btn-success:hover {
      background: linear-gradient(135deg, #219a52 0%, #27ae60 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
    }

    .agri-btn-info {
      background: linear-gradient(135deg, #3498db 0%, #5dade2 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .agri-btn-info:hover {
      background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
    }

    .agri-btn-warning {
      background: linear-gradient(135deg, #f39c12 0%, #f1c40f 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .agri-btn-warning:hover {
      background: linear-gradient(135deg, #e67e22 0%, #f39c12 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
    }

    /* Responsive Design for Modals */
    @media (max-width: 768px) {
      .agri-detail-actions {
        flex-direction: column;
      }

      .agri-detail-actions button {
        width: 100%;
        margin-bottom: 10px;
      }

      .agri-scheme-detail-content {
        max-height: 60vh;
      }

      .agri-detail-section {
        padding: 15px;
      }
    }

    /* Loading and Animation Styles */
    .agri-loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .agri-fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Scheme Browser Styles */
    .agri-scheme-filters {
      display: flex;
      gap: 15px;
      padding: 0 25px 15px;
      border-bottom: 1px solid #eee;
    }

    .agri-filter-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .agri-filter-group label {
      font-size: 0.9rem;
      color: #7f8c8d;
    }

    .agri-filter-select {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 0.9rem;
    }

    .agri-schemes-list {
      padding: 15px 25px;
      display: grid;
      gap: 15px;
    }

    .agri-scheme-item {
      border: 1px solid #eee;
      border-radius: 8px;
      overflow: hidden;
    }

    .agri-scheme-header {
      padding: 15px;
      background: #f8f9fa;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .agri-scheme-header h3 {
      margin: 0;
      font-size: 1.1rem;
      color: #2c3e50;
    }

    .agri-scheme-badge {
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 0.7rem;
      font-weight: bold;
    }

    .agri-central {
      background: #e3f2fd;
      color: #1976d2;
    }

    .agri-state {
      background: #e8f5e9;
      color: #388e3c;
    }

    .agri-scheme-body {
      padding: 15px;
    }

    .agri-scheme-body p {
      margin: 0 0 10px 0;
      color: #34495e;
    }

    .agri-scheme-details {
      display: flex;
      gap: 15px;
      margin-top: 10px;
      font-size: 0.85rem;
    }

    .agri-scheme-details span {
      display: flex;
      align-items: center;
      gap: 5px;
      color: #7f8c8d;
    }

    .agri-scheme-footer {
      padding: 12px 15px;
      background: #f8f9fa;
      border-top: 1px solid #eee;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .agri-btn-outline {
      background: none;
      border: 1px solid #3498db;
      color: #3498db;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.3s;
    }

    .agri-btn-outline:hover {
      background: #e3f2fd;
    }

    @media (max-width: 768px) {
      .agri-section-header {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .agri-header-actions {
        width: 100%;
        flex-direction: column;
      }
      
      .agri-support-cards {
        grid-template-columns: 1fr;
      }
      
      .agri-modal-content {
        width: 90%;
      }
      
      .agri-wide-modal {
        width: 90%;
      }
      
      .agri-form-row {
        flex-direction: column;
        gap: 0;
      }
      
      .agri-scheme-filters {
        flex-direction: column;
      }
    }
    </style>

    <script>
    function openAgriModal(id) {
      document.getElementById(id).style.display = "flex";
      document.body.style.overflow = "hidden";
    }

    function closeAgriModal(id) {
      document.getElementById(id).style.display = "none";
      document.body.style.overflow = "auto";
    }

    function switchAgriTab(tabName, event) {
      // Hide all tab contents
      document.querySelectorAll('.agri-tab-content').forEach(tab => {
        tab.classList.remove('agri-active');
      });
      
      // Deactivate all tab buttons
      document.querySelectorAll('.agri-tab-btn').forEach(btn => {
        btn.classList.remove('agri-active');
      });
      
      // Activate selected tab
      const targetTab = document.getElementById('agri-' + tabName + '-tab');
      if (targetTab) {
        targetTab.classList.add('agri-active');
      }
      
      // Activate the clicked button
      if (event && event.currentTarget) {
        event.currentTarget.classList.add('agri-active');
      } else {
        // Fallback: find and activate the correct button
        const buttons = document.querySelectorAll('.agri-tab-btn');
        buttons.forEach(btn => {
          if (btn.onclick && btn.onclick.toString().includes(tabName)) {
            btn.classList.add('agri-active');
          }
        });
      }
      
      // Show all cards in the newly active tab
      showAllCardsInActiveTab();
    }

    function switchAgriFormTab(formId) {
      // Hide all form contents
      document.querySelectorAll('.agri-form-content').forEach(form => {
        form.classList.remove('agri-active');
      });
      
      // Deactivate all form tabs
      document.querySelectorAll('.agri-form-tab').forEach(tab => {
        tab.classList.remove('agri-active');
      });
      
      // Activate selected form
      document.getElementById(formId).classList.add('agri-active');
      event.currentTarget.classList.add('agri-active');
    }

    // File upload name display
    document.querySelectorAll('input[type="file"]').forEach(input => {
      input.addEventListener('change', function() {
        const fileName = this.files.length > 1 ? 
          `${this.files.length} files selected` : 
          this.files[0]?.name || 'No file chosen';
        
        const displayElement = this.closest('.agri-file-upload').querySelector('.agri-file-name');
        displayElement.textContent = fileName;
      });
    });

    // Initialize with first tab active
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelector('.agri-tab-btn.agri-active').click();
      document.querySelector('.agri-form-tab.agri-active').click();
    });
    </script>
    <!---end of insurance-->

        <!-- Add Farmer Modal -->
        <div class="modal" id="addFarmerModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add New Farmer</h3>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="farmerForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="farmerId">Farmer ID</label>
                                <input type="text" id="farmerId" placeholder="Auto-generated" disabled>
                            </div>
                            <div class="form-group">
                                <label for="registrationDate">Registration Date</label>
                                <input type="date" id="registrationDate" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="firstName">First Name</label>
                                <input type="text" id="firstName" placeholder="Letters only" required>
                            </div>
                            <div class="form-group">
                                <label for="lastName">Last Name</label>
                                <input type="text" id="lastName" placeholder="Letters only" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="idNumber">ID Number</label>
                                <input type="text" id="idNumber" placeholder="5-12 digits" required>
                            </div>
                            <div class="form-group">
                                <label for="phone">Phone Number (with country code)</label>
                                <input type="tel" id="phone" placeholder="+91XXXXXXXXXX" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="address">Address</label>
                            <input type="text" id="address" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="location">Location</label>
                                <input type="text" id="location" required>
                            </div>
                            <div class="form-group">
                                <label for="nearestCenter">Nearest Collection Center</label>
                                <input type="text" id="nearestCenter" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cattleCount">Number of Cattle</label>
                                <input type="number" id="cattleCount" min="1" required>
                            </div>
                            <div class="form-group">
                                <label for="status">Status</label>
                                <select id="status" required>
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="notes">Notes (letters only)</label>
                            <textarea id="notes" rows="3" placeholder="Enter notes using letters only"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline close-modal">Cancel</button>
                    <button class="btn btn-primary" id="saveFarmer">Save Farmer</button>
                </div>
            </div>
        </div>
        
        <!-- Edit Farmer Modal -->
        <div class="modal" id="editFarmerModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Edit Farmer</h3>
                    <button class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="editFarmerForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="editFarmerId">Farmer ID</label>
                                <input type="text" id="editFarmerId" placeholder="Auto-generated" disabled>
                            </div>
                            <div class="form-group">
                                <label for="editRegistrationDate">Registration Date</label>
                                <input type="date" id="editRegistrationDate" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="editFirstName">First Name</label>
                                <input type="text" id="editFirstName" placeholder="Letters only" required>
                            </div>
                            <div class="form-group">
                                <label for="editLastName">Last Name</label>
                                <input type="text" id="editLastName" placeholder="Letters only" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="editIdNumber">ID Number</label>
                                <input type="text" id="editIdNumber" placeholder="5-12 digits" required>
                            </div>
                            <div class="form-group">
                                <label for="editPhone">Phone Number (with country code)</label>
                                <input type="tel" id="editPhone" placeholder="+91XXXXXXXXXX" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="editAddress">Address</label>
                            <input type="text" id="editAddress" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="editLocation">Location</label>
                                <input type="text" id="editLocation" required>
                            </div>
                            <div class="form-group">
                                <label for="editNearestCenter">Nearest Collection Center</label>
                                <input type="text" id="editNearestCenter" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="editCattleCount">Number of Cattle</label>
                                <input type="number" id="editCattleCount" min="1" required>
                            </div>
                            <div class="form-group">
                                <label for="editStatus">Status</label>
                                <select id="editStatus" required>
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="editNotes">Notes (letters only)</label>
                            <textarea id="editNotes" rows="3" placeholder="Enter notes using letters only"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline close-modal">Cancel</button>
                    <button class="btn btn-primary" id="updateFarmer">Update Farmer</button>
                </div>
            </div>
        </div>
       
        <!-- milk Market Analysis js -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Initialize all charts
                initMarketAnalysisCharts();
                
                // Period selector functionality
                document.getElementById('analysisPeriod').addEventListener('change', function() {
                    updateChartsForPeriod(this.value);
                });
                
                // Sample data for demonstration
                const marketData = {
                    priceTrends: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                    data: [38.20, 39.50, 40.80, 41.20, 42.50, 43.00, 42.50],
                    color: '#3498db'
                    },
                    supplyDemand: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                    supply: [1200, 1350, 1500, 1450, 1600, 1650, 1700],
                    demand: [1100, 1250, 1400, 1500, 1550, 1600, 1750],
                    colors: ['#2ecc71', '#e74c3c']
                    },
                    regionalPrices: {
                    labels: ['Bangalore', 'Mumbai', 'Delhi', 'Hyderabad', 'Chennai'],
                    data: [45.20, 43.80, 42.50, 41.30, 39.80],
                    colors: ['#9b59b6', '#3498db', '#2ecc71', '#f1c40f', '#e74c3c']
                    },
                    seasonalTrends: {
                    labels: ['Winter', 'Spring', 'Summer', 'Monsoon', 'Autumn'],
                    data: [40.20, 41.50, 42.80, 39.20, 40.50],
                    color: '#f39c12'
                    },
                    priceForecast: {
                    labels: Array.from({length: 30}, (_, i) => `Day ${i+1}`),
                    data: Array.from({length: 30}, (_, i) => 42 + Math.sin(i/5) * 2 + (Math.random() - 0.5)),
                    color: '#3498db'
                    }
                };
                
                // Chart instances
                let priceTrendChart, supplyDemandChart, regionalPriceChart, seasonalTrendChart, priceForecastChart;
                
                function initMarketAnalysisCharts() {
                    // Price Trends Chart
                    const priceTrendCtx = document.getElementById('priceTrendChart').getContext('2d');
                    priceTrendChart = new Chart(priceTrendCtx, {
                    type: 'line',
                    data: {
                        labels: marketData.priceTrends.labels,
                        datasets: [{
                        label: 'Average Price per Liter (₹)',
                        data: marketData.priceTrends.data,
                        borderColor: marketData.priceTrends.color,
                        backgroundColor: hexToRgba(marketData.priceTrends.color, 0.1),
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                        }]
                    },
                    options: getChartOptions('Price Trends (₹/L)')
                    });
                    
                    // Supply-Demand Chart
                    const supplyDemandCtx = document.getElementById('supplyDemandChart').getContext('2d');
                    supplyDemandChart = new Chart(supplyDemandCtx, {
                    type: 'bar',
                    data: {
                        labels: marketData.supplyDemand.labels,
                        datasets: [
                        {
                            label: 'Supply (L)',
                            data: marketData.supplyDemand.supply,
                            backgroundColor: hexToRgba(marketData.supplyDemand.colors[0], 0.7),
                            borderColor: marketData.supplyDemand.colors[0],
                            borderWidth: 1
                        },
                        {
                            label: 'Demand (L)',
                            data: marketData.supplyDemand.demand,
                            backgroundColor: hexToRgba(marketData.supplyDemand.colors[1], 0.7),
                            borderColor: marketData.supplyDemand.colors[1],
                            borderWidth: 1
                        }
                        ]
                    },
                    options: getChartOptions('Supply vs Demand (Liters)')
                    });
                    
                    // Regional Price Chart
                    const regionalPriceCtx = document.getElementById('regionalPriceChart').getContext('2d');
                    regionalPriceChart = new Chart(regionalPriceCtx, {
                    type: 'bar',
                    data: {
                        labels: marketData.regionalPrices.labels,
                        datasets: [{
                        label: 'Price per Liter (₹)',
                        data: marketData.regionalPrices.data,
                        backgroundColor: marketData.regionalPrices.colors,
                        borderColor: '#fff',
                        borderWidth: 1
                        }]
                    },
                    options: getChartOptions('Regional Prices (₹/L)')
                    });
                    
                    // Seasonal Trend Chart
                    const seasonalTrendCtx = document.getElementById('seasonalTrendChart').getContext('2d');
                    seasonalTrendChart = new Chart(seasonalTrendCtx, {
                    type: 'line',
                    data: {
                        labels: marketData.seasonalTrends.labels,
                        datasets: [{
                        label: 'Average Price (₹)',
                        data: marketData.seasonalTrends.data,
                        borderColor: marketData.seasonalTrends.color,
                        backgroundColor: hexToRgba(marketData.seasonalTrends.color, 0.1),
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                        }]
                    },
                    options: getChartOptions('Seasonal Price Trends (₹/L)')
                    });
                    
                    // Price Forecast Chart
                    const priceForecastCtx = document.getElementById('priceForecastChart').getContext('2d');
                    priceForecastChart = new Chart(priceForecastCtx, {
                    type: 'line',
                    data: {
                        labels: marketData.priceForecast.labels,
                        datasets: [{
                        label: 'Forecasted Price (₹)',
                        data: marketData.priceForecast.data,
                        borderColor: marketData.priceForecast.color,
                        backgroundColor: hexToRgba(marketData.priceForecast.color, 0.1),
                        borderWidth: 2,
                        tension: 0.1,
                        fill: true
                        }]
                    },
                    options: getChartOptions('30-Day Price Forecast (₹/L)')
                    });
                }
                
                function updateChartsForPeriod(days) {
                    // In a real app, this would fetch new data from the server
                    console.log(`Updating charts for last ${days} days`);
                    
                    // For demo purposes, we'll just simulate some changes
                    const now = new Date();
                    const periodLabels = [];
                    const periodData = [];
                    
                    for (let i = days-1; i >= 0; i--) {
                    const date = new Date(now);
                    date.setDate(date.getDate() - i);
                    periodLabels.push(date.toLocaleDateString('en-IN', { month: 'short', day: 'numeric' }));
                    periodData.push(40 + Math.random() * 5);
                    }
                    
                    // Update price trend chart
                    priceTrendChart.data.labels = periodLabels;
                    priceTrendChart.data.datasets[0].data = periodData;
                    priceTrendChart.update();
                    
                    // Show loading state
                    document.querySelectorAll('.chart-container').forEach(container => {
                    container.innerHTML = '<div class="chart-loading"><i class="fas fa-spinner fa-spin"></i></div>';
                    });
                    
                    // Initialize charts immediately
                    initMarketAnalysisCharts();
                }
                
                function getChartOptions(title) {
                    return {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                        position: 'top',
                        },
                        title: {
                        display: true,
                        text: title,
                        font: {
                            size: 14
                        }
                        },
                        tooltip: {
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                            return `${context.dataset.label}: ₹${context.parsed.y.toFixed(2)}`;
                            }
                        }
                        }
                    },
                    scales: {
                        y: {
                        beginAtZero: false,
                        ticks: {
                            callback: function(value) {
                            return '₹' + value;
                            }
                        }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                    };
                }
                
                function hexToRgba(hex, alpha) {
                    const r = parseInt(hex.slice(1, 3), 16);
                    const g = parseInt(hex.slice(3, 5), 16);
                    const b = parseInt(hex.slice(5, 7), 16);
                    return `rgba(${r}, ${g}, ${b}, ${alpha})`;
                }
                });
        </script>
        

        <script>
            // Form validation functions
            function validateLettersOnly(text) {
                // Only allow letters and spaces
                const lettersRegex = /^[A-Za-z\s]+$/;
                return lettersRegex.test(text) || text === '';
            }
            
            function validatePhone(phone) {
                // Must start with country code (+XX) and have exactly 10 digits after
                const phoneRegex = /^\+\d{2,3}\d{10}$/;
                return phoneRegex.test(phone);
            }
            
            function validateIdNumber(id) {
                // ID should be numeric and between 5-12 digits
                const idRegex = /^\d{5,12}$/;
                return idRegex.test(id);
            }
            
            function validateNumber(num) {
                // Must be a positive number
                return !isNaN(num) && parseInt(num) > 0;
            }
            
            function validateRequired(value) {
                return value.trim() !== '';
            }
            
            function showError(inputElement, message) {
                // Remove any existing error message
                const parent = inputElement.parentElement;
                const existingError = parent.querySelector('.error');
                if (existingError) {
                    parent.removeChild(existingError);
                }
                
                // Add new error message
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error';
                errorDiv.textContent = message;
                parent.appendChild(errorDiv);
                
                // Highlight the input field
                inputElement.style.borderColor = 'red';
            }
            
            function clearError(inputElement) {
                // Remove error message if exists
                const parent = inputElement.parentElement;
                const existingError = parent.querySelector('.error');
                if (existingError) {
                    parent.removeChild(existingError);
                }
                
                // Reset input style
                inputElement.style.borderColor = '#ddd';
            }
            
            // Function to reset form errors and styles
            function resetFormErrors() {
                // Clear all errors
                const errorElements = document.querySelectorAll('.error');
                errorElements.forEach(el => el.remove());
                
                // Reset input styles
                const inputs = document.querySelectorAll('input, select, textarea');
                inputs.forEach(input => {
                    input.style.borderColor = '#ddd';
                });
            }
            
            // Validation rules configuration for easier maintenance
            const validationRules = {
                'firstName': {
                    required: true,
                    validator: validateLettersOnly,
                    errorMsg: 'First name should contain only letters and spaces'
                },
                'lastName': {
                    required: true,
                    validator: validateLettersOnly,
                    errorMsg: 'Last name should contain only letters and spaces'
                },
                'idNumber': {
                    required: true,
                    validator: validateIdNumber,
                    errorMsg: 'ID number should be 5-12 digits'
                },
                'phone': {
                    required: true,
                    validator: validatePhone,
                    errorMsg: 'Phone number must start with country code (+XX) followed by 10 digits'
                },
                'address': {
                    required: true
                },
                'location': {
                    required: true
                },
                'nearestCenter': {
                    required: true
                },
                'cattleCount': {
                    required: true,
                    validator: validateNumber,
                    errorMsg: 'Number of cattle must be a positive number'
                },
                'registrationDate': {
                    required: true
                },
                'notes': {
                    required: false,
                    validator: validateLettersOnly,
                    errorMsg: 'Notes should contain only letters and spaces'
                }
            };
            
            function validateForm() {
                let isValid = true;
                
                // Validate each field according to its rules
                for (const [fieldId, rules] of Object.entries(validationRules)) {
                    const field = document.getElementById(fieldId);
                    
                    // Skip if field doesn't exist
                    if (!field) continue;
                    
                    // Check required fields
                    if (rules.required && !validateRequired(field.value)) {
                        showError(field, `${field.labels[0].textContent.replace('*', '').trim()} is required`);
                        isValid = false;
                    } 
                    // Check custom validation if field has value
                    else if (rules.validator && field.value.trim() !== '' && !rules.validator(field.value)) {
                        showError(field, rules.errorMsg);
                        isValid = false;
                    } else {
                        clearError(field);
                    }
                }
                
                return isValid;
            }
            
            // Set up real-time validation for all fields
            for (const [fieldId, rules] of Object.entries(validationRules)) {
                const field = document.getElementById(fieldId);
                if (field && rules.validator) {
                    field.addEventListener('input', function() {
                        if (!rules.validator(this.value) && this.value.trim() !== '') {
                            showError(this, rules.errorMsg);
                        } else {
                            clearError(this);
                        }
                    });
                }
            }
            
            // Modal functionality
            const addFarmerBtn = document.getElementById('addFarmerBtn');
            const addFarmerModal = document.getElementById('addFarmerModal');
            const editFarmerModal = document.getElementById('editFarmerModal');
            const closeBtns = document.querySelectorAll('.close-btn, .close-modal');
            
            addFarmerBtn.addEventListener('click', () => {
                addFarmerModal.style.display = 'flex';
                // Set today's date as default
                document.getElementById('registrationDate').valueAsDate = new Date();
                // Generate a new farmer ID
                document.getElementById('farmerId').value = generateFarmerId();
            });
            
            // Function to close modal and reset form
            function closeModal() {
                addFarmerModal.style.display = 'none';
                editFarmerModal.style.display = 'none';
                resetFormErrors();
            }
            
            // Close button event listeners
            closeBtns.forEach(btn => {
                btn.addEventListener('click', closeModal);
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === addFarmerModal || e.target === editFarmerModal) {
                    closeModal();
                }
            });
            
            // Function to create a table cell
            function createCell(content) {
                const cell = document.createElement('td');
                cell.textContent = content;
                return cell;
            }
            
            // Function to create an action button
            function createActionButton(icon, title, clickHandler) {
                const button = document.createElement('button');
                button.className = 'action-btn';
                button.title = title;
                button.innerHTML = `<i class="fas fa-${icon}"></i>`;
                button.addEventListener('click', clickHandler);
                return button;
            }
            
            // Function to add farmer to the table
            function addFarmerToTable(farmerData) {
                const tableBody = document.querySelector('table tbody');
                const newRow = document.createElement('tr');
                
                // Store additional data as data attributes for view functionality
                newRow.dataset.registrationDate = farmerData.registrationDate || '';
                newRow.dataset.notes = farmerData.notes || '';
                newRow.dataset.address = farmerData.address || '';
                newRow.dataset.nearestCenter = farmerData.nearestCenter || '';
                newRow.dataset.idNumber = farmerData.idNumber || '';
                
                // Add basic cells
                newRow.appendChild(createCell(farmerData.id));
                newRow.appendChild(createCell(farmerData.firstName + ' ' + farmerData.lastName));
                newRow.appendChild(createCell(farmerData.phone));
                newRow.appendChild(createCell(farmerData.location));
                newRow.appendChild(createCell(farmerData.cattleCount));
                
                // Calculate milk yield
                const avgMilkYield = (Math.random() * 2 + 3).toFixed(1);
                const totalMilk = (avgMilkYield * farmerData.cattleCount).toFixed(1);
                newRow.appendChild(createCell(totalMilk));
                
                // Status cell with span
                const statusCell = document.createElement('td');
                const statusSpan = document.createElement('span');
                statusSpan.className = 'status ' + farmerData.status;
                statusSpan.textContent = farmerData.status.charAt(0).toUpperCase() + farmerData.status.slice(1);
                statusCell.appendChild(statusSpan);
                newRow.appendChild(statusCell);
                
                // Actions cell
                const actionsCell = document.createElement('td');
                const actionBtnsDiv = document.createElement('div');
                actionBtnsDiv.className = 'action-btns';
                
                // Add action buttons
                const fullName = `${farmerData.firstName} ${farmerData.lastName}`;
                
                // Create view button that uses the global view function
                const viewBtn = createActionButton('eye', 'View', () => {
                    viewFarmerDetails(viewBtn);
                });
                actionBtnsDiv.appendChild(viewBtn);
                
                // Create edit button that uses the global edit function
                const editBtn = createActionButton('edit', 'Edit', () => {
                    editFarmerDetails(editBtn);
                });
                actionBtnsDiv.appendChild(editBtn);
                
                // Create delete button that uses the global delete function
                const deleteBtn = createActionButton('trash', 'Delete', () => {
                    deleteFarmer(deleteBtn);
                });
                actionBtnsDiv.appendChild(deleteBtn);
                
                actionsCell.appendChild(actionBtnsDiv);
                newRow.appendChild(actionsCell);
                
                // Add the new row to the table
                tableBody.appendChild(newRow);
                
                // Update all dashboard statistics
                updateFarmerCount(true); // Increment farmer count
                updateCattleCount(farmerData.cattleCount, true); // Increment cattle count
                updateMilkVolume(totalMilk, true); // Increment milk volume
            }
            
            // Function to update the farmer count in the dashboard card
            function updateFarmerCount(increment = true) {
                const farmerCountElement = document.querySelector('.dashboard-cards .card:first-child .card-value');
                if (farmerCountElement) {
                    const currentCount = parseInt(farmerCountElement.textContent);
                    // If increment is true, add 1; otherwise subtract 1
                    farmerCountElement.textContent = increment ? currentCount + 1 : currentCount - 1;
                }
            }
            
            // Function to update cattle count in the dashboard card
            function updateCattleCount(cattleChange, increment = true) {
                const cattleCountElement = document.querySelector('.dashboard-cards .card:nth-child(2) .card-value');
                if (cattleCountElement) {
                    const currentCount = parseInt(cattleCountElement.textContent);
                    // If increment is true, add cattle; otherwise subtract cattle
                    cattleCountElement.textContent = increment ? currentCount + parseInt(cattleChange) : currentCount - parseInt(cattleChange);
                }
            }
            
            // Function to update milk volume in the dashboard card
            function updateMilkVolume(milkChange, increment = true) {
                const milkVolumeElement = document.querySelector('.dashboard-cards .card:nth-child(3) .card-value');
                if (milkVolumeElement) {
                    const currentVolume = parseFloat(milkVolumeElement.textContent.replace('L', '').replace(',', ''));
                    // If increment is true, add milk; otherwise subtract milk
                    const newVolume = increment ? currentVolume + parseFloat(milkChange) : currentVolume - parseFloat(milkChange);
                    milkVolumeElement.textContent = newVolume.toLocaleString() + 'L';
                }
            }
            
            // Form submission
            document.getElementById('saveFarmer').addEventListener('click', () => {
                // Validate form before submission
                if (validateForm()) {
                    // Collect form data
                    const formData = {};
                    
                    // Get values from all fields that match the table columns
                    ['farmerId', 'firstName', 'lastName', 'phone', 'location', 'cattleCount', 'status'].forEach(field => {
                        formData[field.replace('farmerId', 'id')] = document.getElementById(field).value;
                    });
                    
                    // Add additional data for view functionality
                    formData.registrationDate = document.getElementById('registrationDate').value;
                    formData.notes = document.getElementById('notes').value;
                    formData.address = document.getElementById('address').value;
                    formData.nearestCenter = document.getElementById('nearestCenter').value;
                    formData.idNumber = document.getElementById('idNumber').value;
                    
                    // Add farmer to table
                    addFarmerToTable(formData);
                    
                    // Show success message
                    alert('Farmer saved successfully!');
                    
                    // Close modal and reset form
                    closeModal();
                    document.getElementById('farmerForm').reset();
                    
                    // Generate new ID for next farmer
                    document.getElementById('farmerId').value = generateFarmerId();
                }
            });
            
            // Generate a farmer ID when the page loads
            function generateFarmerId() {
                // Generate a random number between 1-9999
                const randomNum = Math.floor(1 + Math.random() * 9999);
                // Format as DF followed by exactly 4 digits with leading zeros
                return 'DF' + randomNum.toString().padStart(4, '0');
            }
            
            // Function to edit farmer details
            function editFarmerDetails(button) {
                // Get the row
                const row = button.closest('tr');
                
                // Get data from the row and data attributes
                const farmerId = row.cells[0].textContent;
                const farmerName = row.cells[1].textContent.split(' ');
                const contact = row.cells[2].textContent;
                const location = row.cells[3].textContent;
                const cattleCount = row.cells[4].textContent;
                const status = row.cells[6].querySelector('.status').textContent.toLowerCase();
                
                // Get additional data from data attributes
                const registrationDate = row.dataset.registrationDate || '';
                const notes = row.dataset.notes || '';
                const address = row.dataset.address || '';
                const idNumber = row.dataset.idNumber || '';
                const nearestCenter = row.dataset.nearestCenter || '';
                
                // Populate the edit form
                document.getElementById('editFarmerId').value = farmerId;
                document.getElementById('editFirstName').value = farmerName[0] || '';
                document.getElementById('editLastName').value = farmerName.slice(1).join(' ') || '';
                document.getElementById('editPhone').value = contact;
                document.getElementById('editLocation').value = location;
                document.getElementById('editCattleCount').value = cattleCount;
                document.getElementById('editStatus').value = status;
                document.getElementById('editRegistrationDate').value = registrationDate;
                document.getElementById('editNotes').value = notes;
                document.getElementById('editAddress').value = address;
                document.getElementById('editIdNumber').value = idNumber;
                document.getElementById('editNearestCenter').value = nearestCenter;
                
                // Store the row reference for updating later
                editFarmerModal.dataset.editingRow = Array.from(row.parentNode.children).indexOf(row);
                
                // Show the edit modal
                editFarmerModal.style.display = 'flex';
            }
            
            // Update farmer functionality
            document.getElementById('updateFarmer').addEventListener('click', () => {
                // Validate form before submission
                if (validateEditForm()) {
                    // Get the row being edited
                    const rowIndex = parseInt(editFarmerModal.dataset.editingRow);
                    const tableBody = document.querySelector('table tbody');
                    const row = tableBody.children[rowIndex];
                    
                    // Get form data
                    const formData = {
                        id: document.getElementById('editFarmerId').value,
                        firstName: document.getElementById('editFirstName').value,
                        lastName: document.getElementById('editLastName').value,
                        phone: document.getElementById('editPhone').value,
                        location: document.getElementById('editLocation').value,
                        cattleCount: document.getElementById('editCattleCount').value,
                        status: document.getElementById('editStatus').value,
                        registrationDate: document.getElementById('editRegistrationDate').value,
                        notes: document.getElementById('editNotes').value,
                        address: document.getElementById('editAddress').value,
                        idNumber: document.getElementById('editIdNumber').value,
                        nearestCenter: document.getElementById('editNearestCenter').value
                    };
                    
                    // Update the row data
                    row.cells[0].textContent = formData.id;
                    row.cells[1].textContent = formData.firstName + ' ' + formData.lastName;
                    row.cells[2].textContent = formData.phone;
                    row.cells[3].textContent = formData.location;
                    row.cells[4].textContent = formData.cattleCount;
                    
                    // Recalculate milk yield
                    const avgMilkYield = (Math.random() * 2 + 3).toFixed(1);
                    const totalMilk = (avgMilkYield * formData.cattleCount).toFixed(1);
                    row.cells[5].textContent = totalMilk;
                    
                    // Update status
                    const statusSpan = row.cells[6].querySelector('.status');
                    statusSpan.className = 'status ' + formData.status;
                    statusSpan.textContent = formData.status.charAt(0).toUpperCase() + formData.status.slice(1);
                    
                    // Update data attributes
                    row.dataset.registrationDate = formData.registrationDate;
                    row.dataset.notes = formData.notes;
                    row.dataset.address = formData.address;
                    row.dataset.idNumber = formData.idNumber;
                    row.dataset.nearestCenter = formData.nearestCenter;
                    
                    // Show success message
                    alert('Farmer updated successfully!');
                    
                    // Close modal
                    closeModal();
                }
            });
            
            // Validation function for edit form
            function validateEditForm() {
                let isValid = true;
                
                // Define edit form validation rules (same as add form but with 'edit' prefix)
                const editValidationRules = {
                    'editFirstName': {
                        required: true,
                        validator: validateLettersOnly,
                        errorMsg: 'First name should contain only letters and spaces'
                    },
                    'editLastName': {
                        required: true,
                        validator: validateLettersOnly,
                        errorMsg: 'Last name should contain only letters and spaces'
                    },
                    'editIdNumber': {
                        required: true,
                        validator: validateIdNumber,
                        errorMsg: 'ID number should be 5-12 digits'
                    },
                    'editPhone': {
                        required: true,
                        validator: validatePhone,
                        errorMsg: 'Phone number must start with country code (+XX) followed by 10 digits'
                    },
                    'editAddress': {
                        required: true
                    },
                    'editLocation': {
                        required: true
                    },
                    'editNearestCenter': {
                        required: true
                    },
                    'editCattleCount': {
                        required: true,
                        validator: validateNumber,
                        errorMsg: 'Number of cattle must be a positive number'
                    },
                    'editRegistrationDate': {
                        required: true
                    },
                    'editNotes': {
                        required: false,
                        validator: validateLettersOnly,
                        errorMsg: 'Notes should contain only letters and spaces'
                    }
                };
                
                // Validate each field according to its rules
                for (const [fieldId, rules] of Object.entries(editValidationRules)) {
                    const field = document.getElementById(fieldId);
                    
                    // Skip if field doesn't exist
                    if (!field) continue;
                    
                    // Check required fields
                    if (rules.required && !validateRequired(field.value)) {
                        showError(field, `${field.labels[0].textContent.replace('*', '').trim()} is required`);
                        isValid = false;
                    } 
                    // Check custom validation if field has value
                    else if (rules.validator && field.value.trim() !== '' && !rules.validator(field.value)) {
                        showError(field, rules.errorMsg);
                        isValid = false;
                    } else {
                        clearError(field);
                    }
                }
                
                return isValid;
            }
            
            // Function to view farmer details directly in the table
            function viewFarmerDetails(button) {
                // Get the row
                const row = button.closest('tr');
                
                // Check if details row already exists
                const nextRow = row.nextElementSibling;
                if (nextRow && nextRow.classList.contains('details-row')) {
                    // If details row exists, toggle its visibility
                    nextRow.classList.toggle('hidden');
                    return;
                }
                
                // Create a new row for details
                const detailsRow = document.createElement('tr');
                detailsRow.className = 'details-row';
                
                // Create a cell that spans all columns
                const detailsCell = document.createElement('td');
                detailsCell.setAttribute('colspan', '8'); // Span all columns in the table
                
                // Get data from the row and data attributes
                const farmerId = row.cells[0].textContent;
                const farmerName = row.cells[1].textContent;
                const contact = row.cells[2].textContent;
                const location = row.cells[3].textContent;
                const cattleCount = row.cells[4].textContent;
                const milkYield = row.cells[5].textContent;
                const status = row.cells[6].querySelector('.status').textContent;
                
                // Get additional data from data attributes
                const registrationDate = row.dataset.registrationDate || 'Not available';
                const notes = row.dataset.notes || 'No notes available';
                const address = row.dataset.address || 'Not available';
                const idNumber = row.dataset.idNumber || 'Not available';
                const nearestCenter = row.dataset.nearestCenter || 'Not available';
                
                // Create the details content - focusing primarily on milk collection data
                detailsCell.innerHTML = `
                    <div class="farmer-details-expanded">
                        <div class="details-header">
                            <h3>Milk Collection Data for ${farmerName}</h3>
                            <button class="close-details-btn" onclick="this.closest('.details-row').classList.add('hidden')">×</button>
                        </div>
                        
                        <!-- Farmer Summary - Compact Version -->
                        <div class="farmer-summary">
                            <div class="summary-row">
                                <div class="summary-item"><strong>ID:</strong> ${farmerId}</div>
                                <div class="summary-item"><strong>Name:</strong> ${farmerName}</div>
                                <div class="summary-item"><strong>Contact:</strong> ${contact}</div>
                                <div class="summary-item"><strong>Location:</strong> ${location}</div>
                                <div class="summary-item"><strong>Cattle:</strong> ${cattleCount}</div>
                                <div class="summary-item"><strong>Status:</strong> ${status}</div>
                            </div>
                        </div>
                        
                        <!-- Milk Collection Section - Main Focus -->
                        <div class="milk-collection-section">
                            <div class="milk-collection-header">
                                <h3>Complete Milk Collection History</h3>
                                <div class="collection-summary">
                                    <div class="summary-item">
                                        <span class="summary-label">30-Day Total:</span>
                                        <span class="summary-value">${(parseFloat(milkYield) * 30).toFixed(1)}L</span>
                                    </div>
                                    <div class="summary-item">
                                        <span class="summary-label">Daily Average:</span>
                                        <span class="summary-value">${milkYield}L</span>
                                    </div>
                                    <div class="summary-item">
                                        <span class="summary-label">Quality Rating:</span>
                                        <span class="summary-value quality-rating">A</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="collection-controls">
                                <button class="btn btn-primary btn-sm" onclick="toggleRecentCollections(this)">Show Recent Only</button>
                                <div class="collection-filter">
                                    <label for="quality-filter-${farmerId}">Filter by Quality:</label>
                                    <select id="quality-filter-${farmerId}" onchange="filterCollectionByQuality(this)">
                                        <option value="all">All Qualities</option>
                                        <option value="A+">A+ Only</option>
                                        <option value="A">A Only</option>
                                        <option value="B+">B+ Only</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="milk-collection-table-container">
                                <table class="collection-table">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Morning (L)</th>
                                            <th>Evening (L)</th>
                                            <th>Total (L)</th>
                                            <th>Quality</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${generateMilkCollectionHistory(farmerId)}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
                
                // Add the details cell to the details row
                detailsRow.appendChild(detailsCell);
                
                // Insert the details row after the current row
                row.parentNode.insertBefore(detailsRow, row.nextSibling);
            }
            
            // Function to generate milk collection history
            function generateMilkCollectionHistory(farmerId) {
                // Generate comprehensive milk collection data for demonstration
                let historyHTML = '';
                const today = new Date();
                
                // Generate data for the last 30 days
                for (let i = 0; i < 30; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toLocaleDateString();
                    
                    // Generate realistic milk yields based on cattle count
                    // Assuming the farmer ID contains a number we can use for seed
                    const farmerIdNum = parseInt(farmerId.replace(/\D/g, '')) || 1;
                    const seed = (farmerIdNum * (i + 1)) % 10;
                    
                    // Morning collection (5-15L per cow)
                    const morning = (Math.random() * 5 + 5 + seed * 0.5).toFixed(1);
                    
                    // Evening collection (4-12L per cow)
                    const evening = (Math.random() * 4 + 4 + seed * 0.3).toFixed(1);
                    
                    // Total collection
                    const total = (parseFloat(morning) + parseFloat(evening)).toFixed(1);
                    
                    // Quality rating with more variation
                    const qualities = ['A+', 'A', 'A', 'B+', 'A', 'A+', 'A', 'B+', 'A', 'A+'];
                    const quality = qualities[(i + seed) % qualities.length];
                    
                    // Add row with conditional formatting based on quality
                    const qualityClass = quality.includes('+') ? 'quality-high' : (quality === 'B+' ? 'quality-medium' : '');
                    
                    historyHTML += `
                        <tr class="${i < 7 ? 'recent-collection' : ''}">
                            <td>${dateStr}</td>
                            <td>${morning}</td>
                            <td>${evening}</td>
                            <td class="${parseFloat(total) > 20 ? 'high-yield' : ''}">${total}</td>
                            <td class="${qualityClass}">${quality}</td>
                        </tr>
                    `;
                }
                
                return historyHTML;
            }
            
            // Function to delete a farmer from the list
            function deleteFarmer(button) {
                // Get the row
                const row = button.closest('tr');
                
                // Get the farmer name from the second cell
                const farmerName = row.cells[1].textContent;
                
                if (confirm(`Are you sure you want to delete ${farmerName}?`)) {
                    // Get the cattle count and milk volume before removing the row
                    const cattleCount = parseInt(row.cells[4].textContent);
                    const milkVolume = parseFloat(row.cells[5].textContent);
                    
                    // Remove the row
                    row.remove();
                    
                    // Update dashboard statistics
                    updateFarmerCount(false); // Decrement farmer count
                    updateCattleCount(cattleCount, false); // Decrement cattle count
                    updateMilkVolume(milkVolume, false); // Decrement milk volume
                    
                    alert(`${farmerName} deleted successfully`);
                }
            }
            
            // Set initial farmer ID
            document.getElementById('farmerId').value = generateFarmerId();
            
            // Initialize action buttons functionality
            function initializeActionButtons() {
                const actionBtns = document.querySelectorAll('.action-btn');
                actionBtns.forEach(btn => {
                    // Remove existing event listeners
                    const newBtn = btn.cloneNode(true);
                    btn.parentNode.replaceChild(newBtn, btn);
                    
                    // Add new event listener
                    newBtn.addEventListener('click', (e) => {
                        const action = e.currentTarget.querySelector('i').className;
                        const farmerName = e.currentTarget.closest('tr').querySelector('td:nth-child(2)').textContent;
                        
                        if (action.includes('eye')) {
                            viewFarmerDetails(e.currentTarget);
                        } else if (action.includes('edit')) {
                            editFarmerDetails(e.currentTarget);
                        } else if (action.includes('trash')) {
                            // Use our global delete function
                            deleteFarmer(e.currentTarget);
                        }
                    });
                });
            }
            
            // Initialize action buttons when the page loads
            document.addEventListener('DOMContentLoaded', function() {
                initializeActionButtons();
                
                // Add direct onclick handlers to all view buttons
                document.querySelectorAll('.action-btn[title="View"]').forEach(btn => {
                    btn.onclick = function() { viewFarmerDetails(this); };
                });
                
                // Add direct onclick handlers to all edit buttons
                document.querySelectorAll('.action-btn[title="Edit"]').forEach(btn => {
                    btn.onclick = function() { editFarmerDetails(this); };
                });
                
                // Add direct onclick handlers to all delete buttons
                document.querySelectorAll('.action-btn[title="Delete"]').forEach(btn => {
                    btn.onclick = function() { deleteFarmer(this); };
                });
            });
        </script>
        
        
        <!-- script to ensure view functionality works -->
        <script>
            console.log('Debug: Adding view functionality');
            
            // Make sure viewFarmerDetails is available globally
            window.viewFarmerDetails = function(button) {
                console.log('View button clicked', button);
                
                // Get the row
                const row = button.closest('tr');
                
                // Check if details row already exists
                const nextRow = row.nextElementSibling;
                if (nextRow && nextRow.classList.contains('details-row')) {
                    // If details row exists, toggle its visibility
                    nextRow.classList.toggle('hidden');
                    return;
                }
                
                // Create a new row for details
                const detailsRow = document.createElement('tr');
                detailsRow.className = 'details-row';
                
                // Create a cell that spans all columns
                const detailsCell = document.createElement('td');
                detailsCell.setAttribute('colspan', '8'); // Span all columns in the table
                
                // Get data from the row and data attributes
                const farmerId = row.cells[0].textContent;
                const farmerName = row.cells[1].textContent;
                const contact = row.cells[2].textContent;
                const location = row.cells[3].textContent;
                const cattleCount = row.cells[4].textContent;
                const milkYield = row.cells[5].textContent;
                const status = row.cells[6].querySelector('.status').textContent;
                
                // Get additional data from data attributes
                const registrationDate = row.dataset.registrationDate || 'Not available';
                const notes = row.dataset.notes || 'No notes available';
                const address = row.dataset.address || 'Not available';
                const idNumber = row.dataset.idNumber || 'Not available';
                const nearestCenter = row.dataset.nearestCenter || 'Not available';
                
                // Create the details content
                detailsCell.innerHTML = `
                    <div class="farmer-details-expanded">
                        <div class="details-header">
                            <h3>Complete Farmer Information</h3>
                            <button class="close-details-btn" onclick="this.closest('.details-row').classList.add('hidden')">×</button>
                        </div>
                        <div class="details-content">
                            <div class="details-column">
                                <div class="detail-item">
                                    <span class="detail-label">Farmer ID:</span>
                                    <span class="detail-value">${farmerId}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Full Name:</span>
                                    <span class="detail-value">${farmerName}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">ID Number:</span>
                                    <span class="detail-value">${idNumber}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Contact:</span>
                                    <span class="detail-value">${contact}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Registration Date:</span>
                                    <span class="detail-value">${registrationDate}</span>
                                </div>
                            </div>
                            <div class="details-column">
                                <div class="detail-item">
                                    <span class="detail-label">Location:</span>
                                    <span class="detail-value">${location}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Address:</span>
                                    <span class="detail-value">${address}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Nearest Center:</span>
                                    <span class="detail-value">${nearestCenter}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Cattle Count:</span>
                                    <span class="detail-value">${cattleCount}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Avg. Milk Yield:</span>
                                    <span class="detail-value">${milkYield} L</span>
                                </div>
                            </div>
                        </div>
                        ${notes !== 'No notes available' ? `
                        <div class="details-notes">
                            <span class="detail-label">Notes:</span>
                            <p class="detail-value">${notes}</p>
                        </div>
                        ` : ''}
                        <div class="details-footer">
                            <div class="farmer-summary">
                                <div class="summary-row">
                                    <div class="summary-item">
                                        <span class="summary-label">Status:</span>
                                        <span class="summary-value">${status}</span>
                                    </div>
                                    <div class="summary-item">
                                        <span class="summary-label">Daily Production:</span>
                                        <span class="summary-value">${milkYield}L</span>
                                    </div>
                                    <div class="summary-item">
                                        <span class="summary-label">Monthly Estimate:</span>
                                        <span class="summary-value">${(parseFloat(milkYield) * 30).toFixed(1)}L</span>
                                    </div>
                                    <div class="summary-item">
                                        <span class="summary-label">Per Cattle Average:</span>
                                        <span class="summary-value">${(parseFloat(milkYield) / parseInt(cattleCount)).toFixed(1)}L</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Add the details cell to the details row
                detailsRow.appendChild(detailsCell);
                
                // Insert the details row after the current row
                row.parentNode.insertBefore(detailsRow, row.nextSibling);
            };
            
            // Make sure deleteFarmer is available globally
            window.deleteFarmer = window.deleteFarmer || function(button) {
                // Get the row
                const row = button.closest('tr');
                
                // Get the farmer name from the second cell
                const farmerName = row.cells[1].textContent;
                
                if (confirm(`Are you sure you want to delete ${farmerName}?`)) {
                    // Get the cattle count and milk volume before removing the row
                    const cattleCount = parseInt(row.cells[4].textContent);
                    const milkVolume = parseFloat(row.cells[5].textContent);
                    
                    // Remove the row
                    row.remove();
                    
                    // Update dashboard statistics
                    updateFarmerCount(false); // Decrement farmer count
                    updateCattleCount(cattleCount, false); // Decrement cattle count
                    updateMilkVolume(milkVolume, false); // Decrement milk volume
                    
                    alert(`${farmerName} deleted successfully`);
                }
            };
            
            // Function to toggle between showing all or recent collections only
            window.toggleRecentCollections = function(button) {
                const table = button.closest('.milk-collection-section').querySelector('.collection-table');
                const rows = table.querySelectorAll('tbody tr');
                
                // Check if we're currently showing all rows
                const showingAll = rows.length > 0 && !rows[7].classList.contains('hidden');
                
                // Toggle button text
                button.textContent = showingAll ? 'Show All' : 'Show Recent Only';
                
                // Toggle visibility of non-recent rows
                rows.forEach((row, index) => {
                    if (index >= 7) { // Show only the first 7 days when toggled
                        row.classList.toggle('hidden', showingAll);
                    }
                });
            };
            
            // Function to filter collection by quality
            window.filterCollectionByQuality = function(select) {
                const table = select.closest('.milk-collection-section').querySelector('.collection-table');
                const rows = table.querySelectorAll('tbody tr');
                const quality = select.value;
                
                // Show all rows if "all" is selected, otherwise filter
                if (quality === 'all') {
                    rows.forEach(row => {
                        row.style.display = '';
                    });
                } else {
                    rows.forEach(row => {
                        const rowQuality = row.cells[4].textContent.trim();
                        row.style.display = (rowQuality === quality) ? '' : 'none';
                    });
                }
            };
            
            // Add click handlers directly to all view buttons
            console.log('Adding direct click handlers to view buttons');
            document.querySelectorAll('.action-btn[title="View"]').forEach(btn => {
                btn.onclick = function() { viewFarmerDetails(this); };
            });
        </script>
        
        <!-- Direct fix for view buttons -->
        <script>
            // Immediately add onclick handlers to all view buttons
            document.addEventListener('DOMContentLoaded', function() {
                // Get all view buttons
                const viewButtons = document.querySelectorAll('.action-btn[title="View"]');
                
                // Add onclick handler to each button
                viewButtons.forEach(function(button) {
                    button.onclick = function() {
                        // Call the viewFarmerDetails function directly
                        viewFarmerDetails(this);
                    };
                });
                
                console.log('Added onclick handlers to', viewButtons.length, 'view buttons');
            });
            
            // Backup implementation of viewFarmerDetails
            if (typeof viewFarmerDetails !== 'function') {
                window.viewFarmerDetails = function(button) {
                    console.log('View button clicked', button);
                    
                    // Get the row
                    const row = button.closest('tr');
                    
                    // Check if details row already exists
                    const nextRow = row.nextElementSibling;
                    if (nextRow && nextRow.classList.contains('details-row')) {
                        // If details row exists, toggle its visibility
                        nextRow.classList.toggle('hidden');
                        return;
                    }
                    
                    // Create a new row for details
                    const detailsRow = document.createElement('tr');
                    detailsRow.className = 'details-row';
                    
                    // Create a cell that spans all columns
                    const detailsCell = document.createElement('td');
                    detailsCell.setAttribute('colspan', '8'); // Span all columns in the table
                    
                    // Get data from the row and data attributes
                    const farmerId = row.cells[0].textContent;
                    const farmerName = row.cells[1].textContent;
                    const contact = row.cells[2].textContent;
                    const location = row.cells[3].textContent;
                    const cattleCount = row.cells[4].textContent;
                    const milkYield = row.cells[5].textContent;
                    const status = row.cells[6].querySelector('.status').textContent;
                    
                    // Get additional data from data attributes
                    const registrationDate = row.dataset.registrationDate || 'Not available';
                    const notes = row.dataset.notes || 'No notes available';
                    const address = row.dataset.address || 'Not available';
                    const idNumber = row.dataset.idNumber || 'Not available';
                    const nearestCenter = row.dataset.nearestCenter || 'Not available';
                    
                    // Create the details content
                    detailsCell.innerHTML = `
                        <div class="farmer-details-expanded">
                            <div class="details-header">
                                <h3>Complete Farmer Information</h3>
                                <button class="close-details-btn" onclick="this.closest('.details-row').classList.add('hidden')">×</button>
                            </div>
                            <div class="details-content">
                                <div class="details-column">
                                    <div class="detail-item">
                                        <span class="detail-label">Farmer ID:</span>
                                        <span class="detail-value">${farmerId}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Full Name:</span>
                                        <span class="detail-value">${farmerName}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">ID Number:</span>
                                        <span class="detail-value">${idNumber}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Contact:</span>
                                        <span class="detail-value">${contact}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Registration Date:</span>
                                        <span class="detail-value">${registrationDate}</span>
                                    </div>
                                </div>
                                <div class="details-column">
                                    <div class="detail-item">
                                        <span class="detail-label">Location:</span>
                                        <span class="detail-value">${location}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Address:</span>
                                        <span class="detail-value">${address}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Nearest Center:</span>
                                        <span class="detail-value">${nearestCenter}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Cattle Count:</span>
                                        <span class="detail-value">${cattleCount}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">Avg. Milk Yield:</span>
                                        <span class="detail-value">${milkYield} L</span>
                                    </div>
                                </div>
                            </div>
                            ${notes !== 'No notes available' ? `
                            <div class="details-notes">
                                <span class="detail-label">Notes:</span>
                                <p class="detail-value">${notes}</p>
                            </div>
                            ` : ''}
                            <div class="details-footer">
                                <div class="farmer-summary">
                                    <div class="summary-row">
                                        <div class="summary-item">
                                            <span class="summary-label">Status:</span>
                                            <span class="summary-value">${status}</span>
                                        </div>
                                        <div class="summary-item">
                                            <span class="summary-label">Daily Production:</span>
                                            <span class="summary-value">${milkYield}L</span>
                                        </div>
                                        <div class="summary-item">
                                            <span class="summary-label">Monthly Estimate:</span>
                                            <span class="summary-value">${(parseFloat(milkYield) * 30).toFixed(1)}L</span>
                                        </div>
                                        <div class="summary-item">
                                            <span class="summary-label">Per Cattle Average:</span>
                                            <span class="summary-value">${(parseFloat(milkYield) / parseInt(cattleCount)).toFixed(1)}L</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // Add the details cell to the details row
                    detailsRow.appendChild(detailsCell);
                    
                    // Insert the details row after the current row
                    row.parentNode.insertBefore(detailsRow, row.nextSibling);
                };
            }
            
            // Backup implementation of generateMilkCollectionData
            function generateMilkCollectionData(farmerId) {
                let html = '';
                const today = new Date();
                
                for (let i = 0; i < 30; i++) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toLocaleDateString();
                    
                    const morning = (Math.random() * 10 + 5).toFixed(1);
                    const evening = (Math.random() * 8 + 4).toFixed(1);
                    const total = (parseFloat(morning) + parseFloat(evening)).toFixed(1);
                    
                    const qualities = ['A+', 'A', 'A', 'B+', 'A'];
                    const quality = qualities[i % qualities.length];
                    
                    html += `
                        <tr>
                            <td>${dateStr}</td>
                            <td>${morning}</td>
                            <td>${evening}</td>
                            <td>${total}</td>
                            <td>${quality}</td>
                        </tr>
                    `;
                }
                
                return html;
            }
        </script>
    </main>
    <script src="js/farm.js"></script>
    
    <!-- Market Analysis JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize all market analysis charts
            initMarketAnalysisCharts();
            
            // Set up event listeners
            setupMarketAnalysisEvents();
            
            // Initialize with default period (30 days)
            const defaultPeriod = document.getElementById('analysisPeriod').value;
            updateChartsWithPeriod(defaultPeriod);
        });
        
        // Initialize all charts in the market analysis section
        function initMarketAnalysisCharts() {
            initPriceTrendChart();
            initSupplyDemandChart();
            initRegionalPriceChart();
            initSeasonalTrendChart();
            initPriceForecastChart();
        }
        
        // Set up event listeners for the market analysis section
        function setupMarketAnalysisEvents() {
            // Time period selector change event
            const analysisPeriod = document.getElementById('analysisPeriod');
            if (analysisPeriod) {
                analysisPeriod.addEventListener('change', function() {
                    // Update all charts with the new time period
                    updateChartsWithPeriod(this.value);
                });
            }
            
            // Export data button click events
            const exportButtons = document.querySelectorAll('.analysis-card .btn-icon[title="Export Data"]');
            exportButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const cardTitle = this.closest('.card-header').querySelector('h3').textContent.trim();
                    exportChartData(cardTitle);
                });
            });
        }
        
        // Price Trend Chart
        function initPriceTrendChart() {
            const ctx = document.getElementById('priceTrendChart');
            if (!ctx) return;
            
            // Sample data - in a real app, this would come from an API
            const labels = generateDateLabels(30); // Last 30 days by default
            const data = generatePriceData(30);
            
            const priceTrendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Milk Price (₹/L)',
                        data: data,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return `Price: ₹${context.raw.toFixed(2)}/L`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: Math.min(...data) - 2,
                            max: Math.max(...data) + 2,
                            ticks: {
                                callback: function(value) {
                                    return '₹' + value;
                                }
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 0,
                                autoSkip: true,
                                maxTicksLimit: 7
                            }
                        }
                    }
                }
            });
            
            // Store the chart instance for later updates
            window.priceTrendChart = priceTrendChart;
        }
        
        // Supply-Demand Chart
        function initSupplyDemandChart() {
            const ctx = document.getElementById('supplyDemandChart');
            if (!ctx) return;
            
            // Sample data
            const labels = generateDateLabels(30);
            const supplyData = generateSupplyData(30);
            const demandData = generateDemandData(30);
            
            const supplyDemandChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Supply (L)',
                            data: supplyData,
                            borderColor: '#27ae60',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            borderWidth: 2,
                            tension: 0.2,
                            fill: true
                        },
                        {
                            label: 'Demand (L)',
                            data: demandData,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 2,
                            tension: 0.2,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                boxWidth: 12,
                                usePointStyle: true
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return value + 'L';
                                }
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 0,
                                autoSkip: true,
                                maxTicksLimit: 7
                            }
                        }
                    }
                }
            });
            
            window.supplyDemandChart = supplyDemandChart;
        }
        
        // Regional Price Chart
        function initRegionalPriceChart() {
            const ctx = document.getElementById('regionalPriceChart');
            if (!ctx) return;
            
            // Sample data for regions
            const regions = ['Bangalore', 'Chennai', 'Hyderabad', 'Mumbai', 'Delhi'];
            const prices = [45.20, 39.80, 42.30, 44.10, 43.50];
            
            const regionalPriceChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: regions,
                    datasets: [{
                        label: 'Price (₹/L)',
                        data: prices,
                        backgroundColor: [
                            'rgba(52, 152, 219, 0.7)',
                            'rgba(231, 76, 60, 0.7)',
                            'rgba(241, 196, 15, 0.7)',
                            'rgba(46, 204, 113, 0.7)',
                            'rgba(155, 89, 182, 0.7)'
                        ],
                        borderColor: [
                            'rgba(52, 152, 219, 1)',
                            'rgba(231, 76, 60, 1)',
                            'rgba(241, 196, 15, 1)',
                            'rgba(46, 204, 113, 1)',
                            'rgba(155, 89, 182, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Price: ₹${context.raw.toFixed(2)}/L`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: Math.min(...prices) - 2,
                            ticks: {
                                callback: function(value) {
                                    return '₹' + value;
                                }
                            }
                        }
                    }
                }
            });
            
            window.regionalPriceChart = regionalPriceChart;
        }
        
        // Seasonal Trend Chart
        function initSeasonalTrendChart() {
            const ctx = document.getElementById('seasonalTrendChart');
            if (!ctx) return;
            
            // Sample seasonal data
            const seasons = ['Winter', 'Spring', 'Summer', 'Monsoon', 'Autumn'];
            const production = [2200, 2600, 3100, 1800, 2400];
            const prices = [44.5, 41.2, 39.8, 46.3, 43.1];
            
            const seasonalTrendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: seasons,
                    datasets: [
                        {
                            label: 'Production (L/day)',
                            data: production,
                            borderColor: '#27ae60',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Price (₹/L)',
                            data: prices,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: false,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                boxWidth: 12,
                                usePointStyle: true
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Production (L/day)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Price (₹/L)'
                            },
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                callback: function(value) {
                                    return '₹' + value;
                                }
                            }
                        }
                    }
                }
            });
            
            window.seasonalTrendChart = seasonalTrendChart;
        }
        
        // Price Forecast Chart
        function initPriceForecastChart() {
            const ctx = document.getElementById('priceForecastChart');
            if (!ctx) return;
            
            // Generate 30 days of historical data and 30 days of forecast data
            const historicalDates = generateDateLabels(30, -30); // Last 30 days
            const forecastDates = generateDateLabels(30); // Next 30 days
            const allDates = [...historicalDates, ...forecastDates];
            
            // Generate price data
            const historicalPrices = generatePriceData(30);
            const forecastPrices = generateForecastData(30, historicalPrices[historicalPrices.length - 1]);
            
            // Create datasets with null values to create the separation
            const historicalDataset = [...historicalPrices, ...Array(30).fill(null)];
            const forecastDataset = [...Array(30).fill(null), ...forecastPrices];
            
            const priceForecastChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: allDates,
                    datasets: [
                        {
                            label: 'Historical Price',
                            data: historicalDataset,
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            borderWidth: 2,
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: 'Forecast Price',
                            data: forecastDataset,
                            borderColor: '#9b59b6',
                            backgroundColor: 'rgba(155, 89, 182, 0.1)',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                boxWidth: 12,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    if (context.raw === null) return;
                                    return `${context.dataset.label}: ₹${context.raw.toFixed(2)}/L`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function(value) {
                                    return '₹' + value;
                                }
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: 0,
                                autoSkip: true,
                                maxTicksLimit: 10
                            }
                        }
                    }
                }
            });
            
            window.priceForecastChart = priceForecastChart;
        }
        
        // Update all charts when time period changes
        function updateChartsWithPeriod(period) {
            period = parseInt(period);
            
            // Update Price Trend Chart
            if (window.priceTrendChart) {
                const labels = generateDateLabels(period);
                const data = generatePriceData(period);
                
                window.priceTrendChart.data.labels = labels;
                window.priceTrendChart.data.datasets[0].data = data;
                window.priceTrendChart.update();
                
                // Update the current average price display
                const currentAvgPrice = document.querySelector('.price-trends .stat-value');
                if (currentAvgPrice) {
                    const avgPrice = (data.reduce((a, b) => a + b, 0) / data.length).toFixed(2);
                    currentAvgPrice.textContent = `₹${avgPrice}/L`;
                }
            }
            
            // Update Supply-Demand Chart
            if (window.supplyDemandChart) {
                const labels = generateDateLabels(period);
                const supplyData = generateSupplyData(period);
                const demandData = generateDemandData(period);
                
                window.supplyDemandChart.data.labels = labels;
                window.supplyDemandChart.data.datasets[0].data = supplyData;
                window.supplyDemandChart.data.datasets[1].data = demandData;
                window.supplyDemandChart.update();
                
                // Update the surplus/deficit display
                const currentSurplus = document.querySelector('.supply-demand .stat-value');
                if (currentSurplus) {
                    const lastSupply = supplyData[supplyData.length - 1];
                    const lastDemand = demandData[demandData.length - 1];
                    const surplus = lastSupply - lastDemand;
                    
                    if (surplus > 0) {
                        currentSurplus.textContent = `${surplus.toFixed(0)} L/day`;
                    } else {
                        currentSurplus.textContent = `${Math.abs(surplus).toFixed(0)} L/day (deficit)`;
                    }
                }
            }
            
            // Update Seasonal Trend Chart based on period
            // This would typically involve more complex logic in a real app
            
            // Update Price Forecast Chart
            if (window.priceForecastChart) {
                const historicalDates = generateDateLabels(period, -period);
                const forecastDates = generateDateLabels(period);
                const allDates = [...historicalDates, ...forecastDates];
                
                const historicalPrices = generatePriceData(period);
                const forecastPrices = generateForecastData(period, historicalPrices[historicalPrices.length - 1]);
                
                const historicalDataset = [...historicalPrices, ...Array(period).fill(null)];
                const forecastDataset = [...Array(period).fill(null), ...forecastPrices];
                
                window.priceForecastChart.data.labels = allDates;
                window.priceForecastChart.data.datasets[0].data = historicalDataset;
                window.priceForecastChart.data.datasets[1].data = forecastDataset;
                window.priceForecastChart.update();
                
                // Update projected high/low
                const projectedHigh = document.querySelector('.price-forecast .stat-value:first-of-type');
                const projectedLow = document.querySelector('.price-forecast .stat-value:last-of-type');
                
                if (projectedHigh && projectedLow) {
                    const high = Math.max(...forecastPrices).toFixed(2);
                    const low = Math.min(...forecastPrices).toFixed(2);
                    
                    projectedHigh.textContent = `₹${high}`;
                    projectedLow.textContent = `₹${low}`;
                }
            }
        }
        
        // Helper function to generate date labels
        function generateDateLabels(days, offset = 0) {
            const dates = [];
            const today = new Date();
            
            for (let i = 0; i < days; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() + offset + i);
                
                // Format as DD/MM
                const day = date.getDate();
                const month = date.getMonth() + 1;
                dates.push(`${day}/${month}`);
            }
            
            return dates;
        }
        
        // Helper function to generate price data
        function generatePriceData(days) {
            const basePrice = 42;
            const prices = [];
            
            for (let i = 0; i < days; i++) {
                // Add some randomness to create realistic price fluctuations
                const fluctuation = (Math.random() - 0.5) * 3;
                // Add a slight upward trend
                const trend = i * 0.03;
                prices.push(basePrice + fluctuation + trend);
            }
            
            return prices;
        }
        
        // Helper function to generate supply data
        function generateSupplyData(days) {
            const baseSupply = 2500;
            const supply = [];
            
            for (let i = 0; i < days; i++) {
                // Add some randomness
                const fluctuation = (Math.random() - 0.5) * 300;
                // Add a seasonal component (higher in summer, lower in winter)
                const seasonal = Math.sin(i / 30 * Math.PI) * 200;
                supply.push(baseSupply + fluctuation + seasonal);
            }
            
            return supply;
        }
        
        // Helper function to generate demand data
        function generateDemandData(days) {
            const baseDemand = 2300;
            const demand = [];
            
            for (let i = 0; i < days; i++) {
                // Add some randomness
                const fluctuation = (Math.random() - 0.5) * 200;
                // Add a seasonal component (higher in winter, lower in summer)
                const seasonal = -Math.sin(i / 30 * Math.PI) * 150;
                // Add a slight upward trend
                const trend = i * 1;
                demand.push(baseDemand + fluctuation + seasonal + trend);
            }
            
            return demand;
        }
        
        // Helper function to generate forecast data
        function generateForecastData(days, lastPrice) {
            const prices = [];
            let currentPrice = lastPrice;
            
            for (let i = 0; i < days; i++) {
                // Add some randomness but with increasing uncertainty
                const uncertainty = 0.5 + (i / days) * 1.5;
                const fluctuation = (Math.random() - 0.5) * uncertainty;
                
                // Add a slight trend based on the day of the month
                // (prices tend to rise at the beginning of the month)
                const today = new Date();
                const dayOfMonth = (today.getDate() + i) % 30;
                const monthlyTrend = dayOfMonth < 15 ? 0.05 : -0.03;
                
                currentPrice += fluctuation + monthlyTrend;
                prices.push(currentPrice);
            }
            
            return prices;
        }
        
        // Function to export chart data
        function exportChartData(chartTitle) {
            // In a real application, this would generate a CSV or Excel file
            alert(`Exporting data for ${chartTitle}. In a real application, this would download a CSV file.`);
        }
        
        // Market News Filtering
        document.addEventListener('DOMContentLoaded', function() {
            // Set up news filter
            const newsFilter = document.getElementById('newsFilter');
            if (newsFilter) {
                newsFilter.addEventListener('change', filterNews);
            }
            
            // Set up news refresh button
            const refreshNewsBtn = document.getElementById('refreshNewsBtn');
            if (refreshNewsBtn) {
                refreshNewsBtn.addEventListener('click', refreshNews);
            }
            
            // Make news items clickable to show details
            const newsItems = document.querySelectorAll('.news-item');
            newsItems.forEach(item => {
                item.addEventListener('click', function() {
                    showNewsDetails(this);
                });
            });
        });
        
        // Filter news items based on selected category
        function filterNews() {
            const filter = document.getElementById('newsFilter').value;
            const newsItems = document.querySelectorAll('.news-item');
            
            newsItems.forEach(item => {
                if (filter === 'all') {
                    item.style.display = 'block';
                } else if (filter === 'urgent' && item.classList.contains('urgent')) {
                    item.style.display = 'block';
                } else if (filter === item.dataset.category) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }
        
        // Simulate refreshing news
        function refreshNews() {
            const refreshBtn = document.getElementById('refreshNewsBtn');
            const newsContainer = document.getElementById('newsContainer');
            
            // Show loading state
            refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
            refreshBtn.disabled = true;
            
            // Simulate API call delay
            setTimeout(() => {
                // Add a new news item
                const newItem = document.createElement('div');
                newItem.className = 'news-item';
                newItem.dataset.category = 'trends';
                
                const currentDate = new Date();
                const timeString = 'Just now';
                
                newItem.innerHTML = `
                    <div class="news-content">
                        <h4>Milk Prices Expected to Stabilize in Coming Weeks</h4>
                        <p>Industry experts predict milk prices will stabilize after recent fluctuations due to improved supply chain logistics.</p>
                        <div class="news-meta">
                            <span><i class="far fa-clock"></i> ${timeString}</span>
                            <span><i class="fas fa-tag"></i> Market Forecast</span>
                        </div>
                    </div>
                `;
                
                // Add click event to the new item
                newItem.addEventListener('click', function() {
                    showNewsDetails(this);
                });
                
                // Add to the top of the news container
                newsContainer.insertBefore(newItem, newsContainer.firstChild);
                
                // Reset button
                refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Refresh';
                refreshBtn.disabled = false;
                
                // Apply current filter
                filterNews();
            }, 1500);
        }
        
        // Show detailed news in a modal or expanded view
        function showNewsDetails(newsItem) {
            const title = newsItem.querySelector('h4').textContent;
            const content = newsItem.querySelector('p').textContent;
            const meta = newsItem.querySelector('.news-meta').textContent;
            
            // In a real application, this would open a modal with full details
            // For now, we'll just show an alert
            alert(`${title}\n\n${content}\n\n${meta}`);
            
            // In a real app, you might do:
            // openModal('newsDetailModal', { title, content, meta });
        }
        
        // Add competitor analysis interactivity
        document.addEventListener('DOMContentLoaded', function() {
            // Make competitor table rows interactive
            const competitorRows = document.querySelectorAll('.competitor-analysis table tbody tr');
            competitorRows.forEach(row => {
                row.addEventListener('click', function() {
                    // Highlight the selected row
                    competitorRows.forEach(r => r.classList.remove('selected-row'));
                    this.classList.add('selected-row');
                    
                    // In a real app, this would show detailed competitor analysis
                    const competitor = this.cells[0].textContent;
                    alert(`Showing detailed analysis for ${competitor}`);
                });
            });
        });
    </script>
    
    <!-- Dark Mode Toggle Functionality -->
    <script>
        // Dark Mode Toggle Functionality
        document.addEventListener('DOMContentLoaded', function() {
            const modeToggle = document.getElementById('modeToggle');
            const body = document.body;
            const modeIcon = modeToggle.querySelector('i');
            
            // Check for saved dark mode preference or default to light mode
            const savedMode = localStorage.getItem('darkMode');
            if (savedMode === 'enabled') {
                enableDarkMode();
            }
            
            // Toggle dark mode on button click
            modeToggle.addEventListener('click', () => {
                if (body.classList.contains('dark-mode')) {
                    disableDarkMode();
                } else {
                    enableDarkMode();
                }
            });
            
            function enableDarkMode() {
                body.classList.add('dark-mode');
                modeIcon.classList.remove('fa-moon');
                modeIcon.classList.add('fa-sun');
                localStorage.setItem('darkMode', 'enabled');
            }
            
            function disableDarkMode() {
                body.classList.remove('dark-mode');
                modeIcon.classList.remove('fa-sun');
                modeIcon.classList.add('fa-moon');
                localStorage.setItem('darkMode', 'disabled');
            }
            
            // Set active navigation state based on current page
            function setActiveNavigation() {
                // Get current page name from URL
                const currentPage = window.location.pathname.split('/').pop() || 'farmer.html';
                
                // Remove active class from all navigation items
                document.querySelectorAll('#sidebar li').forEach(li => {
                    li.classList.remove('active');
                });
                
                // Add active class based on current page
                if (currentPage.includes('farmer.html')) {
                    document.querySelector('.farmer-nav').classList.add('active');
                } else if (currentPage.includes('dashb.html')) {
                    document.querySelector('.dashboard-nav').classList.add('active');
                } else if (currentPage.includes('collection.html')) {
                    document.querySelector('.collection-nav').classList.add('active');
                } else if (currentPage.includes('chilling.html')) {
                    document.querySelector('.chilling-nav').classList.add('active');
                } else if (currentPage.includes('plant.html')) {
                    document.querySelector('.processing-nav').classList.add('active');
                } else if (currentPage.includes('qualitydemo.html')) {
                    document.querySelector('.quality-nav').classList.add('active');
                } else if (currentPage.includes('product.html')) {
                    document.querySelector('.inventory-nav').classList.add('active');
                } else if (currentPage.includes('distubtion.html')) {
                    document.querySelector('.logistics-nav').classList.add('active');
                } else if (currentPage.includes('crmdemo.html')) {
                    document.querySelector('.crm-nav').classList.add('active');
                }
            }
            
            // Call the function when page loads
            setActiveNavigation();
        });
    </script>

    <!-- Strict Form Validation Functions -->
    <script>
        // Global validation state
        let validationState = {
            insurance: {
                farmer: false,
                type: false,
                provider: false,
                policyNumber: false,
                premium: false,
                dates: false,
                coverage: false,
                assets: false,
                documents: false
            },
            scheme: {
                farmer: false,
                type: false,
                details: false,
                date: false,
                documents: false
            }
        };

        // Insurance Form Validations
        function validateFarmerSelection(formType) {
            const farmerId = document.getElementById(formType + 'FarmerId').value;
            const validationElement = document.getElementById(formType === 'insurance' ? 'farmerValidation' : 'schemeFarmerValidation');
            
            if (!farmerId) {
                showValidationError(validationElement, 'Please select a registered farmer');
                validationState[formType].farmer = false;
            } else {
                showValidationSuccess(validationElement, 'Farmer selected successfully');
                validationState[formType].farmer = true;
            }
            
            updateSubmitButton(formType);
        }

        function updateInsuranceFields(insuranceType) {
            const providerSelect = document.getElementById('insuranceProvider');
            const assetSection = document.getElementById('assetDetailsSection');
            const validationElement = document.getElementById('insuranceTypeValidation');
            
            // Clear previous options
            providerSelect.innerHTML = '<option value="">Select provider</option>';
            
            // Hide all asset sections
            document.querySelectorAll('.agri-asset-section').forEach(section => {
                section.style.display = 'none';
            });
            
            if (!insuranceType) {
                showValidationError(validationElement, 'Please select an insurance type');
                validationState.insurance.type = false;
                assetSection.style.display = 'none';
                updateSubmitButton('insurance');
                return;
            }
            
            // Update provider options based on insurance type
            const providers = {
                livestock: [
                    { value: 'agrocare', text: 'AgroCare Livestock Insurance' },
                    { value: 'bajaj', text: 'Bajaj Allianz Animal Insurance' },
                    { value: 'iffco', text: 'IFFCO Tokio Livestock Insurance' }
                ],
                crop: [
                    { value: 'pmfby', text: 'PMFBY (Government)' },
                    { value: 'aic', text: 'Agriculture Insurance Company' },
                    { value: 'reliance', text: 'Reliance General Insurance' }
                ],
                equipment: [
                    { value: 'tata', text: 'Tata AIG Equipment Insurance' },
                    { value: 'hdfc', text: 'HDFC ERGO Equipment Insurance' },
                    { value: 'oriental', text: 'Oriental Insurance Company' }
                ],
                comprehensive: [
                    { value: 'sbi', text: 'SBI General Insurance' },
                    { value: 'icici', text: 'ICICI Lombard Farm Insurance' },
                    { value: 'new-india', text: 'New India Assurance' }
                ]
            };
            
            providers[insuranceType].forEach(provider => {
                const option = document.createElement('option');
                option.value = provider.value;
                option.textContent = provider.text;
                providerSelect.appendChild(option);
            });
            
            // Show relevant asset section
            assetSection.style.display = 'block';
            const assetSectionId = insuranceType + 'Details';
            const targetSection = document.getElementById(assetSectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
                
                // Make asset fields required
                const requiredFields = targetSection.querySelectorAll('.agri-required-field input, .agri-required-field select');
                requiredFields.forEach(field => {
                    field.required = true;
                });
            }
            
            showValidationSuccess(validationElement, 'Insurance type selected');
            validationState.insurance.type = true;
            updateSubmitButton('insurance');
        }

        function validatePolicyNumber(policyNumber) {
            const validationElement = document.getElementById('policyNumberValidation');
            const pattern = /^INS-[0-9]{4}-[A-Z0-9]{4}$/;
            
            if (!policyNumber) {
                showValidationError(validationElement, 'Policy number is required');
                validationState.insurance.policyNumber = false;
            } else if (!pattern.test(policyNumber)) {
                showValidationError(validationElement, 'Invalid format. Use: INS-YYYY-XXXX (e.g., INS-2025-1234)');
                validationState.insurance.policyNumber = false;
            } else {
                showValidationSuccess(validationElement, 'Valid policy number format');
                validationState.insurance.policyNumber = true;
            }
            
            updateSubmitButton('insurance');
        }

        function validatePremiumAmount(amount) {
            const validationElement = document.getElementById('premiumValidation');
            const numAmount = parseFloat(amount);
            
            if (!amount) {
                showValidationError(validationElement, 'Premium amount is required');
                validationState.insurance.premium = false;
            } else if (numAmount < 500) {
                showValidationError(validationElement, 'Minimum premium amount is ₹500');
                validationState.insurance.premium = false;
            } else if (numAmount > 100000) {
                showValidationError(validationElement, 'Maximum premium amount is ₹1,00,000');
                validationState.insurance.premium = false;
            } else {
                showValidationSuccess(validationElement, 'Valid premium amount');
                validationState.insurance.premium = true;
            }
            
            updateSubmitButton('insurance');
        }

        function validateInsuranceDates() {
            const startDate = document.getElementById('insuranceStartDate').value;
            const endDate = document.getElementById('insuranceEndDate').value;
            const startValidation = document.getElementById('startDateValidation');
            const endValidation = document.getElementById('endDateValidation');
            
            const today = new Date();
            const start = new Date(startDate);
            const end = new Date(endDate);
            
            let isValid = true;
            
            if (!startDate) {
                showValidationError(startValidation, 'Start date is required');
                isValid = false;
            } else if (start < today) {
                showValidationError(startValidation, 'Start date cannot be in the past');
                isValid = false;
            } else {
                showValidationSuccess(startValidation, 'Valid start date');
            }
            
            if (!endDate) {
                showValidationError(endValidation, 'End date is required');
                isValid = false;
            } else if (end <= start) {
                showValidationError(endValidation, 'End date must be after start date');
                isValid = false;
            } else {
                const daysDiff = (end - start) / (1000 * 60 * 60 * 24);
                if (daysDiff < 365) {
                    showValidationError(endValidation, 'Minimum policy duration is 1 year');
                    isValid = false;
                } else if (daysDiff > 1825) { // 5 years
                    showValidationError(endValidation, 'Maximum policy duration is 5 years');
                    isValid = false;
                } else {
                    showValidationSuccess(endValidation, 'Valid end date');
                }
            }
            
            validationState.insurance.dates = isValid;
            updateSubmitButton('insurance');
        }

        function validateCoverageAmount(amount) {
            const validationElement = document.getElementById('coverageValidation');
            
            if (!amount) {
                showValidationError(validationElement, 'Coverage amount is required');
                validationState.insurance.coverage = false;
            } else {
                showValidationSuccess(validationElement, 'Coverage amount selected');
                validationState.insurance.coverage = true;
            }
            
            updateSubmitButton('insurance');
        }

        // Asset-specific validations
        function validateAnimalCount(count) {
            const validationElement = document.getElementById('animalCountValidation');
            const numCount = parseInt(count);
            
            if (!count) {
                showValidationError(validationElement, 'Number of animals is required for livestock insurance');
                validationState.insurance.assets = false;
            } else if (numCount < 1) {
                showValidationError(validationElement, 'Minimum 1 animal required');
                validationState.insurance.assets = false;
            } else if (numCount > 100) {
                showValidationError(validationElement, 'Maximum 100 animals allowed per policy');
                validationState.insurance.assets = false;
            } else {
                showValidationSuccess(validationElement, 'Valid animal count');
                validationState.insurance.assets = true;
            }
            
            updateSubmitButton('insurance');
        }

        function validateCultivatedArea(area) {
            const validationElement = document.getElementById('cultivatedAreaValidation');
            const farmerId = document.getElementById('insuranceFarmerId').value;
            const farmerOption = document.querySelector(`#insuranceFarmerId option[value="${farmerId}"]`);
            const totalLand = farmerOption ? parseFloat(farmerOption.dataset.land) : 0;
            const numArea = parseFloat(area);
            
            if (!area) {
                showValidationError(validationElement, 'Cultivated area is required for crop insurance');
                validationState.insurance.assets = false;
            } else if (numArea < 0.1) {
                showValidationError(validationElement, 'Minimum 0.1 acres required');
                validationState.insurance.assets = false;
            } else if (numArea > totalLand) {
                showValidationError(validationElement, `Cannot exceed total land area (${totalLand} acres)`);
                validationState.insurance.assets = false;
            } else {
                showValidationSuccess(validationElement, 'Valid cultivated area');
                validationState.insurance.assets = true;
            }
            
            updateSubmitButton('insurance');
        }

        function validateEquipmentValue(value) {
            const validationElement = document.getElementById('equipmentValueValidation');
            const numValue = parseFloat(value);
            
            if (!value) {
                showValidationError(validationElement, 'Equipment value is required for equipment insurance');
                validationState.insurance.assets = false;
            } else if (numValue < 10000) {
                showValidationError(validationElement, 'Minimum equipment value is ₹10,000');
                validationState.insurance.assets = false;
            } else if (numValue > 5000000) {
                showValidationError(validationElement, 'Maximum equipment value is ₹50,00,000');
                validationState.insurance.assets = false;
            } else {
                showValidationSuccess(validationElement, 'Valid equipment value');
                validationState.insurance.assets = true;
            }
            
            updateSubmitButton('insurance');
        }

        function validateInsuranceDocuments(files) {
            const validationElement = document.getElementById('documentsValidation');
            const maxSize = 5 * 1024 * 1024; // 5MB
            const allowedTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png'];
            
            if (!files || files.length === 0) {
                showValidationError(validationElement, 'Documents will be required for final approval');
                validationState.insurance.documents = true; // Allow submission without documents
                updateSubmitButton('insurance');
                return;
            }
            
            for (let file of files) {
                if (file.size > maxSize) {
                    showValidationError(validationElement, `File ${file.name} exceeds 5MB limit`);
                    validationState.insurance.documents = false;
                    updateSubmitButton('insurance');
                    return;
                }
                
                if (!allowedTypes.includes(file.type)) {
                    showValidationError(validationElement, `File ${file.name} has invalid format. Use PDF, JPG, or PNG`);
                    validationState.insurance.documents = false;
                    updateSubmitButton('insurance');
                    return;
                }
            }
            
            showValidationSuccess(validationElement, `${files.length} documents uploaded successfully`);
            validationState.insurance.documents = true;
            updateSubmitButton('insurance');
        }

        // Scheme Form Validations
        function updateSchemeFields(schemeType) {
            const detailsSection = document.getElementById('schemeDetailsSection');
            const validationElement = document.getElementById('schemeTypeValidation');
            
            // Hide all scheme sections
            document.querySelectorAll('.agri-scheme-section').forEach(section => {
                section.style.display = 'none';
            });
            
            if (!schemeType) {
                showValidationError(validationElement, 'Please select a government scheme');
                validationState.scheme.type = false;
                detailsSection.style.display = 'none';
                updateSubmitButton('scheme');
                return;
            }
            
            // Show relevant scheme section
            detailsSection.style.display = 'block';
            const schemeSectionId = schemeType + 'Details';
            const targetSection = document.getElementById(schemeSectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
                
                // Make scheme-specific fields required
                const requiredFields = targetSection.querySelectorAll('.agri-required-field input, .agri-required-field select');
                requiredFields.forEach(field => {
                    field.required = true;
                });
            }
            
            showValidationSuccess(validationElement, 'Scheme type selected');
            validationState.scheme.type = true;
            updateSubmitButton('scheme');
        }

        function validateMilkProduction(production) {
            const validationElement = document.getElementById('milkProductionValidation');
            const numProduction = parseFloat(production);
            
            if (!production) {
                showValidationError(validationElement, 'Daily milk production is required for KMBY scheme');
                validationState.scheme.details = false;
            } else if (numProduction < 150) {
                showValidationError(validationElement, 'Minimum 150 liters per day required for KMBY scheme');
                validationState.scheme.details = false;
            } else {
                showValidationSuccess(validationElement, 'Eligible for KMBY scheme');
                validationState.scheme.details = true;
            }
            
            updateSubmitButton('scheme');
        }

        function calculateSubsidy(projectCost) {
            const subsidyField = document.getElementById('expectedSubsidy');
            const validationElement = document.getElementById('projectCostValidation');
            const numCost = parseFloat(projectCost);
            
            if (!projectCost) {
                showValidationError(validationElement, 'Project cost is required');
                validationState.scheme.details = false;
                subsidyField.value = '';
            } else if (numCost < 50000) {
                showValidationError(validationElement, 'Minimum project cost is ₹50,000');
                validationState.scheme.details = false;
                subsidyField.value = '';
            } else if (numCost > 500000) {
                showValidationError(validationElement, 'Maximum project cost is ₹5,00,000');
                validationState.scheme.details = false;
                subsidyField.value = '';
            } else {
                const subsidyRate = 0.25; // 25%
                const maxSubsidy = 50000;
                const calculatedSubsidy = Math.min(numCost * subsidyRate, maxSubsidy);
                
                subsidyField.value = `₹${calculatedSubsidy.toLocaleString()} (25% of project cost, max ₹50,000)`;
                showValidationSuccess(validationElement, 'Valid project cost');
                validationState.scheme.details = true;
            }
            
            updateSubmitButton('scheme');
        }

        function validateApplicationDate(date) {
            const validationElement = document.getElementById('applicationDateValidation');
            const expectedApprovalField = document.getElementById('expectedApproval');
            const appDate = new Date(date);
            const today = new Date();
            
            if (!date) {
                showValidationError(validationElement, 'Application date is required');
                validationState.scheme.date = false;
                expectedApprovalField.value = '';
            } else if (appDate > today) {
                showValidationError(validationElement, 'Application date cannot be in the future');
                validationState.scheme.date = false;
                expectedApprovalField.value = '';
            } else {
                // Calculate expected approval date (typically 30-45 days)
                const expectedDate = new Date(appDate);
                expectedDate.setDate(expectedDate.getDate() + 35);
                expectedApprovalField.value = expectedDate.toISOString().split('T')[0];
                
                showValidationSuccess(validationElement, 'Valid application date');
                validationState.scheme.date = true;
            }
            
            updateSubmitButton('scheme');
        }

        function validateSchemeDocuments(files) {
            const validationElement = document.getElementById('schemeDocumentsValidation');
            const maxSize = 5 * 1024 * 1024; // 5MB
            const allowedTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png'];
            
            if (!files || files.length === 0) {
                showValidationError(validationElement, 'Documents will be required for final approval');
                validationState.scheme.documents = true; // Allow submission without documents
                updateSubmitButton('scheme');
                return;
            }
            
            for (let file of files) {
                if (file.size > maxSize) {
                    showValidationError(validationElement, `File ${file.name} exceeds 5MB limit`);
                    validationState.scheme.documents = false;
                    updateSubmitButton('scheme');
                    return;
                }
                
                if (!allowedTypes.includes(file.type)) {
                    showValidationError(validationElement, `File ${file.name} has invalid format. Use PDF, JPG, or PNG`);
                    validationState.scheme.documents = false;
                    updateSubmitButton('scheme');
                    return;
                }
            }
            
            showValidationSuccess(validationElement, `${files.length} documents uploaded successfully`);
            validationState.scheme.documents = true;
            updateSubmitButton('scheme');
        }

        // Utility Functions
        function showValidationError(element, message) {
            element.textContent = message;
            element.className = 'agri-validation-message agri-error';
            element.style.display = 'block';
        }

        function showValidationSuccess(element, message) {
            element.textContent = message;
            element.className = 'agri-validation-message agri-success';
            element.style.display = 'block';
        }

        function updateSubmitButton(formType) {
            const submitBtn = document.getElementById('submit' + (formType === 'insurance' ? 'Insurance' : 'Scheme') + 'Btn');
            
            // Always keep the button enabled for better user experience
            // The validation will happen on form submission
            submitBtn.disabled = false;
            submitBtn.classList.remove('agri-btn-disabled');
            submitBtn.classList.add('agri-btn-primary');
        }

        // Form Submission Handlers
        function validateInsuranceForm(event) {
            event.preventDefault();
            
            // Basic required field validation
            const farmerId = document.getElementById('insuranceFarmerId').value;
            const insuranceType = document.getElementById('insuranceType').value;
            const policyNumber = document.getElementById('policyNumber').value;
            const premiumAmount = document.getElementById('premiumAmount').value;
            const startDate = document.getElementById('insuranceStartDate').value;
            const endDate = document.getElementById('insuranceEndDate').value;
            
            // Check basic required fields
            if (!farmerId) {
                alert('Please select a farmer.');
                return false;
            }
            
            if (!insuranceType) {
                alert('Please select an insurance type.');
                return false;
            }
            
            if (!policyNumber) {
                alert('Please enter a policy number.');
                return false;
            }
            
            if (!premiumAmount || premiumAmount < 500) {
                alert('Please enter a valid premium amount (minimum ₹500).');
                return false;
            }
            
            if (!startDate || !endDate) {
                alert('Please select both start and end dates.');
                return false;
            }
            
            // Validate dates
            const start = new Date(startDate);
            const end = new Date(endDate);
            const today = new Date();
            
            if (start < today) {
                alert('Start date cannot be in the past.');
                return false;
            }
            
            if (end <= start) {
                alert('End date must be after start date.');
                return false;
            }
            
            // If all basic validations pass, show success message
            alert('Insurance application submitted successfully! You will receive a confirmation email shortly.');
            
            // Add the record to the table (simulate saving)
            addInsuranceRecordToTable({
                farmerId: farmerId,
                insuranceType: insuranceType,
                policyNumber: policyNumber,
                premiumAmount: premiumAmount,
                startDate: startDate,
                endDate: endDate
            });
            
            closeAgriModal('addAgriSupportModal');
            resetInsuranceForm();
            return false; // Prevent actual form submission for demo
        }

        function validateSchemeForm(event) {
            event.preventDefault();
            
            // Basic required field validation
            const farmerId = document.getElementById('schemeFarmerId').value;
            const schemeType = document.getElementById('schemeType').value;
            const applicationDate = document.getElementById('applicationDate').value;
            
            // Check basic required fields
            if (!farmerId) {
                alert('Please select a farmer.');
                return false;
            }
            
            if (!schemeType) {
                alert('Please select a government scheme.');
                return false;
            }
            
            if (!applicationDate) {
                alert('Please enter an application date.');
                return false;
            }
            
            // Validate application date
            const appDate = new Date(applicationDate);
            const today = new Date();
            
            if (appDate > today) {
                alert('Application date cannot be in the future.');
                return false;
            }
            
            // If all basic validations pass, show success message
            alert('Government scheme application submitted successfully! You will receive updates on your application status.');
            
            // Add the record to the table (simulate saving)
            addSchemeRecordToTable({
                farmerId: farmerId,
                schemeType: schemeType,
                applicationDate: applicationDate
            });
            
            closeAgriModal('addAgriSupportModal');
            resetSchemeForm();
            return false; // Prevent actual form submission for demo
        }

        // Reset Functions
        function resetInsuranceForm() {
            document.getElementById('agri-insurance-form').reset();
            
            // Reset validation state
            for (let key in validationState.insurance) {
                validationState.insurance[key] = false;
            }
            
            // Hide validation messages
            document.querySelectorAll('#agri-insurance-form .agri-validation-message').forEach(element => {
                element.style.display = 'none';
            });
            
            // Hide asset sections
            document.getElementById('assetDetailsSection').style.display = 'none';
            document.querySelectorAll('.agri-asset-section').forEach(section => {
                section.style.display = 'none';
            });
            
            updateSubmitButton('insurance');
        }

        function resetSchemeForm() {
            document.getElementById('agri-scheme-form').reset();
            
            // Reset validation state
            for (let key in validationState.scheme) {
                validationState.scheme[key] = false;
            }
            
            // Hide validation messages
            document.querySelectorAll('#agri-scheme-form .agri-validation-message').forEach(element => {
                element.style.display = 'none';
            });
            
            // Hide scheme sections
            document.getElementById('schemeDetailsSection').style.display = 'none';
            document.querySelectorAll('.agri-scheme-section').forEach(section => {
                section.style.display = 'none';
            });
            
            updateSubmitButton('scheme');
        }

        // Functions to add records to display tables
        function addInsuranceRecordToTable(data) {
            // Find the insurance cards container
            const insuranceContainer = document.querySelector('.agri-support-grid');
            if (!insuranceContainer) return;
            
            // Get farmer name from the selected option
            const farmerOption = document.querySelector(`#insuranceFarmerId option[value="${data.farmerId}"]`);
            const farmerName = farmerOption ? farmerOption.dataset.name : 'Unknown Farmer';
            
            // Create new insurance card
            const newCard = document.createElement('div');
            newCard.className = 'agri-support-card';
            newCard.dataset.farmer = data.farmerId;
            newCard.dataset.status = 'active';
            newCard.dataset.type = 'insurance';
            
            const statusClass = 'agri-badge-active';
            const typeIcon = getInsuranceTypeIcon(data.insuranceType);
            
            newCard.innerHTML = `
                <div class="agri-card-header">
                    <div class="agri-card-title">
                        <i class="${typeIcon}"></i>
                        <span>${data.insuranceType.charAt(0).toUpperCase() + data.insuranceType.slice(1)} Insurance</span>
                    </div>
                    <div class="agri-card-actions">
                        <button class="agri-btn-icon" onclick="viewInsuranceDetails(this)" title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="agri-btn-icon" onclick="editInsuranceRecord(this)" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="agri-btn-icon" onclick="deleteInsuranceRecord(this)" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="agri-card-body">
                    <div class="agri-card-info">
                        <div class="agri-info-item">
                            <span class="agri-info-label">Farmer:</span>
                            <span class="agri-info-value">${farmerName}</span>
                        </div>
                        <div class="agri-info-item">
                            <span class="agri-info-label">Policy Number:</span>
                            <span class="agri-info-value">${data.policyNumber}</span>
                        </div>
                        <div class="agri-info-item">
                            <span class="agri-info-label">Premium:</span>
                            <span class="agri-info-value">₹${parseInt(data.premiumAmount).toLocaleString()}</span>
                        </div>
                        <div class="agri-info-item">
                            <span class="agri-info-label">Valid Until:</span>
                            <span class="agri-info-value">${formatDate(data.endDate)}</span>
                        </div>
                    </div>
                </div>
                <div class="agri-card-footer">
                    <span class="agri-badge ${statusClass}">
                        <i class="fas fa-check-circle"></i> Active
                    </span>
                    <span class="agri-card-date">Added: ${formatDate(new Date().toISOString().split('T')[0])}</span>
                </div>
            `;
            
            // Add to the beginning of the container
            insuranceContainer.insertBefore(newCard, insuranceContainer.firstChild);
            
            // Update stats
            updateAgriStats();
        }

        function addSchemeRecordToTable(data) {
            // Find the schemes cards container
            const schemesContainer = document.querySelector('.agri-support-grid');
            if (!schemesContainer) return;
            
            // Get farmer name from the selected option
            const farmerOption = document.querySelector(`#schemeFarmerId option[value="${data.farmerId}"]`);
            const farmerName = farmerOption ? farmerOption.dataset.name : 'Unknown Farmer';
            
            // Create new scheme card
            const newCard = document.createElement('div');
            newCard.className = 'agri-support-card';
            newCard.dataset.farmer = data.farmerId;
            newCard.dataset.status = 'pending';
            newCard.dataset.type = 'scheme';
            
            const statusClass = 'agri-badge-pending';
            const typeIcon = getSchemeTypeIcon(data.schemeType);
            
            newCard.innerHTML = `
                <div class="agri-card-header">
                    <div class="agri-card-title">
                        <i class="${typeIcon}"></i>
                        <span>${getSchemeDisplayName(data.schemeType)}</span>
                    </div>
                    <div class="agri-card-actions">
                        <button class="agri-btn-icon" onclick="viewSchemeDetails(this)" title="View Details">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="agri-btn-icon" onclick="editSchemeRecord(this)" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="agri-btn-icon" onclick="deleteSchemeRecord(this)" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="agri-card-body">
                    <div class="agri-card-info">
                        <div class="agri-info-item">
                            <span class="agri-info-label">Farmer:</span>
                            <span class="agri-info-value">${farmerName}</span>
                        </div>
                        <div class="agri-info-item">
                            <span class="agri-info-label">Application Date:</span>
                            <span class="agri-info-value">${formatDate(data.applicationDate)}</span>
                        </div>
                        <div class="agri-info-item">
                            <span class="agri-info-label">Expected Approval:</span>
                            <span class="agri-info-value">${getExpectedApprovalDate(data.applicationDate)}</span>
                        </div>
                    </div>
                </div>
                <div class="agri-card-footer">
                    <span class="agri-badge ${statusClass}">
                        <i class="fas fa-clock"></i> Pending
                    </span>
                    <span class="agri-card-date">Applied: ${formatDate(data.applicationDate)}</span>
                </div>
            `;
            
            // Add to the beginning of the container
            schemesContainer.insertBefore(newCard, schemesContainer.firstChild);
            
            // Update stats
            updateAgriStats();
        }

        // Helper functions
        function getInsuranceTypeIcon(type) {
            const icons = {
                livestock: 'fas fa-cow',
                crop: 'fas fa-seedling',
                equipment: 'fas fa-tractor',
                comprehensive: 'fas fa-shield-alt'
            };
            return icons[type] || 'fas fa-shield-alt';
        }

        function getSchemeTypeIcon(type) {
            const icons = {
                pmkisan: 'fas fa-rupee-sign',
                pmfby: 'fas fa-seedling',
                deds: 'fas fa-cow',
                kmby: 'fas fa-tint',
                kcc: 'fas fa-credit-card',
                'soil-health': 'fas fa-leaf'
            };
            return icons[type] || 'fas fa-hand-holding-usd';
        }

        function getSchemeDisplayName(type) {
            const names = {
                pmkisan: 'PM-KISAN Samman Nidhi',
                pmfby: 'PM Fasal Bima Yojana',
                deds: 'Dairy Entrepreneurship Development',
                kmby: 'Kisan Milk Bonus Yojana',
                kcc: 'Kisan Credit Card',
                'soil-health': 'Soil Health Card Scheme'
            };
            return names[type] || type;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-IN', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
        }

        function getExpectedApprovalDate(applicationDate) {
            const date = new Date(applicationDate);
            date.setDate(date.getDate() + 35); // Add 35 days
            return formatDate(date.toISOString().split('T')[0]);
        }

        function updateAgriStats() {
            // Update the stats cards with new counts
            const allCards = document.querySelectorAll('.agri-support-card');
            const insuranceCards = document.querySelectorAll('.agri-support-card[data-type="insurance"]');
            const schemeCards = document.querySelectorAll('.agri-support-card[data-type="scheme"]');
            const activeCards = document.querySelectorAll('.agri-support-card[data-status="active"]');
            
            // Update stat values if elements exist
            const totalStat = document.querySelector('.agri-stat-card .agri-stat-value');
            if (totalStat) totalStat.textContent = allCards.length;
            
            // You can add more stat updates here as needed
        }

        // Enhanced Modal Functions
        function openInsuranceApplicationForm() {
            closeAgriModal('eligibilityCheckerModal');
            openAgriModal('addAgriSupportModal');
            switchAgriFormTab('agri-insurance-form');
        }

        function openSchemeApplicationForm() {
            closeAgriModal('eligibilityCheckerModal');
            openAgriModal('addAgriSupportModal');
            switchAgriFormTab('agri-scheme-form');
        }

        // Enhanced Scheme Browser Functionality
        let currentPage = 1;
        let schemesPerPage = 10;
        let allSchemes = [];
        let filteredSchemes = [];

        // Initialize scheme browser when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeSchemeBrowser();
        });

        function initializeSchemeBrowser() {
            // Get all scheme cards
            allSchemes = Array.from(document.querySelectorAll('.agri-scheme-card'));
            filteredSchemes = [...allSchemes];
            updateSchemeStats();
            updatePagination();
        }

        // Filter Functions
        function filterSchemes() {
            const governmentFilter = document.getElementById('governmentFilter').value;
            const categoryFilter = document.getElementById('categoryFilter').value;
            const stateFilter = document.getElementById('stateFilter').value;
            const amountFilter = document.getElementById('amountFilter').value;
            const searchTerm = document.getElementById('schemeSearchInput').value.toLowerCase();

            filteredSchemes = allSchemes.filter(scheme => {
                // Government level filter
                if (governmentFilter !== 'all' && scheme.dataset.government !== governmentFilter) {
                    return false;
                }

                // Category filter
                if (categoryFilter !== 'all' && scheme.dataset.category !== categoryFilter) {
                    return false;
                }

                // State filter
                if (stateFilter !== 'all' && scheme.dataset.state !== stateFilter && scheme.dataset.state !== 'all') {
                    return false;
                }

                // Amount filter
                if (amountFilter !== 'all') {
                    const amountText = scheme.querySelector('.agri-scheme-amount').textContent.toLowerCase();
                    if (amountFilter === 'low' && !amountText.includes('6,000') && !amountText.includes('17,500') && !amountText.includes('free')) {
                        return false;
                    }
                    if (amountFilter === 'medium' && !amountText.includes('50,000') && !amountText.includes('2,00,000') && !amountText.includes('25-33%') && !amountText.includes('40-50%')) {
                        return false;
                    }
                    if (amountFilter === 'high' && !amountText.includes('3,00,000') && !amountText.includes('40 lakh') && !amountText.includes('50-80%')) {
                        return false;
                    }
                }

                // Search filter
                if (searchTerm) {
                    const schemeText = scheme.textContent.toLowerCase();
                    if (!schemeText.includes(searchTerm)) {
                        return false;
                    }
                }

                return true;
            });

            currentPage = 1;
            displaySchemes();
            updateSchemeStats();
            updatePagination();
        }

        function searchSchemes() {
            filterSchemes();
        }

        function clearAllFilters() {
            document.getElementById('governmentFilter').value = 'all';
            document.getElementById('categoryFilter').value = 'all';
            document.getElementById('stateFilter').value = 'all';
            document.getElementById('amountFilter').value = 'all';
            document.getElementById('schemeSearchInput').value = '';
            
            filteredSchemes = [...allSchemes];
            currentPage = 1;
            displaySchemes();
            updateSchemeStats();
            updatePagination();
        }

        function displaySchemes() {
            const startIndex = (currentPage - 1) * schemesPerPage;
            const endIndex = startIndex + schemesPerPage;
            
            // Hide all schemes first
            allSchemes.forEach(scheme => {
                scheme.style.display = 'none';
            });

            // Show filtered schemes for current page
            filteredSchemes.slice(startIndex, endIndex).forEach(scheme => {
                scheme.style.display = 'block';
            });
        }

        function updateSchemeStats() {
            const totalSchemes = allSchemes.length;
            const centralSchemes = allSchemes.filter(s => s.dataset.government === 'central').length;
            const stateSchemes = allSchemes.filter(s => s.dataset.government === 'state').length;
            const activeSchemes = allSchemes.filter(s => s.querySelector('.agri-active')).length;

            document.getElementById('totalSchemesCount').textContent = filteredSchemes.length;
            document.getElementById('centralSchemesCount').textContent = centralSchemes;
            document.getElementById('stateSchemesCount').textContent = stateSchemes;
            document.getElementById('activeSchemesCount').textContent = activeSchemes;
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredSchemes.length / schemesPerPage);
            const startIndex = (currentPage - 1) * schemesPerPage + 1;
            const endIndex = Math.min(currentPage * schemesPerPage, filteredSchemes.length);

            document.getElementById('currentPageInfo').textContent = `${startIndex}-${endIndex}`;
            document.getElementById('totalSchemesInfo').textContent = filteredSchemes.length;

            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = currentPage === totalPages || totalPages === 0;
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                displaySchemes();
                updatePagination();
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(filteredSchemes.length / schemesPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displaySchemes();
                updatePagination();
            }
        }

        // Scheme Action Functions
        function viewSchemeDetails(schemeId) {
            const schemeDetails = getSchemeDetails(schemeId);
            
            // Create detailed modal content
            const detailsModal = `
                <div class="agri-modal agri-large-modal" id="schemeDetailsModal" style="display: flex;">
                    <div class="agri-modal-content">
                        <div class="agri-modal-header">
                            <h2><i class="fas fa-info-circle"></i> ${schemeDetails.name}</h2>
                            <p>Complete details and requirements for this scheme</p>
                            <span class="agri-close" onclick="closeSchemeDetailsModal()">&times;</span>
                        </div>
                        
                        <div class="agri-scheme-detail-content">
                            <div class="agri-detail-section">
                                <h3><i class="fas fa-bullseye"></i> Objective</h3>
                                <p>${schemeDetails.objective}</p>
                            </div>
                            
                            <div class="agri-detail-section">
                                <h3><i class="fas fa-gift"></i> Benefits</h3>
                                <ul>
                                    ${schemeDetails.benefits.map(benefit => `<li>${benefit}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="agri-detail-section">
                                <h3><i class="fas fa-check-circle"></i> Eligibility Criteria</h3>
                                <ul>
                                    ${schemeDetails.eligibility.map(criteria => `<li>${criteria}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="agri-detail-section">
                                <h3><i class="fas fa-file-alt"></i> Required Documents</h3>
                                <ul>
                                    ${schemeDetails.documents.map(doc => `<li>${doc}</li>`).join('')}
                                </ul>
                            </div>
                            
                            <div class="agri-detail-section">
                                <h3><i class="fas fa-route"></i> Application Process</h3>
                                <ol>
                                    ${schemeDetails.process.map(step => `<li>${step}</li>`).join('')}
                                </ol>
                            </div>
                            
                            <div class="agri-detail-actions">
                                <button class="agri-btn-success" onclick="checkEligibility('${schemeId}')">
                                    <i class="fas fa-check-circle"></i> Check My Eligibility
                                </button>
                                <button class="agri-btn-primary" onclick="applyForScheme('${schemeId}')">
                                    <i class="fas fa-file-alt"></i> Apply Now
                                </button>
                                <button class="agri-btn-info" onclick="downloadSchemeInfo('${schemeId}')">
                                    <i class="fas fa-download"></i> Download Info
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Add modal to body
            document.body.insertAdjacentHTML('beforeend', detailsModal);
        }

        function closeSchemeDetailsModal() {
            const modal = document.getElementById('schemeDetailsModal');
            if (modal) {
                modal.remove();
            }
        }

        function checkEligibility(schemeId) {
            const eligibilityData = getEligibilityRequirements(schemeId);
            
            // Create eligibility checker modal
            const eligibilityModal = `
                <div class="agri-modal agri-medium-modal" id="eligibilityCheckerModal" style="display: flex;">
                    <div class="agri-modal-content">
                        <div class="agri-modal-header">
                            <h2><i class="fas fa-check-circle"></i> Eligibility Checker</h2>
                            <p>Check if you meet the requirements for this scheme</p>
                            <span class="agri-close" onclick="closeEligibilityModal()">&times;</span>
                        </div>
                        
                        <div class="agri-eligibility-form">
                            <div class="agri-form-group">
                                <label>Select Your Profile</label>
                                <select class="agri-form-control" id="farmerProfile" onchange="checkEligibilityStatus()">
                                    <option value="">Choose your farmer profile</option>
                                    <option value="small">Small Farmer (< 2 hectares)</option>
                                    <option value="marginal">Marginal Farmer (< 1 hectare)</option>
                                    <option value="medium">Medium Farmer (2-10 hectares)</option>
                                    <option value="large">Large Farmer (> 10 hectares)</option>
                                </select>
                            </div>
                            
                            <div class="agri-form-group">
                                <label>Land Ownership</label>
                                <select class="agri-form-control" id="landOwnership" onchange="checkEligibilityStatus()">
                                    <option value="">Select land ownership status</option>
                                    <option value="owned">Own Land</option>
                                    <option value="leased">Leased Land</option>
                                    <option value="sharecropper">Sharecropper</option>
                                    <option value="landless">Landless</option>
                                </select>
                            </div>
                            
                            <div class="agri-form-group">
                                <label>Annual Income</label>
                                <select class="agri-form-control" id="annualIncome" onchange="checkEligibilityStatus()">
                                    <option value="">Select income range</option>
                                    <option value="below-2lakh">Below ₹2 Lakh</option>
                                    <option value="2-5lakh">₹2-5 Lakh</option>
                                    <option value="5-10lakh">₹5-10 Lakh</option>
                                    <option value="above-10lakh">Above ₹10 Lakh</option>
                                </select>
                            </div>
                            
                            <div class="agri-eligibility-result" id="eligibilityResult" style="display: none;">
                                <div class="agri-result-content">
                                    <div class="agri-result-status" id="resultStatus"></div>
                                    <div class="agri-result-details" id="resultDetails"></div>
                                    <div class="agri-result-actions" id="resultActions"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', eligibilityModal);
        }

        function closeEligibilityModal() {
            const modal = document.getElementById('eligibilityCheckerModal');
            if (modal) {
                modal.remove();
            }
        }

        function checkEligibilityStatus() {
            const profile = document.getElementById('farmerProfile').value;
            const ownership = document.getElementById('landOwnership').value;
            const income = document.getElementById('annualIncome').value;
            
            if (profile && ownership && income) {
                const resultDiv = document.getElementById('eligibilityResult');
                const statusDiv = document.getElementById('resultStatus');
                const detailsDiv = document.getElementById('resultDetails');
                const actionsDiv = document.getElementById('resultActions');
                
                // Simple eligibility logic (can be made more complex)
                let isEligible = true;
                let reasons = [];
                
                if (ownership === 'landless' && profile !== 'landless') {
                    isEligible = false;
                    reasons.push('Land ownership required for this scheme');
                }
                
                if (income === 'above-10lakh' && profile === 'small') {
                    isEligible = false;
                    reasons.push('Income exceeds limit for small farmer category');
                }
                
                if (isEligible) {
                    statusDiv.innerHTML = `
                        <div class="agri-success-status">
                            <i class="fas fa-check-circle"></i>
                            <h3>You are Eligible!</h3>
                        </div>
                    `;
                    detailsDiv.innerHTML = `
                        <p>Based on your profile, you meet the eligibility criteria for this scheme.</p>
                        <ul>
                            <li>Profile: ${profile.charAt(0).toUpperCase() + profile.slice(1)} Farmer</li>
                            <li>Land Status: ${ownership.charAt(0).toUpperCase() + ownership.slice(1)}</li>
                            <li>Income Range: ${income}</li>
                        </ul>
                    `;
                    actionsDiv.innerHTML = `
                        <button class="agri-btn-primary" onclick="proceedToApplication()">
                            <i class="fas fa-arrow-right"></i> Proceed to Application
                        </button>
                    `;
                } else {
                    statusDiv.innerHTML = `
                        <div class="agri-error-status">
                            <i class="fas fa-times-circle"></i>
                            <h3>Not Eligible</h3>
                        </div>
                    `;
                    detailsDiv.innerHTML = `
                        <p>Unfortunately, you don't meet the eligibility criteria:</p>
                        <ul>
                            ${reasons.map(reason => `<li>${reason}</li>`).join('')}
                        </ul>
                        <p>Please check other available schemes that might suit your profile.</p>
                    `;
                    actionsDiv.innerHTML = `
                        <button class="agri-btn-secondary" onclick="browseOtherSchemes()">
                            <i class="fas fa-search"></i> Browse Other Schemes
                        </button>
                    `;
                }
                
                resultDiv.style.display = 'block';
            }
        }

        function applyForScheme(schemeId) {
            // Close any open modals
            closeSchemeDetailsModal();
            closeEligibilityModal();
            
            // Open the application form with pre-filled scheme data
            openAgriModal('addAgriSupportModal');
            switchAgriFormTab('agri-scheme-form');
            
            // Pre-fill scheme type based on schemeId
            const schemeTypeMap = {
                'pm-kisan': 'pmkisan',
                'pmfby': 'pmfby',
                'deds': 'deds',
                'kcc': 'kcc',
                'smam': 'equipment',
                'up-kmby': 'kmby',
                'punjab-diversification': 'crop-diversification',
                'mh-drip': 'irrigation',
                'gujarat-organic': 'organic',
                'karnataka-skill': 'training'
            };
            
            const schemeTypeSelect = document.getElementById('schemeType');
            if (schemeTypeSelect && schemeTypeMap[schemeId]) {
                schemeTypeSelect.value = schemeTypeMap[schemeId];
                updateSchemeFields(schemeTypeMap[schemeId]);
            }
        }

        function exportSchemesList() {
            // Create CSV content
            let csvContent = "Scheme Name,Government Level,Category,Benefits,Status\n";
            
            filteredSchemes.forEach(scheme => {
                const name = scheme.querySelector('h3').textContent;
                const government = scheme.dataset.government;
                const category = scheme.dataset.category;
                const benefits = scheme.querySelector('.agri-scheme-amount').textContent;
                const status = scheme.querySelector('.agri-active') ? 'Active' : 'Inactive';
                
                csvContent += `"${name}","${government}","${category}","${benefits}","${status}"\n`;
            });
            
            // Create and download file
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'government_schemes_list.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function proceedToApplication() {
            closeEligibilityModal();
            // This would typically redirect to the application form
            alert('Redirecting to application form...');
        }

        function browseOtherSchemes() {
            closeEligibilityModal();
            // Clear filters to show all schemes
            clearAllFilters();
        }

        function downloadSchemeInfo(schemeId) {
            // In a real application, this would generate a PDF
            alert(`Downloading detailed information for scheme: ${schemeId}`);
        }

        // Helper function to get scheme details
        function getSchemeDetails(schemeId) {
            const schemeData = {
                'pm-kisan': {
                    name: 'Pradhan Mantri Kisan Samman Nidhi (PM-KISAN)',
                    objective: 'To provide income support to all landholding farmer families to supplement their financial needs for procuring various inputs to ensure proper crop health and appropriate yields.',
                    benefits: [
                        'Direct cash transfer of ₹6,000 per year',
                        'Paid in three equal installments of ₹2,000 each',
                        'Direct transfer to bank account',
                        'No paperwork or bureaucratic delays'
                    ],
                    eligibility: [
                        'All landholding farmer families',
                        'Valid Aadhaar card required',
                        'Bank account linked with Aadhaar',
                        'Land ownership documents required'
                    ],
                    documents: [
                        'Aadhaar Card',
                        'Bank Account Details',
                        'Land Ownership Documents',
                        'Mobile Number for registration'
                    ],
                    process: [
                        'Visit PM-KISAN portal or nearest CSC',
                        'Fill registration form with required details',
                        'Upload necessary documents',
                        'Submit application and get acknowledgment',
                        'Track application status online'
                    ]
                },
                'pmfby': {
                    name: 'Pradhan Mantri Fasal Bima Yojana (PMFBY)',
                    objective: 'To provide comprehensive crop insurance coverage against all non-preventable natural risks from pre-sowing to post-harvest.',
                    benefits: [
                        'Low premium rates (2% for Kharif, 1.5% for Rabi)',
                        'Coverage for all stages of crop cycle',
                        'Quick settlement of claims',
                        'Use of technology for faster claim processing'
                    ],
                    eligibility: [
                        'All farmers (loanee and non-loanee)',
                        'Sharecroppers and tenant farmers eligible',
                        'Must have insurable interest in the crop',
                        'Crop must be grown in notified area'
                    ],
                    documents: [
                        'Aadhaar Card',
                        'Bank Account Details',
                        'Land Records (Khata/Khatauni)',
                        'Sowing Certificate',
                        'Loan Sanction Letter (if applicable)'
                    ],
                    process: [
                        'Approach nearest bank or insurance company',
                        'Fill application form before cut-off date',
                        'Pay premium amount',
                        'Get insurance certificate',
                        'Report crop loss within 72 hours if any'
                    ]
                }
                // Add more scheme details as needed
            };
            
            return schemeData[schemeId] || {
                name: 'Scheme Details',
                objective: 'Detailed information not available.',
                benefits: ['Contact local agriculture office for more details'],
                eligibility: ['Please check with local authorities'],
                documents: ['Standard KYC documents required'],
                process: ['Visit nearest agriculture office for application process']
            };
        }

        function getEligibilityRequirements(schemeId) {
            // This would contain specific eligibility logic for each scheme
            return {
                landRequired: true,
                incomeLimit: 500000,
                farmerType: ['small', 'marginal', 'medium']
            };
        }
    </script>

    <!-- Enhanced Insurance & Government Schemes Functionality -->
    <script>
        // Insurance & Government Schemes Enhanced Functionality
        
        // Show all cards in the active tab (no filtering needed)
        function showAllCardsInActiveTab() {
            // Get the currently active tab
            const activeTab = document.querySelector('.agri-tab-content.agri-active');
            if (!activeTab) return;
            
            // Get cards only from the active tab and show them all
            const cards = activeTab.querySelectorAll('.agri-support-card');
            cards.forEach(card => {
                card.style.display = 'block';
            });
            
            updateStats();
        }
        
        // Update Statistics
        function updateStats() {
            const visibleCards = document.querySelectorAll('.agri-support-card[style*="block"], .agri-support-card:not([style])');
            const insuranceCards = Array.from(visibleCards).filter(card => card.dataset.type === 'insurance');
            const schemeCards = Array.from(visibleCards).filter(card => card.dataset.type === 'scheme');
            const expiringCards = Array.from(visibleCards).filter(card => 
                card.classList.contains('agri-expiring') || 
                card.querySelector('.agri-badge-warning')
            );
            
            document.getElementById('totalInsurancePolicies').textContent = insuranceCards.length;
            document.getElementById('totalSchemes').textContent = schemeCards.length;
            document.getElementById('expiringPolicies').textContent = expiringCards.length;
        }
        
        // Policy Management Functions
        function renewPolicy(policyId) {
            showNotification(`Renewal process initiated for policy ${policyId}`, 'success');
            // Here you would typically open a renewal form or redirect to renewal page
        }
        
        function urgentRenewal(policyId) {
            if (confirm(`This policy expires soon! Do you want to start urgent renewal for ${policyId}?`)) {
                showNotification(`Urgent renewal process started for policy ${policyId}`, 'warning');
                // Priority renewal process
            }
        }
        
        function viewPolicyDetails(policyId) {
            showNotification(`Loading details for policy ${policyId}...`, 'info');
            // Here you would open a detailed view modal
        }
        
        function deletePolicy(policyId) {
            if (confirm(`Are you sure you want to delete policy ${policyId}? This action cannot be undone.`)) {
                showNotification(`Policy ${policyId} has been deleted`, 'error');
                // Remove the policy card from DOM
            }
        }
        
        function downloadPolicy(policyId) {
            showNotification(`Downloading policy document for ${policyId}...`, 'info');
            // Simulate download
            setTimeout(() => {
                showNotification(`Policy document downloaded successfully`, 'success');
            }, 1500);
        }
        
        function claimAssistance(policyId) {
            showNotification(`Connecting you to claim assistance for policy ${policyId}...`, 'info');
            // Here you would open claim assistance form or contact details
        }
        
        function renewNow(policyId) {
            if (confirm(`Start immediate renewal for policy ${policyId}?`)) {
                showNotification(`Immediate renewal started for ${policyId}`, 'success');
            }
        }
        
        // Scheme Management Functions
        function viewBenefits(schemeId) {
            showNotification(`Loading benefit details for scheme ${schemeId}...`, 'info');
            // Show detailed benefits modal
        }
        
        function viewSchemeDetails(schemeId) {
            showNotification(`Loading scheme details for ${schemeId}...`, 'info');
            // Show detailed scheme information
        }
        
        function trackApplication(schemeId) {
            showNotification(`Tracking application status for ${schemeId}...`, 'info');
            // Show application tracking information
        }
        
        function downloadSchemeDoc(schemeId) {
            showNotification(`Downloading scheme certificate for ${schemeId}...`, 'info');
            setTimeout(() => {
                showNotification(`Certificate downloaded successfully`, 'success');
            }, 1500);
        }
        
        function downloadApplication(schemeId) {
            showNotification(`Downloading application form for ${schemeId}...`, 'info');
            setTimeout(() => {
                showNotification(`Application form downloaded successfully`, 'success');
            }, 1500);
        }
        
        function checkKisanStatus(schemeId) {
            showNotification(`Checking PM-KISAN status for ${schemeId}...`, 'info');
            setTimeout(() => {
                showNotification(`Status: Active - Next installment due 15 Aug 2025`, 'success');
            }, 1000);
        }
        
        function downloadKisanCert(schemeId) {
            showNotification(`Downloading PM-KISAN certificate...`, 'info');
            setTimeout(() => {
                showNotification(`PM-KISAN certificate downloaded successfully`, 'success');
            }, 1500);
        }
        
        function viewGuidelines(schemeType) {
            showNotification(`Loading guidelines for ${schemeType} scheme...`, 'info');
            // Open guidelines in new tab or modal
        }
        
        function checkEligibility(schemeType) {
            showNotification(`Checking eligibility for ${schemeType} scheme...`, 'info');
            setTimeout(() => {
                showNotification(`Eligibility check completed - You are eligible`, 'success');
            }, 1500);
        }
        
        // Notification Functions
        function sendNotification(farmerId, type) {
            const farmerNames = {
                'farmer1': 'Shiva',
                'farmer2': 'Madhu',
                'farmer3': 'Ravi',
                'farmer4': 'Meera'
            };
            
            const farmerName = farmerNames[farmerId] || 'Farmer';
            showNotification(`Notification sent to ${farmerName} regarding ${type}`, 'success');
        }
        
        function sendReminder(farmerId, reminderType) {
            const farmerNames = {
                'farmer1': 'Shiva',
                'farmer2': 'Madhu',
                'farmer3': 'Ravi',
                'farmer4': 'Meera'
            };
            
            const farmerName = farmerNames[farmerId] || 'Farmer';
            showNotification(`Reminder sent to ${farmerName} for ${reminderType}`, 'success');
        }
        
        // Farmer Profile Integration
        function viewFarmerProfile(farmerId) {
            const farmerNames = {
                'farmer1': 'Shiva',
                'farmer2': 'Madhu',
                'farmer3': 'Ravi',
                'farmer4': 'Meera'
            };
            
            const farmerName = farmerNames[farmerId] || 'Farmer';
            showNotification(`Loading profile for ${farmerName}...`, 'info');
            // Here you would navigate to farmer profile or open profile modal
        }
        
        // Report Generation
        function generateInsuranceReport() {
            showNotification('Generating comprehensive insurance and schemes report...', 'info');
            setTimeout(() => {
                showNotification('Report generated successfully! Check your downloads.', 'success');
            }, 2000);
        }
        
        // Notification Display Function
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `agri-notification agri-notification-${type}`;
            notification.innerHTML = `
                <i class="fas fa-${getNotificationIcon(type)}"></i>
                <span>${message}</span>
                <button onclick="this.parentElement.remove()" class="agri-notification-close">×</button>
            `;
            
            // Add to page
            document.body.appendChild(notification);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }
        
        function getNotificationIcon(type) {
            const icons = {
                'success': 'check-circle',
                'error': 'exclamation-circle',
                'warning': 'exclamation-triangle',
                'info': 'info-circle'
            };
            return icons[type] || 'info-circle';
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            
            // Add hover effects to cards
            const cards = document.querySelectorAll('.agri-support-card');
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-5px)';
                    this.style.boxShadow = '0 8px 25px rgba(0,0,0,0.15)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)';
                });
            });
        });

        // Document Management Functions
        function openUploadModal() {
            document.getElementById('documentUploadModal').style.display = 'block';
        }

        function closeUploadModal() {
            document.getElementById('documentUploadModal').style.display = 'none';
            document.getElementById('documentUploadForm').reset();
            document.getElementById('filePreview').style.display = 'none';
            document.getElementById('fileUploadArea').querySelector('.agri-upload-hint').style.display = 'block';
        }

        function handleFileSelect(input) {
            const file = input.files[0];
            if (file) {
                // Validate file size (10MB limit)
                if (file.size > 10 * 1024 * 1024) {
                    showNotification('File size must be less than 10MB', 'error');
                    input.value = '';
                    return;
                }

                // Show file preview
                const preview = document.getElementById('filePreview');
                const fileName = document.getElementById('fileName');
                const fileSize = document.getElementById('fileSize');
                const uploadHint = document.getElementById('fileUploadArea').querySelector('.agri-upload-hint');

                fileName.textContent = file.name;
                fileSize.textContent = formatFileSize(file.size);
                preview.style.display = 'flex';
                uploadHint.style.display = 'none';

                // Update file icon based on type
                const fileIcon = preview.querySelector('.agri-file-info i');
                if (file.type.includes('pdf')) {
                    fileIcon.className = 'fas fa-file-pdf';
                } else if (file.type.includes('image')) {
                    fileIcon.className = 'fas fa-file-image';
                } else if (file.type.includes('word')) {
                    fileIcon.className = 'fas fa-file-word';
                } else {
                    fileIcon.className = 'fas fa-file';
                }
            }
        }

        function removeFile() {
            document.getElementById('documentFile').value = '';
            document.getElementById('filePreview').style.display = 'none';
            document.getElementById('fileUploadArea').querySelector('.agri-upload-hint').style.display = 'block';
        }

        function uploadDocument(event) {
            event.preventDefault();
            
            const title = document.getElementById('documentTitle').value;
            const category = document.getElementById('documentCategory').value;
            const farmer = document.getElementById('documentFarmer').value;
            const file = document.getElementById('documentFile').files[0];
            const description = document.getElementById('documentDescription').value;

            if (!file) {
                showNotification('Please select a file to upload', 'error');
                return;
            }

            // Simulate upload process
            showNotification('Uploading document...', 'info');
            
            setTimeout(() => {
                // Create new document card
                const documentsGrid = document.getElementById('documentsGrid');
                const newCard = createDocumentCard(title, file, category, farmer);
                documentsGrid.insertAdjacentHTML('afterbegin', newCard);
                
                showNotification('Document uploaded successfully!', 'success');
                closeUploadModal();
            }, 2000);
        }

        function createDocumentCard(title, file, category, farmer) {
            const farmerNames = {
                'F001': 'Shiva',
                'F002': 'Madhu', 
                'F003': 'Ravi',
                'F004': 'Meera'
            };

            const farmerName = farmer ? farmerNames[farmer] || 'Unknown' : 'General';
            const currentDate = new Date().toLocaleDateString('en-GB', { 
                day: '2-digit', 
                month: 'short', 
                year: 'numeric' 
            });

            let iconClass = 'fas fa-file';
            if (file.type.includes('pdf')) iconClass = 'fas fa-file-pdf';
            else if (file.type.includes('image')) iconClass = 'fas fa-file-image';
            else if (file.type.includes('word')) iconClass = 'fas fa-file-word';

            return `
                <div class="agri-document-card" data-filename="${title}">
                    <div class="agri-doc-icon"><i class="${iconClass}"></i></div>
                    <div class="agri-doc-details">
                        <h4>${title}</h4>
                        <p>Uploaded: ${currentDate} | Farmer: ${farmerName}</p>
                        <p>Size: ${formatFileSize(file.size)} | Category: ${category}</p>
                    </div>
                    <div class="agri-doc-actions">
                        <button class="agri-icon-btn" title="Download" onclick="downloadDocumentFile('${title}', 'pdf')"><i class="fas fa-download"></i></button>
                        <button class="agri-icon-btn" title="Delete" onclick="deleteDocument(this, '${title}')"><i class="fas fa-trash"></i></button>
                    </div>
                </div>
            `;
        }

        function downloadDocumentFile(filename, fileType) {
            showNotification(`Downloading ${filename}...`, 'info');
            
            let content = '';
            let mimeType = '';
            let extension = '';
            
            // Create different dummy content based on file type
            if (fileType === 'pdf' || filename.toLowerCase().includes('.pdf')) {
                content = `FARMER DOCUMENT - ${filename}
========================

Document Type: ${filename.includes('Insurance') ? 'Insurance Policy' : 
                filename.includes('Scheme') ? 'Government Scheme Application' : 
                filename.includes('Registration') ? 'Farmer Registration Form' : 
                filename.includes('Land') ? 'Land Records Document' : 'General Document'}

Generated: ${new Date().toLocaleDateString()}
Time: ${new Date().toLocaleTimeString()}

DOCUMENT DETAILS:
================
- Document Name: ${filename}
- Status: Active
- Verification: Completed
- Digital Signature: Applied

FARMER INFORMATION:
==================
- Farmer ID: ${filename.includes('Insurance') ? 'F001 (Shiva)' : 
             filename.includes('Scheme') ? 'F002 (Madhu)' : 
             filename.includes('Registration') ? 'F003 (Ravi)' : 
             filename.includes('Land') ? 'F004 (Meera)' : 'General'}
- Contact: +91-XXXXXXXXXX
- Location: Rural Area, State

DOCUMENT CONTENT:
================
This is a dummy document generated for demonstration purposes.
In a real system, this would contain the actual document content
such as policy details, application forms, or official records.

IMPORTANT NOTES:
===============
- This document is for testing purposes only
- Replace with actual document content in production
- Ensure proper security measures for sensitive documents
- Maintain backup copies of all important documents

SYSTEM INFORMATION:
==================
- Generated by: Dairy Management System
- Version: 1.0
- Support: contact@dairysystem.com

---
End of Document
`;
                mimeType = 'text/plain';
                extension = '.txt';
            } else if (fileType === 'image' || filename.toLowerCase().match(/\.(jpg|jpeg|png)$/)) {
                // For images, create a simple text file explaining it's a dummy
                content = `IMAGE DOCUMENT PLACEHOLDER - ${filename}
========================================

This represents an image document that would normally be downloaded.

Image Details:
- Original Filename: ${filename}
- Type: ${filename.includes('Scheme') ? 'Government Scheme Application Image' : 'Document Image'}
- Associated Farmer: ${filename.includes('Scheme') ? 'Madhu (F002)' : 'General'}
- Upload Date: ${new Date().toLocaleDateString()}

In a real system, this would download the actual image file.
For demonstration purposes, this text file is provided instead.

Note: This is a dummy file for testing the download functionality.
`;
                mimeType = 'text/plain';
                extension = '.txt';
            } else {
                content = `DOCUMENT FILE - ${filename}
===================

This is a dummy document file for: ${filename}
Generated on: ${new Date().toLocaleString()}

This file represents the document that would be downloaded in a real system.
The actual implementation would serve the real document file.

Document Information:
- Filename: ${filename}
- System: Dairy Management System
- Purpose: Demonstration/Testing

---
Dummy file content ends here.
`;
                mimeType = 'text/plain';
                extension = '.txt';
            }
            
            // Create and download the file
            const blob = new Blob([content], { type: mimeType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename.replace(/\.[^/.]+$/, "") + extension; // Replace original extension with .txt
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            setTimeout(() => {
                showNotification(`${filename} downloaded successfully!`, 'success');
            }, 1000);
        }

        function downloadDummyFile() {
            showNotification('Downloading sample document...', 'info');
            
            // Create a dummy PDF content
            const dummyContent = `
                FARMER DOCUMENT TEMPLATE
                ========================
                
                This is a sample document template for farmer records.
                
                Document Details:
                - Document Type: Sample Template
                - Created: ${new Date().toLocaleDateString()}
                - Purpose: Reference and testing
                
                Instructions:
                1. Use this template as a reference
                2. Replace sample data with actual information
                3. Ensure all required fields are filled
                4. Upload completed documents through the system
                
                For more information, contact the dairy management system administrator.
            `;
            
            // Create and download file
            const blob = new Blob([dummyContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Sample_Document_Template.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            setTimeout(() => {
                showNotification('Sample document downloaded successfully!', 'success');
            }, 1000);
        }



        function deleteDocument(button, filename) {
            if (confirm(`Are you sure you want to delete "${filename}"?\n\nThis action cannot be undone.`)) {
                const card = button.closest('.agri-document-card');
                card.style.transition = 'all 0.3s ease';
                card.style.transform = 'scale(0.8)';
                card.style.opacity = '0';
                
                setTimeout(() => {
                    card.remove();
                    showNotification(`${filename} deleted successfully`, 'success');
                }, 300);
            }
        }



        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('documentUploadModal');
            if (event.target === modal) {
                closeUploadModal();
            }
        }
    </script>
    
    <style>
        /* Enhanced Insurance & Government Schemes Styles */
        
        /* Quick Stats Dashboard */
        .agri-quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
        }
        
        .agri-stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }
        
        .agri-stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .agri-stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .agri-stat-card:nth-child(1) .agri-stat-icon {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .agri-stat-card:nth-child(2) .agri-stat-icon {
            background: linear-gradient(135deg, #27ae60, #229954);
        }
        
        .agri-stat-card:nth-child(3) .agri-stat-icon {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .agri-stat-card:nth-child(4) .agri-stat-icon {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .agri-stat-content h3 {
            margin: 0;
            font-size: 1.8rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .agri-stat-content p {
            margin: 5px 0 0 0;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        /* Controls Panel */
        .agri-controls-panel {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .agri-search-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: end;
        }
        
        .agri-filter-group {
            display: flex;
            flex-direction: column;
            min-width: 150px;
        }
        
        .agri-filter-group label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .agri-filter-group select {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            background: white;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .agri-filter-group select:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        /* Enhanced Card Styles */
        .agri-farmer-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
            margin-bottom: 10px;
            align-items: flex-start;
            text-align: left;
        }
        
        .agri-farmer-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.9rem;
            display: inline-block;
            white-space: nowrap;
            text-align: left;
        }
        
        .agri-farmer-id {
            font-size: 0.8rem;
            color: #7f8c8d;
            background: #ecf0f1;
            padding: 2px 8px;
            border-radius: 12px;
            align-self: flex-start;
            display: inline-block;
            white-space: nowrap;
            text-align: left;
        }
        
        .agri-expiring {
            border-left: 4px solid #e74c3c;
            position: relative;
        }
        
        .agri-expiry-alert {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #e74c3c;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .agri-icon-btn.agri-urgent {
            background: #e74c3c;
            color: white;
        }
        
        .agri-icon-btn.agri-urgent:hover {
            background: #c0392b;
        }
        
        .agri-days-left.agri-warning {
            color: #f39c12;
            font-weight: 600;
        }
        
        .agri-days-left.agri-urgent {
            color: #e74c3c;
            font-weight: 600;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.5; }
        }
        
        .agri-badge-warning {
            background: #f39c12;
            color: white;
        }
        
        .agri-btn-info {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .agri-btn-info:hover {
            background: #138496;
            transform: translateY(-2px);
        }
        
        /* Notification Styles */
        .agri-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 10000;
            min-width: 300px;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .agri-notification-success {
            border-left: 4px solid #27ae60;
            color: #27ae60;
        }
        
        .agri-notification-error {
            border-left: 4px solid #e74c3c;
            color: #e74c3c;
        }
        
        .agri-notification-warning {
            border-left: 4px solid #f39c12;
            color: #f39c12;
        }
        
        .agri-notification-info {
            border-left: 4px solid #3498db;
            color: #3498db;
        }
        
        .agri-notification-close {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: #7f8c8d;
            margin-left: auto;
        }
        
        .agri-notification-close:hover {
            color: #2c3e50;
        }
        
        /* Dark Mode Support for Enhanced Features */
        body.dark-mode .agri-quick-stats {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        }
        
        body.dark-mode .agri-stat-card {
            background: #34495e;
            color: #ecf0f1;
        }
        
        body.dark-mode .agri-stat-content h3 {
            color: #ecf0f1;
        }
        
        body.dark-mode .agri-controls-panel {
            background: #34495e;
        }
        
        body.dark-mode .agri-filter-group label {
            color: #ecf0f1;
        }
        
        body.dark-mode .agri-filter-group select {
            background: #2c3e50;
            color: #ecf0f1;
            border-color: #4a5f7a;
        }
        
        body.dark-mode .agri-farmer-name {
            color: #ecf0f1;
        }
        
        body.dark-mode .agri-farmer-id {
            background: #4a5f7a;
            color: #bdc3c7;
        }
        
        body.dark-mode .agri-notification {
            background: #34495e;
            color: #ecf0f1;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .agri-quick-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .agri-search-filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .agri-filter-group {
                min-width: auto;
            }
            
            .agri-farmer-info {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }
        
        @media (max-width: 480px) {
            .agri-quick-stats {
                grid-template-columns: 1fr;
            }
            
            .agri-notification {
                left: 10px;
                right: 10px;
                min-width: auto;
            }
        }
        
        /* Additional styles for market analysis interactivity */
        .competitor-analysis table tbody tr {
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .competitor-analysis table tbody tr:hover {
            background-color: #f0f7ff;
        }
        
        .competitor-analysis table tbody tr.selected-row {
            background-color: #e3f2fd;
            border-left: 3px solid #3498db;
        }
        
        .news-item {
            cursor: pointer;
        }
        
        .news-item:hover {
            background-color: #e8f4fd;
            transform: translateX(5px);
        }
    </style>
</body>
</html>